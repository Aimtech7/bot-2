const _0x2a5e05=_0xde52;function _0xde52(_0x25cb55,_0x5b0a74){const _0x121ad0=_0x2cdb();return _0xde52=function(_0xcf974f,_0x9b8199){_0xcf974f=_0xcf974f-(-0xa28+0x1cef+-0x4d*0x3d);let _0x31e2ea=_0x121ad0[_0xcf974f];return _0x31e2ea;},_0xde52(_0x25cb55,_0x5b0a74);}(function(_0x4f3f43,_0x4d3e76){const _0xcd6d4c=_0xde52,_0xef5d72=_0x4f3f43();while(!![]){try{const _0x438dc7=parseInt(_0xcd6d4c(0x17d))/(0x1*0x7a+-0x1780+0x1707)+parseInt(_0xcd6d4c(0x98))/(0xf28+-0x14f*-0x18+-0x2e8e)+-parseInt(_0xcd6d4c(0xa8))/(0xfa8+0x16d0+-0x2675)*(parseInt(_0xcd6d4c(0x185))/(-0x161b*0x1+-0x9b5+0x1fd4))+-parseInt(_0xcd6d4c(0x10a))/(0x1877*-0x1+-0x11a8+-0x4*-0xa89)*(parseInt(_0xcd6d4c(0xa1))/(-0x1*0x3f3+0x1*0x1ac1+-0x16c8))+parseInt(_0xcd6d4c(0x1b3))/(0x1039*-0x1+-0x139+0x1179)*(parseInt(_0xcd6d4c(0xbd))/(0x20fc*0x1+-0x1*-0x1e91+-0x65*0xa1))+parseInt(_0xcd6d4c(0x12a))/(0x142a*-0x1+-0x716*-0x2+0x607*0x1)*(parseInt(_0xcd6d4c(0x1b6))/(-0x4ab+0x1196+-0xce1))+-parseInt(_0xcd6d4c(0xb3))/(0x88d*0x1+-0x1*0x19d1+0x5c5*0x3)*(parseInt(_0xcd6d4c(0x14f))/(-0x1*-0xa67+-0x6*0x178+-0x1*0x18b));if(_0x438dc7===_0x4d3e76)break;else _0xef5d72['push'](_0xef5d72['shift']());}catch(_0x4218c4){_0xef5d72['push'](_0xef5d72['shift']());}}}(_0x2cdb,-0x7d5*0x6f+0x74f27*-0x1+0xf913b));import{DateTime}from'luxon';import{db}from'../utils/database.js';import{info,warn,error}from'../utils/logger.js';import{isadmin}from'../utils/isadmin.js';import{getConfig}from'../utils/config.js';import{getBotJid}from'../utils/bot-state.js';export const name=_0x2a5e05(0xea);export const version=_0x2a5e05(0x85);export const priority=-0x1f1c+0x1cd*0x1+0x1da9;export const commands=[_0x2a5e05(0xea),'inactive'];let botRef=null,sendApi=null;const DEFAULTS={'TIME_ZONE':_0x2a5e05(0x192),'MAX_DAILY_KEEP_DAYS':0x5a,'ROLLOVER_TO_WEEK_DAYS':0x7,'ROLLOVER_TO_MONTH_DAYS':0x1e,'ROLLOVER_TO_YEAR_DAYS':0x16d,'USERS_LIMIT_RETURN':0xc8,'DEDUPE_TTL_MS':(0x1b55+0x8bf+-0x11fb*0x2)*(0x15aa+-0x10*-0x1d3+-0x2ef2)};let CONFIG={...DEFAULTS};function normalizeJid(_0x5e7c10){const _0x58f826=_0x2a5e05;return _0x5e7c10?String(_0x5e7c10)[_0x58f826(0xc1)]():'';}function sleep(_0x55ddaf){return new Promise(_0x1409c2=>setTimeout(_0x1409c2,_0x55ddaf));}function toLowerRoman(_0x5676eb){const _0x2c41f4=_0x2a5e05,_0x15dc93=[[0x1a76+0x1d1d+-0x33ab*0x1,'M'],[0x12bf*0x1+0x1285+0x5a0*-0x6,'CM'],[-0x202e+-0x7*0x1cd+0x2ebd,'D'],[-0x1a3a+-0xd31+0x28fb,'CD'],[0x387+-0x239*-0x1+-0x7*0xc4,'C'],[-0x214f+-0x85b+0x2a04,'XC'],[0x235d+-0x1d48+-0x5e3,'L'],[0x1fb+0xf49+0x1*-0x111c,'XL'],[-0x171a+0x1*-0x16d9+0xc1*0x3d,'X'],[-0xcb3+-0x91a*-0x1+0x3a2,'IX'],[-0xb81+0x1d2b+-0x11a5*0x1,'V'],[0xfa3+-0x1a5*0x3+-0xab0,'IV'],[0x538+-0x2105+0x1*0x1bce,'I']];let _0x145175=_0x5676eb,_0x541802='';for(const [_0x4f5f4d,_0x303864]of _0x15dc93)while(_0x145175>=_0x4f5f4d){_0x541802+=_0x303864,_0x145175-=_0x4f5f4d;}return _0x541802[_0x2c41f4(0xbc)+'e']();}function romanParen(_0x23831c){return'('+toLowerRoman(_0x23831c)+')';}const processedMessageKeys=new Map();function makeDedupeKey(_0x1604e9){const _0x2d0099=_0x2a5e05,_0x1f3036=_0x1604e9?.['key'];if(!_0x1f3036)return null;const _0x388a2a=_0x1f3036['id']||_0x1f3036[_0x2d0099(0x8f)+'t']||'',_0x14d59d=_0x1f3036[_0x2d0099(0xd0)]||'';return _0x14d59d+'::'+_0x388a2a;}function isMsgProcessed(_0x4ad68f){const _0x4dc517=_0x2a5e05;return _0x4ad68f&&processedMessageKeys[_0x4dc517(0x11f)](_0x4ad68f);}function _0x2cdb(){const _0x566e30=['ticipants\x20','e_stats\x20WH','found\x20in\x20t','isplay_nam','eframe\x20=\x20\x27','tats\x20(chat','ATE\x20TABLE\x20','filter','participan','XT\x0a\x20\x20\x20\x20\x20\x20)','INTEGER\x20PR','e\x20DB\x20error','lay_name\x20=','.ACTIVE:\x20','daily\x27\x20AND','nitialized','split','326918ZoGaWt','setZone','get','FROM\x20activ','KEY,\x20migra','jid\x20=\x20?\x20AN','chat_jid','_stats\x20(\x0a\x20','ðŸ‘¤\x20@','422262TVbRCg','changes','?,\x20?,\x20\x27mon','=\x20?\x20AND\x20ti','t_updated\x20','message','splay_name','3KEfyLr','senderName','ACTIVE','object','rame\x20=\x20\x27we','sage_id\x20TE','\x20\x20\x20\x20\x20\x20','slice','function','OM\x20active_','TO\x20active_','32747ftwAxL','eframe\x20TEX','_key\x20=\x20?\x20L','e_stats(ch','\x20\x20\x20\x20\x20\x20buck','match','\x20last\x20','count','\x20inactive\x20','toLowerCas','3702248RoQzhk','[active]\x20o','id\x20=\x20?\x20AND','\x20failed:\x20','trim','cnt,\x20MAX(l','e\x20members\x20','now','catch','[active]\x20i','tive\x207d','toSeconds','rune\x20daily','cket_key,\x20','\x20message_c','daily\x20rows','ay_name,\x20l','unt','Y-WW,\x20mont','remoteJid','f\x20ON\x20activ','minus','\x20?,\x20last_u','ups\x20failed','ive_stats(','\x20\x20\x20VALUES\x20','fromObject','\x20=\x20?\x20AND\x20t','elete\x20old\x20','y_name,\x20la','[active]\x20c','\x20bucket_ke','ast_update','et_key\x20TEX','e\x201w,\x20inac','chat_jid,\x20',',\x20timefram','fromSecond','(?,\x20?,\x20\x27da','failed:\x20','No\x20inactiv','EXT\x20DEFAUL','ily\x27,\x20?,\x201','ers\x20in\x20the','[active]\x20t','active','nthly\x27','ow\x27)));','[active]\x20g','||yearly||','end\x20usage\x20',',\x20\x20\x20\x20\x20\x20--\x20','HERE\x20timef','\x20user_jid\x20','\x20+\x201,\x20disp','USERS_LIMI','weekly','e\x20=\x20?,\x20las','sourceIds','ions\x20(vers','O_WEEK_DAY','\x20\x27daily\x27\x20A','at_jid,\x20ti','ket_key,\x20m','\x201d,\x20activ','\x20no\x20messag','set','ERE\x20chat_j','chat_jid\x20=','\x0a\x20\x20\x20\x20\x20\x20CRE','Found\x20','O\x20active_s','\x20TEXT\x20PRIM','nt,\x20displa','AUTOINCREM','all','yyyy-LL-dd','25ysIWtZ','ECT\x20user_j','_leaderboa','?,\x20?,\x20?)','T\x20NOT\x20NULL',')\x20VALUES\x20(','\x20user_jid,','unt\x20+\x20?,\x20d','_count,\x20di','[active]\x20s','uildLeader','hly:\x20YYYY-','_MS','rackMessag','ead\x20config','E\x20chat_jid','bucket_key','e\x20unexpect','exec','=\x20?\x20WHERE\x20','ats_chat_u','has','T_RETURN','LT\x20(strfti','push','frame,\x20buc','group\x20part','\x0a\x20\x20\x20\x20\x20\x20SEL','floor','run','key\x20=\x20?\x0a\x20\x20','\x20timeframe','10944uTkHlo','rd_message','jid\x20TEXT\x20N','timeframe','key\x20=\x20?\x20LI','NTEGER\x20DEF','delete','SELECT\x20use','O_MONTH_DA','meframe\x20=\x20','sock','eekly:\x20YYY','monthly','padStart','rame\x20=\x20\x27mo','count)\x20AS\x20','weekNumber','length','ollups\x20com','>\x20\x20OR\x20\x20ina','[active]\x20e','\x20\x20\x20\x20\x20\x20\x20mes',',\x20?,\x20?)','\x0a\x20\x20\x20\x20','unit','IF\x20NOT\x20EXI','ed:\x20','plete','key','DEDUPE_TTL','eframe,\x20bu','\x20\x20\x20\x20\x20UNIQU','map','\x20\x20\x20\x20\x20\x20disp','\x20INSERT\x20IN','?,\x20?,\x20\x27wee','t_key\x20<=\x20?','2028avPPqW','erformRoll','ount\x20=\x20mes','\x0a\x20\x20\x20\x20\x20\x20\x20\x20W','failed\x20for','string','e_stats\x0a\x20\x20','ow\x27)),\x0a\x20\x20\x20','rly\x27,\x20?,\x20?','isArray','tats\x20WHERE','ailed\x20to\x20r','id,\x20displa','key)\x0a\x20\x20\x20\x20\x20','ay_name\x20FR','ROLLOVER_T','|y>\x0aExampl','members\x20in','ailed:\x20',':\x20YYYY\x0a\x20\x20\x20','TIME_ZONE','D\x20user_jid','IMIT\x201','INSERT\x20INT','display_na','inactive','icipants.','_jid,\x20user','values','ata','MIT\x201','user_jid);','?,\x20?,\x20\x27yea','\x20FROM\x20acti','\x20the\x20last\x20','unt><d|w|m','\x20?\x20AND\x20tim','y,\x20message','join','UPDATE\x20act','Could\x20not\x20','AND\x20bucket','N\x20(\x27weekly','d\x20TEXT\x20NOT','kly\x27,\x20?,\x20?','r_jid,\x20tim','415220wkemyn','imeframe\x20=','\x20\x20\x20\x20','\x20\x20\x20\x20\x20messa','r:\x20','startOf','message_co','groupMetad','137620iGXKEq','unt,\x20displ','ND\x20bucket_','M\x20active_s','st_updated','_active_st','EXISTS\x20act','imeframe\x20I','\x27,\x27monthly','Y\x20user_jid','ve_stats\x20W','e_count\x20=\x20','ucket_key\x20','UTC','nsureSchem','pdated\x20=\x20?','user_jid','text','\x20NULL,\x0a\x20\x20\x20','EX\x20IF\x20NOT\x20','sendMessag','\x27yearly\x27\x20A','\x20\x20\x20chat_ji','_jid,\x20time','\x20chat_jid,','EGER\x20DEFAU','SELECT\x20id\x20','\x20active\x20us','SET\x20messag','t_jid,\x20use','amount','CREATE\x20IND','y\x20>=\x20?\x0a\x20\x20\x20','toFormat','me(\x27%s\x27,\x27n','[active]\x20p','red','day','ted_at\x20INT','meframe,\x20b','EXISTS\x20idx','_ts\x0a\x20\x20\x20\x20\x20\x20','\x20\x20\x20GROUP\x20B','Usage:\x20act','[active]\x20d','last_ts','7MWgqll','O_YEAR_DAY','daily:\x20YYY','1370bqAYNZ','es\x0a\x0a','yearly','t><d|w|m|y','CREATE\x20TAB','HERE\x20chat_','DELETE\x20FRO','ion\x20INTEGE','M(message_','nMessage\x20f','chema\x20ensu','ive_stats\x20','\x20=\x20\x27daily\x27','monthly\x27|\x27','MM,\x20yearly','ily\x27\x20AND\x20b','SELECT\x20id,','stats\x20WHER','e,\x20bucket_','STS\x20active','clear','sage_count','E(chat_jid','\x20\x20\x20\x20last_u','\x20id\x20IN\x20(','endsWith','essage_cou','year',':\x0a\x0a','1.1.1','OT\x20NULL,\x0a\x20'];_0x2cdb=function(){return _0x566e30;};return _0x2cdb();}function markMsgProcessed(_0x1deed5){const _0xc8aee8=_0x2a5e05;if(!_0x1deed5)return;if(processedMessageKeys[_0xc8aee8(0x11f)](_0x1deed5))clearTimeout(processedMessageKeys['get'](_0x1deed5));const _0x17998d=setTimeout(()=>processedMessageKeys[_0xc8aee8(0x130)](_0x1deed5),CONFIG[_0xc8aee8(0x147)+_0xc8aee8(0x116)]);processedMessageKeys[_0xc8aee8(0xff)](_0x1deed5,_0x17998d);}async function ensureSchema(){const _0x18baf6=_0x2a5e05;try{await db[_0x18baf6(0x11c)](_0x18baf6(0x1ba)+'LE\x20IF\x20NOT\x20'+_0x18baf6(0x18b)+'ive_migrat'+_0x18baf6(0xf8)+_0x18baf6(0x6f)+'R\x20PRIMARY\x20'+_0x18baf6(0x9c)+_0x18baf6(0x1ab)+_0x18baf6(0x19e)+_0x18baf6(0x121)+_0x18baf6(0x1a7)+_0x18baf6(0xec)),await db['exec'](_0x18baf6(0x102)+'ATE\x20TABLE\x20'+_0x18baf6(0x143)+'STS\x20active'+_0x18baf6(0x9f)+'\x20\x20\x20\x20\x20\x20\x20id\x20'+_0x18baf6(0x91)+'IMARY\x20KEY\x20'+_0x18baf6(0x107)+'ENT,\x0a\x20\x20\x20\x20\x20'+_0x18baf6(0x19b)+_0x18baf6(0x17a)+_0x18baf6(0x197)+'\x20\x20\x20\x20\x20user_'+_0x18baf6(0x12c)+_0x18baf6(0x86)+'\x20\x20\x20\x20\x20\x20\x20tim'+_0x18baf6(0xb4)+_0x18baf6(0x10e)+',\x20\x20\x20\x20\x20\x20\x20\x20-'+'-\x20\x27daily\x27|'+'\x27weekly\x27|\x27'+_0x18baf6(0x75)+'yearly\x27\x0a\x20\x20'+_0x18baf6(0xb7)+_0x18baf6(0xde)+_0x18baf6(0x10e)+_0x18baf6(0xf0)+_0x18baf6(0x1b5)+'Y-MM-DD,\x20w'+_0x18baf6(0x135)+_0x18baf6(0xcf)+_0x18baf6(0x115)+_0x18baf6(0x76)+_0x18baf6(0x162)+_0x18baf6(0x180)+'ge_count\x20I'+_0x18baf6(0x12f)+'AULT\x200,\x0a\x20\x20'+_0x18baf6(0x14b)+'lay_name\x20T'+_0x18baf6(0xe6)+'T\x20\x27\x27,\x0a\x20\x20\x20\x20'+_0x18baf6(0x7f)+'pdated\x20INT'+_0x18baf6(0x19e)+_0x18baf6(0x121)+_0x18baf6(0x1a7)+_0x18baf6(0x156)+_0x18baf6(0x149)+_0x18baf6(0x7e)+',\x20user_jid'+_0x18baf6(0xe1)+_0x18baf6(0x7a)+_0x18baf6(0x15c)+'\x20);\x0a\x20\x20\x20\x20'),await db[_0x18baf6(0x11c)](_0x18baf6(0x1a4)+_0x18baf6(0x198)+_0x18baf6(0x1ad)+_0x18baf6(0x18a)+'ats_chat_t'+_0x18baf6(0xd1)+_0x18baf6(0xb6)+_0x18baf6(0xfb)+_0x18baf6(0x1ac)+'ucket_key)'+';'),await db[_0x18baf6(0x11c)](_0x18baf6(0x1a4)+_0x18baf6(0x198)+_0x18baf6(0x1ad)+_0x18baf6(0x18a)+_0x18baf6(0x11e)+'ser\x20ON\x20act'+_0x18baf6(0xd5)+_0x18baf6(0xe0)+_0x18baf6(0x16e)),await db[_0x18baf6(0x11c)](_0x18baf6(0x102)+_0x18baf6(0x8d)+_0x18baf6(0x143)+_0x18baf6(0x7b)+_0x18baf6(0x10c)+_0x18baf6(0x12b)+'s\x20(\x0a\x20\x20\x20\x20\x20\x20'+'\x20\x20chat_jid'+_0x18baf6(0x105)+'ARY\x20KEY,\x0a\x20'+_0x18baf6(0x13f)+_0x18baf6(0xad)+_0x18baf6(0x90)+';\x0a\x20\x20\x20\x20'),info(_0x18baf6(0x113)+_0x18baf6(0x72)+_0x18baf6(0x1a9));}catch(_0x4bbe8c){error(_0x4bbe8c,_0x18baf6(0x13e)+_0x18baf6(0x193)+'a\x20failed');throw _0x4bbe8c;}}export async function trackMessage(_0x1b3be4){const _0x5b926d=_0x2a5e05;try{if(!_0x1b3be4||!_0x1b3be4[_0x5b926d(0x146)]||!_0x1b3be4[_0x5b926d(0xa6)])return;const _0x5e8e9f=makeDedupeKey(_0x1b3be4);if(!_0x5e8e9f)return;if(isMsgProcessed(_0x5e8e9f))return;markMsgProcessed(_0x5e8e9f);if(_0x1b3be4[_0x5b926d(0x146)]['fromMe'])return;const _0x381e32=_0x1b3be4[_0x5b926d(0x146)][_0x5b926d(0xd0)];if(!_0x381e32||!_0x381e32['endsWith']('@g.us'))return;const _0x48cff8=_0x1b3be4['key'][_0x5b926d(0x8f)+'t']||_0x1b3be4[_0x5b926d(0x146)]['from']||'';if(!_0x48cff8)return;const _0x3194c6=normalizeJid(_0x48cff8),_0x249b86=DateTime[_0x5b926d(0xc4)]()[_0x5b926d(0x99)](CONFIG['TIME_ZONE']),_0x5028cb=_0x249b86[_0x5b926d(0x1a6)]('yyyy-LL-dd');try{const _0x3b23b7=await db['run']('\x0a\x20\x20\x20\x20\x20\x20\x20\x20U'+'PDATE\x20acti'+'ve_stats\x0a\x20'+'\x20\x20\x20\x20\x20\x20\x20SET'+_0x5b926d(0xcb)+_0x5b926d(0x151)+_0x5b926d(0x7d)+_0x5b926d(0xf3)+_0x5b926d(0x93)+_0x5b926d(0xd3)+_0x5b926d(0x194)+_0x5b926d(0x152)+_0x5b926d(0x1bb)+_0x5b926d(0x9d)+_0x5b926d(0x164)+'\x20=\x20?\x20AND\x20t'+_0x5b926d(0x17e)+_0x5b926d(0xfa)+_0x5b926d(0x187)+_0x5b926d(0x128)+_0x5b926d(0x17f),[_0x1b3be4['pushName']||_0x1b3be4[_0x5b926d(0xa9)]||'',Math[_0x5b926d(0x126)](_0x249b86[_0x5b926d(0xc8)]()),_0x381e32,_0x3194c6,_0x5028cb]);(!_0x3b23b7||!_0x3b23b7[_0x5b926d(0xa2)])&&await db[_0x5b926d(0x127)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5b926d(0x14c)+_0x5b926d(0xb2)+'stats\x20(cha'+_0x5b926d(0x1a2)+_0x5b926d(0x17c)+_0x5b926d(0x148)+_0x5b926d(0xca)+_0x5b926d(0x183)+_0x5b926d(0x186)+_0x5b926d(0xcd)+'ast_update'+'d)\x0a\x20\x20\x20\x20\x20\x20\x20'+_0x5b926d(0xd6)+_0x5b926d(0xe3)+_0x5b926d(0xe7)+',\x20?,\x20?)\x0a\x20\x20'+_0x5b926d(0xae),[_0x381e32,_0x3194c6,_0x5028cb,_0x1b3be4['pushName']||_0x1b3be4[_0x5b926d(0xa9)]||'',Math['floor'](_0x249b86[_0x5b926d(0xc8)]())]);}catch(_0x22dfd2){warn(_0x5b926d(0xe9)+_0x5b926d(0x117)+_0x5b926d(0x92)+':\x20'+(_0x22dfd2?.['message']||_0x22dfd2));}}catch(_0x55155b){warn(_0x5b926d(0xe9)+_0x5b926d(0x117)+_0x5b926d(0x11b)+_0x5b926d(0x144)+(_0x55155b?.[_0x5b926d(0xa6)]||_0x55155b));}}async function performRollups(){const _0x1aaff1=_0x2a5e05;try{const _0x275cc6=DateTime[_0x1aaff1(0xc4)]()[_0x1aaff1(0x99)](CONFIG[_0x1aaff1(0x163)]),_0x298e20=_0x275cc6[_0x1aaff1(0xd2)]({'days':CONFIG[_0x1aaff1(0x15e)+_0x1aaff1(0xf9)+'S']})[_0x1aaff1(0x182)](_0x1aaff1(0x1aa)),_0x1ecb88=_0x298e20[_0x1aaff1(0x1a6)](_0x1aaff1(0x109)),_0x3153a3=await db[_0x1aaff1(0x108)](_0x1aaff1(0x78)+'\x20chat_jid,'+'\x20user_jid,'+_0x1aaff1(0xdc)+_0x1aaff1(0x174)+_0x1aaff1(0x112)+_0x1aaff1(0xa7)+_0x1aaff1(0x170)+'ve_stats\x20W'+_0x1aaff1(0xf1)+'rame\x20=\x20\x27da'+_0x1aaff1(0x77)+_0x1aaff1(0x191)+'<=\x20?',[_0x1ecb88]);if(_0x3153a3&&_0x3153a3['length']){const _0x35ed44=new Map();for(const _0x4b9e0a of _0x3153a3){const _0x23d4a4=DateTime['fromFormat'](_0x4b9e0a['bucket_key'],_0x1aaff1(0x109),{'zone':CONFIG['TIME_ZONE']}),_0x2bcede=_0x23d4a4['weekYear']+'-'+String(_0x23d4a4[_0x1aaff1(0x13a)])[_0x1aaff1(0x137)](0x6*0x373+0x15c6+0x5*-0x87e,'0'),_0x242153=_0x4b9e0a[_0x1aaff1(0x9e)]+'||'+_0x4b9e0a['user_jid']+'||weekly||'+_0x2bcede;if(!_0x35ed44[_0x1aaff1(0x11f)](_0x242153))_0x35ed44[_0x1aaff1(0xff)](_0x242153,{'chat_jid':_0x4b9e0a[_0x1aaff1(0x9e)],'user_jid':_0x4b9e0a[_0x1aaff1(0x195)],'timeframe':'weekly','bucket_key':_0x2bcede,'message_count':0x0,'display_name':_0x4b9e0a['display_na'+'me']||''});const _0x5d8bcc=_0x35ed44['get'](_0x242153);_0x5d8bcc[_0x1aaff1(0x183)+_0x1aaff1(0xce)]+=Number(_0x4b9e0a[_0x1aaff1(0x183)+_0x1aaff1(0xce)]||0x2567+-0x407*-0x7+-0x4198);}for(const _0x5bfe72 of _0x35ed44['values']()){const _0x38c0f6=await db[_0x1aaff1(0x9a)](_0x1aaff1(0x19f)+_0x1aaff1(0x9b)+_0x1aaff1(0x88)+'ERE\x20chat_j'+_0x1aaff1(0xbf)+'\x20user_jid\x20'+_0x1aaff1(0xa4)+_0x1aaff1(0x133)+'\x27weekly\x27\x20A'+_0x1aaff1(0x187)+_0x1aaff1(0x12e)+_0x1aaff1(0x16d),[_0x5bfe72[_0x1aaff1(0x9e)],_0x5bfe72['user_jid'],_0x5bfe72[_0x1aaff1(0x11a)]]);!_0x38c0f6?await db[_0x1aaff1(0x127)](_0x1aaff1(0x166)+_0x1aaff1(0x104)+_0x1aaff1(0x8c)+_0x1aaff1(0x16a)+_0x1aaff1(0x19c)+_0x1aaff1(0x123)+_0x1aaff1(0xfc)+_0x1aaff1(0x82)+_0x1aaff1(0x106)+_0x1aaff1(0xda)+_0x1aaff1(0x189)+_0x1aaff1(0x10f)+_0x1aaff1(0x14d)+_0x1aaff1(0x17b)+',\x20?,\x20?)',[_0x5bfe72[_0x1aaff1(0x9e)],_0x5bfe72[_0x1aaff1(0x195)],_0x5bfe72['bucket_key'],_0x5bfe72[_0x1aaff1(0x183)+'unt'],_0x5bfe72[_0x1aaff1(0x167)+'me']||'',Math[_0x1aaff1(0x126)](_0x275cc6['toSeconds']())]):await db[_0x1aaff1(0x127)](_0x1aaff1(0x176)+_0x1aaff1(0x73)+_0x1aaff1(0x1a1)+_0x1aaff1(0x190)+'message_co'+_0x1aaff1(0x111)+'isplay_nam'+_0x1aaff1(0xf6)+_0x1aaff1(0xa5)+_0x1aaff1(0x11d)+'id\x20=\x20?',[_0x5bfe72['message_co'+_0x1aaff1(0xce)],_0x5bfe72['display_na'+'me']||'',Math[_0x1aaff1(0x126)](_0x275cc6[_0x1aaff1(0xc8)]()),_0x38c0f6['id']]);}try{const _0xd974e2=_0x3153a3[_0x1aaff1(0x14a)](_0x49f65f=>_0x49f65f['id']);for(let _0x4edd0a=-0xa94+-0x1fb6+0x2*0x1525;_0x4edd0a<_0xd974e2[_0x1aaff1(0x13b)];_0x4edd0a+=0x2d2*0x5+0x322*-0x8+0x39*0x3a){const _0x5ef209=_0xd974e2[_0x1aaff1(0xaf)](_0x4edd0a,_0x4edd0a+(0x385*0x1+-0x2289+0x20f8)),_0x554ae8='DELETE\x20FRO'+'M\x20active_s'+_0x1aaff1(0x159)+_0x1aaff1(0x80)+_0x5ef209[_0x1aaff1(0x14a)](()=>'?')[_0x1aaff1(0x175)](',')+')';await db['run'](_0x554ae8,_0x5ef209);}}catch(_0x88e2b5){warn(_0x1aaff1(0x1b1)+_0x1aaff1(0xd9)+_0x1aaff1(0xcc)+_0x1aaff1(0xc0)+(_0x88e2b5?.[_0x1aaff1(0xa6)]||_0x88e2b5));}}const _0x17eb4b=_0x275cc6[_0x1aaff1(0xd2)]({'days':CONFIG[_0x1aaff1(0x15e)+_0x1aaff1(0x132)+'YS']})[_0x1aaff1(0xc8)](),_0xbbcb8a=await db[_0x1aaff1(0x108)]('SELECT\x20id,'+_0x1aaff1(0x19d)+_0x1aaff1(0x110)+_0x1aaff1(0xdc)+_0x1aaff1(0x174)+_0x1aaff1(0x112)+_0x1aaff1(0xa7)+'\x20FROM\x20acti'+_0x1aaff1(0x18f)+_0x1aaff1(0xf1)+_0x1aaff1(0xac)+'ekly\x27');if(_0xbbcb8a&&_0xbbcb8a[_0x1aaff1(0x13b)]){const _0x1dcaef=new Map();for(const _0x2f1f2b of _0xbbcb8a){const _0x214e25=String(_0x2f1f2b['bucket_key']||'')[_0x1aaff1(0x97)]('-'),_0x9eb5ae=Number(_0x214e25[-0x3ad*-0x7+0x1cc3+-0x367e])||-0x13*0x12e+0x1f*-0x31+-0x240b*-0x1,_0x53be65=Number(_0x214e25[0x1767+-0xee0+-0x886])||0x1*-0x208b+0xa4*0x31+0x128,_0x58370f=DateTime[_0x1aaff1(0xd7)]({'weekYear':_0x9eb5ae,'weekNumber':_0x53be65,'weekday':0x1},{'zone':CONFIG[_0x1aaff1(0x163)]});if(_0x58370f[_0x1aaff1(0xc8)]()>_0x17eb4b)continue;const _0x5683d7=_0x58370f[_0x1aaff1(0x83)]+'-'+String(_0x58370f['month'])['padStart'](0x270e*-0x1+-0x17dc+0x3eec,'0'),_0xfab98d=_0x2f1f2b[_0x1aaff1(0x9e)]+'||'+_0x2f1f2b['user_jid']+('||monthly|'+'|')+_0x5683d7;if(!_0x1dcaef[_0x1aaff1(0x11f)](_0xfab98d))_0x1dcaef[_0x1aaff1(0xff)](_0xfab98d,{'chat_jid':_0x2f1f2b[_0x1aaff1(0x9e)],'user_jid':_0x2f1f2b[_0x1aaff1(0x195)],'timeframe':_0x1aaff1(0x136),'bucket_key':_0x5683d7,'message_count':0x0,'display_name':_0x2f1f2b[_0x1aaff1(0x167)+'me']||'','sourceIds':[]});const _0x3a5a89=_0x1dcaef[_0x1aaff1(0x9a)](_0xfab98d);_0x3a5a89[_0x1aaff1(0x183)+_0x1aaff1(0xce)]+=Number(_0x2f1f2b[_0x1aaff1(0x183)+_0x1aaff1(0xce)]||0x20ea+0x19*0x148+0x6*-0xad3),_0x3a5a89[_0x1aaff1(0xf7)][_0x1aaff1(0x122)](_0x2f1f2b['id']);}for(const _0x66e1b0 of _0x1dcaef['values']()){const _0x12c3e5=await db['get'](_0x1aaff1(0x19f)+_0x1aaff1(0x9b)+_0x1aaff1(0x88)+_0x1aaff1(0x100)+_0x1aaff1(0xbf)+_0x1aaff1(0xf2)+_0x1aaff1(0xa4)+'meframe\x20=\x20'+'\x27monthly\x27\x20'+_0x1aaff1(0x178)+_0x1aaff1(0xb5)+_0x1aaff1(0x165),[_0x66e1b0[_0x1aaff1(0x9e)],_0x66e1b0[_0x1aaff1(0x195)],_0x66e1b0['bucket_key']]);!_0x12c3e5?await db[_0x1aaff1(0x127)](_0x1aaff1(0x166)+_0x1aaff1(0x104)+_0x1aaff1(0x8c)+'_jid,\x20user'+_0x1aaff1(0x19c)+_0x1aaff1(0x123)+'ket_key,\x20m'+_0x1aaff1(0x82)+'nt,\x20displa'+_0x1aaff1(0xda)+_0x1aaff1(0x189)+')\x20VALUES\x20('+_0x1aaff1(0xa3)+'thly\x27,\x20?,\x20'+_0x1aaff1(0x10d),[_0x66e1b0['chat_jid'],_0x66e1b0[_0x1aaff1(0x195)],_0x66e1b0[_0x1aaff1(0x11a)],_0x66e1b0[_0x1aaff1(0x183)+_0x1aaff1(0xce)],_0x66e1b0[_0x1aaff1(0x167)+'me']||'',Math[_0x1aaff1(0x126)](_0x275cc6[_0x1aaff1(0xc8)]())]):await db[_0x1aaff1(0x127)](_0x1aaff1(0x176)+'ive_stats\x20'+'SET\x20messag'+_0x1aaff1(0x190)+_0x1aaff1(0x183)+'unt\x20+\x20?,\x20d'+_0x1aaff1(0x8a)+_0x1aaff1(0xf6)+_0x1aaff1(0xa5)+_0x1aaff1(0x11d)+'id\x20=\x20?',[_0x66e1b0[_0x1aaff1(0x183)+_0x1aaff1(0xce)],_0x66e1b0[_0x1aaff1(0x167)+'me']||'',Math['floor'](_0x275cc6[_0x1aaff1(0xc8)]()),_0x12c3e5['id']]);if(Array[_0x1aaff1(0x158)](_0x66e1b0['sourceIds'])&&_0x66e1b0[_0x1aaff1(0xf7)]['length'])for(let _0x2ea1da=0x24be+0x91c+-0x2dda;_0x2ea1da<_0x66e1b0[_0x1aaff1(0xf7)][_0x1aaff1(0x13b)];_0x2ea1da+=-0x1244+-0x1ae8+0x2f20){const _0xe9a7e=_0x66e1b0[_0x1aaff1(0xf7)][_0x1aaff1(0xaf)](_0x2ea1da,_0x2ea1da+(0x1*-0x1afa+0x1b35+0x1b9)),_0x14610c=_0x1aaff1(0x6e)+_0x1aaff1(0x188)+_0x1aaff1(0x159)+_0x1aaff1(0x80)+_0xe9a7e[_0x1aaff1(0x14a)](()=>'?')[_0x1aaff1(0x175)](',')+')';await db['run'](_0x14610c,_0xe9a7e);}}}const _0x400b8a=_0x275cc6['minus']({'days':CONFIG[_0x1aaff1(0x15e)+_0x1aaff1(0x1b4)+'S']})[_0x1aaff1(0xc8)](),_0x56efa1=await db[_0x1aaff1(0x108)](_0x1aaff1(0x78)+_0x1aaff1(0x19d)+_0x1aaff1(0x110)+_0x1aaff1(0xdc)+'y,\x20message'+_0x1aaff1(0x112)+_0x1aaff1(0xa7)+'\x20FROM\x20acti'+_0x1aaff1(0x18f)+_0x1aaff1(0xf1)+_0x1aaff1(0x138)+_0x1aaff1(0xeb));if(_0x56efa1&&_0x56efa1[_0x1aaff1(0x13b)]){const _0x12ee13=new Map();for(const _0xedd879 of _0x56efa1){const _0x533620=String(_0xedd879[_0x1aaff1(0x11a)]||'')['split']('-'),_0x259180=Number(_0x533620[-0x14*0x185+0x3*-0x8cb+0x38c5])||0x1f34+-0xe8e+-0x8f4,_0x1ede71=DateTime[_0x1aaff1(0xd7)]({'year':_0x259180,'month':0x1,'day':0x1},{'zone':CONFIG['TIME_ZONE']});if(_0x1ede71[_0x1aaff1(0xc8)]()>_0x400b8a)continue;const _0x5af050=''+_0x259180,_0x4fa232=_0xedd879[_0x1aaff1(0x9e)]+'||'+_0xedd879[_0x1aaff1(0x195)]+_0x1aaff1(0xee)+_0x5af050;if(!_0x12ee13[_0x1aaff1(0x11f)](_0x4fa232))_0x12ee13['set'](_0x4fa232,{'chat_jid':_0xedd879[_0x1aaff1(0x9e)],'user_jid':_0xedd879[_0x1aaff1(0x195)],'timeframe':_0x1aaff1(0x1b8),'bucket_key':_0x5af050,'message_count':0x0,'display_name':_0xedd879[_0x1aaff1(0x167)+'me']||'','sourceIds':[]});const _0x407bb6=_0x12ee13[_0x1aaff1(0x9a)](_0x4fa232);_0x407bb6[_0x1aaff1(0x183)+'unt']+=Number(_0xedd879['message_co'+'unt']||-0xa42+-0x2679+0x30bb),_0x407bb6[_0x1aaff1(0xf7)][_0x1aaff1(0x122)](_0xedd879['id']);}for(const _0x1c855e of _0x12ee13[_0x1aaff1(0x16b)]()){const _0x3fa68b=await db[_0x1aaff1(0x9a)](_0x1aaff1(0x19f)+'FROM\x20activ'+'e_stats\x20WH'+_0x1aaff1(0x100)+'id\x20=\x20?\x20AND'+_0x1aaff1(0xf2)+'=\x20?\x20AND\x20ti'+'meframe\x20=\x20'+_0x1aaff1(0x19a)+_0x1aaff1(0x187)+_0x1aaff1(0x12e)+'MIT\x201',[_0x1c855e[_0x1aaff1(0x9e)],_0x1c855e[_0x1aaff1(0x195)],_0x1c855e['bucket_key']]);!_0x3fa68b?await db['run'](_0x1aaff1(0x166)+_0x1aaff1(0x104)+_0x1aaff1(0x8c)+'_jid,\x20user'+_0x1aaff1(0x19c)+_0x1aaff1(0x123)+'ket_key,\x20m'+_0x1aaff1(0x82)+_0x1aaff1(0x106)+'y_name,\x20la'+_0x1aaff1(0x189)+_0x1aaff1(0x10f)+_0x1aaff1(0x16f)+_0x1aaff1(0x157)+_0x1aaff1(0x140),[_0x1c855e['chat_jid'],_0x1c855e[_0x1aaff1(0x195)],_0x1c855e[_0x1aaff1(0x11a)],_0x1c855e[_0x1aaff1(0x183)+_0x1aaff1(0xce)],_0x1c855e[_0x1aaff1(0x167)+'me']||'',Math[_0x1aaff1(0x126)](_0x275cc6['toSeconds']())]):await db['run'](_0x1aaff1(0x176)+'ive_stats\x20'+'SET\x20messag'+_0x1aaff1(0x190)+'message_co'+_0x1aaff1(0x111)+_0x1aaff1(0x8a)+_0x1aaff1(0xf6)+_0x1aaff1(0xa5)+_0x1aaff1(0x11d)+'id\x20=\x20?',[_0x1c855e['message_co'+_0x1aaff1(0xce)],_0x1c855e[_0x1aaff1(0x167)+'me']||'',Math[_0x1aaff1(0x126)](_0x275cc6['toSeconds']()),_0x3fa68b['id']]);if(Array[_0x1aaff1(0x158)](_0x1c855e[_0x1aaff1(0xf7)])&&_0x1c855e[_0x1aaff1(0xf7)][_0x1aaff1(0x13b)])for(let _0x46b4c9=0x797+-0x1191+0x9fa;_0x46b4c9<_0x1c855e[_0x1aaff1(0xf7)][_0x1aaff1(0x13b)];_0x46b4c9+=0x1ae*-0xa+-0x1da5+0x3b9*0xd){const _0x1acb26=_0x1c855e[_0x1aaff1(0xf7)][_0x1aaff1(0xaf)](_0x46b4c9,_0x46b4c9+(-0x2270*-0x1+0xc00+-0x2c7c)),_0x51ce12=_0x1aaff1(0x6e)+_0x1aaff1(0x188)+'tats\x20WHERE'+_0x1aaff1(0x80)+_0x1acb26['map'](()=>'?')[_0x1aaff1(0x175)](',')+')';await db[_0x1aaff1(0x127)](_0x51ce12,_0x1acb26);}}}try{const _0x3e12d3=DateTime[_0x1aaff1(0xc4)]()['setZone'](CONFIG['TIME_ZONE'])[_0x1aaff1(0xd2)]({'days':CONFIG['MAX_DAILY_'+'KEEP_DAYS']})['toFormat'](_0x1aaff1(0x109));await db[_0x1aaff1(0x127)]('DELETE\x20FRO'+_0x1aaff1(0x188)+'tats\x20WHERE'+_0x1aaff1(0x129)+_0x1aaff1(0x74)+'\x20AND\x20bucke'+_0x1aaff1(0x14e),[_0x3e12d3]);}catch(_0x49cabc){warn('[active]\x20p'+_0x1aaff1(0xc9)+'\x20failed:\x20'+(_0x49cabc?.['message']||_0x49cabc));}info('[active]\x20r'+_0x1aaff1(0x13c)+_0x1aaff1(0x145));}catch(_0x3a6de2){error(_0x3a6de2,_0x1aaff1(0x1a8)+_0x1aaff1(0x150)+_0x1aaff1(0xd4)+':\x20'+(_0x3a6de2?.[_0x1aaff1(0xa6)]||_0x3a6de2));}}function parsePeriodArg(_0x97cda4){const _0x58ff68=_0x2a5e05;if(!_0x97cda4)return null;const _0x3a4fa7=String(_0x97cda4)[_0x58ff68(0xc1)]()[_0x58ff68(0xbc)+'e']()[_0x58ff68(0xb8)](/^(\d+)\s*([dwmy])$/);if(!_0x3a4fa7)return null;return{'amount':Number(_0x3a4fa7[-0x1*0x1e4f+0x192*-0x15+0x2*0x1fa5]),'unit':_0x3a4fa7[0x1*-0x652+-0xcf9+-0x225*-0x9]};}function computeCutoffSeconds(_0x249c53,_0x2587ea){const _0x3541b2=_0x2a5e05,_0x2545e1=DateTime[_0x3541b2(0xc4)]()['setZone'](CONFIG[_0x3541b2(0x163)]);let _0x225555;if(_0x2587ea==='d')_0x225555=_0x2545e1[_0x3541b2(0xd2)]({'days':_0x249c53});else{if(_0x2587ea==='w')_0x225555=_0x2545e1[_0x3541b2(0xd2)]({'weeks':_0x249c53});else{if(_0x2587ea==='m')_0x225555=_0x2545e1[_0x3541b2(0xd2)]({'months':_0x249c53});else{if(_0x2587ea==='y')_0x225555=_0x2545e1['minus']({'years':_0x249c53});else _0x225555=_0x2545e1[_0x3541b2(0xd2)]({'days':_0x249c53});}}}return Math[_0x3541b2(0x126)](_0x225555[_0x3541b2(0xc8)]());}async function buildLeaderboardForChat(_0x2375e0,_0x2a7552,_0x59a1b2=CONFIG['USERS_LIMI'+_0x2a5e05(0x120)]){const _0xa425f3=_0x2a5e05;try{const _0x3ad6df=DateTime[_0xa425f3(0xe2)+'s'](_0x2a7552)[_0xa425f3(0x99)](CONFIG[_0xa425f3(0x163)]),_0x36aa67=_0x3ad6df['toFormat'](_0xa425f3(0x109)),_0x2d83b5=await db[_0xa425f3(0x108)](_0xa425f3(0x125)+_0xa425f3(0x10b)+_0xa425f3(0x15b)+'y_name,\x20SU'+_0xa425f3(0x70)+_0xa425f3(0x139)+_0xa425f3(0xc2)+_0xa425f3(0xdd)+'d)\x20AS\x20last'+_0xa425f3(0x1ae)+_0xa425f3(0x9b)+_0xa425f3(0x155)+'\x20\x20\x20\x20WHERE\x20'+_0xa425f3(0x101)+_0xa425f3(0x173)+_0xa425f3(0x8b)+_0xa425f3(0x95)+_0xa425f3(0xdc)+_0xa425f3(0x1a5)+_0xa425f3(0x1af)+_0xa425f3(0x18e)+_0xa425f3(0x141),[_0x2375e0,_0x36aa67]),_0x331113=new Map();for(const _0x5045d5 of _0x2d83b5||[]){const _0x20addd=normalizeJid(_0x5045d5[_0xa425f3(0x195)]);_0x331113[_0xa425f3(0xff)](_0x20addd,{'user_jid':_0x20addd,'display_name':_0x5045d5['display_na'+'me']||_0x20addd['split']('@')[-0x89f*-0x1+-0x3*-0x27+-0x53*0x1c],'count':Number(_0x5045d5['cnt']||0x7ae+-0x2*-0xd2d+-0x2208),'last_ts':Number(_0x5045d5[_0xa425f3(0x1b2)]||0x1d03*-0x1+-0x1f7*-0x2+0x1915)});}const _0x499365=await db[_0xa425f3(0x108)](_0xa425f3(0x131)+_0xa425f3(0x17c)+_0xa425f3(0x148)+'cket_key,\x20'+_0xa425f3(0x183)+_0xa425f3(0x186)+_0xa425f3(0x15d)+_0xa425f3(0xb1)+_0xa425f3(0x79)+_0xa425f3(0x119)+_0xa425f3(0xd8)+_0xa425f3(0x18c)+_0xa425f3(0x179)+_0xa425f3(0x18d)+'\x27,\x27yearly\x27'+')',[_0x2375e0]);for(const _0x2cc0b8 of _0x499365||[]){let _0x6e775c=![];try{if(_0x2cc0b8[_0xa425f3(0x12d)]===_0xa425f3(0xf5)){const _0x23aa3c=String(_0x2cc0b8[_0xa425f3(0x11a)]||'')['split']('-'),_0x5ea007=Number(_0x23aa3c[0x1a*0x101+-0x1321+-0x6f9])||-0x22d8+-0x30*0x3a+0x356a,_0x58c9c4=Number(_0x23aa3c[0x12a*-0x21+-0x1029+0x3694])||0x125d*-0x1+-0x111d+0x237b,_0x341a28=DateTime[_0xa425f3(0xd7)]({'weekYear':_0x5ea007,'weekNumber':_0x58c9c4,'weekday':0x1},{'zone':CONFIG['TIME_ZONE']});if(_0x341a28[_0xa425f3(0xc8)]()>=_0x2a7552)_0x6e775c=!![];}else{if(_0x2cc0b8[_0xa425f3(0x12d)]===_0xa425f3(0x136)){const _0x577b6d=String(_0x2cc0b8['bucket_key']||'')[_0xa425f3(0x97)]('-'),_0xa7bd12=Number(_0x577b6d[-0x72f*-0x1+-0xc5b+0x52c])||-0x1b7f+-0x19a7+0x16*0x2c4,_0x137a9c=Number(_0x577b6d[0x1*0x1ebe+0xadd+-0x299a])||0x503*0x1+0x133b+-0x183d,_0x4d6386=DateTime[_0xa425f3(0xd7)]({'year':_0xa7bd12,'month':_0x137a9c,'day':0x1},{'zone':CONFIG['TIME_ZONE']});if(_0x4d6386[_0xa425f3(0xc8)]()>=_0x2a7552)_0x6e775c=!![];}else{if(_0x2cc0b8[_0xa425f3(0x12d)]===_0xa425f3(0x1b8)){const _0x4f5ec7=Number(String(_0x2cc0b8['bucket_key']||'')[_0xa425f3(0x97)]('-')[0x5*0x49+-0x17ff*-0x1+-0x2*0xcb6])||-0x113e+0x100d+0x19*0x5b,_0x45c409=DateTime[_0xa425f3(0xd7)]({'year':_0x4f5ec7,'month':0x1,'day':0x1},{'zone':CONFIG[_0xa425f3(0x163)]});if(_0x45c409[_0xa425f3(0xc8)]()>=_0x2a7552)_0x6e775c=!![];}else _0x6e775c=!![];}}}catch(_0x4f8457){_0x6e775c=!![];}if(!_0x6e775c)continue;const _0x543f93=normalizeJid(_0x2cc0b8['user_jid']);if(!_0x331113['has'](_0x543f93))_0x331113[_0xa425f3(0xff)](_0x543f93,{'user_jid':_0x543f93,'display_name':_0x2cc0b8[_0xa425f3(0x167)+'me']||_0x543f93[_0xa425f3(0x97)]('@')[-0x202f*0x1+0xc6a+0x13c5],'count':0x0,'last_ts':0x0});_0x331113[_0xa425f3(0x9a)](_0x543f93)['count']+=Number(_0x2cc0b8[_0xa425f3(0x183)+_0xa425f3(0xce)]||0x1d*0xfd+-0x11bf+-0xaea);}const _0x15a72c=Array['from'](_0x331113[_0xa425f3(0x16b)]())['sort']((_0x2bff88,_0x1ec022)=>_0x1ec022[_0xa425f3(0xba)]-_0x2bff88[_0xa425f3(0xba)]||_0x1ec022[_0xa425f3(0x1b2)]-_0x2bff88[_0xa425f3(0x1b2)]);return _0x15a72c[_0xa425f3(0xaf)](-0x5*0x8c+0x1d78+-0x1abc,_0x59a1b2);}catch(_0x107812){return warn('[active]\x20b'+_0xa425f3(0x114)+'board\x20erro'+_0xa425f3(0x181)+(_0x107812?.['message']||_0x107812)),[];}}async function getGroupParticipants(_0x1886d0,_0x494343){const _0x109b26=_0x2a5e05;try{if(!_0x1886d0||typeof _0x1886d0[_0x109b26(0x184)+_0x109b26(0x16c)]!==_0x109b26(0xb0))return[];const _0xf7c5af=await _0x1886d0[_0x109b26(0x184)+_0x109b26(0x16c)](_0x494343),_0x19e617=Array[_0x109b26(0x158)](_0xf7c5af?.[_0x109b26(0x8f)+'ts'])?_0xf7c5af[_0x109b26(0x8f)+'ts']:Object[_0x109b26(0x16b)](_0xf7c5af?.[_0x109b26(0x8f)+'ts']||{}),_0x3e4263=_0x19e617[_0x109b26(0x14a)](_0x4c697d=>_0x4c697d['id'])[_0x109b26(0x8e)](Boolean)['map'](normalizeJid);return _0x3e4263;}catch(_0x43e380){return warn(_0x109b26(0xed)+'etGroupPar'+_0x109b26(0x87)+_0x109b26(0x153)+'\x20'+_0x494343+':\x20'+(_0x43e380?.[_0x109b26(0xa6)]||_0x43e380)),[];}}export async function initialize(_0x313a1c){const _0x4d2ec0=_0x2a5e05;try{botRef=_0x313a1c;if(botRef){if(typeof botRef[_0x4d2ec0(0x199)+'e']===_0x4d2ec0(0xb0))sendApi=(_0x14ff11,_0x4e4d5f)=>botRef[_0x4d2ec0(0x199)+'e'](_0x14ff11,_0x4e4d5f);else{if(botRef['sock']&&typeof botRef[_0x4d2ec0(0x134)][_0x4d2ec0(0x199)+'e']===_0x4d2ec0(0xb0))sendApi=(_0x325ee2,_0x6b102a)=>botRef[_0x4d2ec0(0x134)]['sendMessag'+'e'](_0x325ee2,_0x6b102a);else sendApi=null;}}try{const _0x3f94c1=getConfig()||{};if(_0x3f94c1[_0x4d2ec0(0xaa)]&&typeof _0x3f94c1['ACTIVE']===_0x4d2ec0(0xab))CONFIG={...CONFIG,..._0x3f94c1['ACTIVE']};}catch(_0x1a5435){warn('[active]\x20f'+_0x4d2ec0(0x15a)+_0x4d2ec0(0x118)+_0x4d2ec0(0x94)+(_0x1a5435?.[_0x4d2ec0(0xa6)]||_0x1a5435));}await ensureSchema(),await performRollups(),info(_0x4d2ec0(0xc6)+_0x4d2ec0(0x96));}catch(_0x5c8059){error(_0x5c8059,_0x4d2ec0(0xc6)+'nitialize\x20'+'failed:\x20'+(_0x5c8059?.[_0x4d2ec0(0xa6)]||_0x5c8059));throw _0x5c8059;}}export async function onMessage(_0x315ff0){const _0x37b516=_0x2a5e05;try{await trackMessage(_0x315ff0);if(!_0x315ff0?.['isCommand'])return;const _0x155752=_0x315ff0[_0x37b516(0x146)]?.['remoteJid'];if(!_0x155752||!_0x155752[_0x37b516(0x81)]('@g.us'))return;const _0x286201=await isadmin(botRef,_0x315ff0)[_0x37b516(0xc5)](()=>![]);if(!_0x286201)return;const _0x226f15=typeof _0x315ff0[_0x37b516(0x196)]===_0x37b516(0x154)&&_0x315ff0[_0x37b516(0x196)][_0x37b516(0xc1)]()?_0x315ff0[_0x37b516(0x196)][_0x37b516(0xc1)]():'';if(!_0x226f15)return;const _0x1e0f23=_0x226f15['split'](/\s+/)[_0x37b516(0x8e)](Boolean),_0x32e28a=_0x1e0f23[-0x15fd*0x1+0x21cd*0x1+-0x3*0x3f0]['toLowerCas'+'e']();if(_0x32e28a!==_0x37b516(0xea)&&_0x32e28a!==_0x37b516(0x168))return;const _0x25014=_0x1e0f23[-0x20*0x4+-0x15*0x143+-0x10*-0x1b0]||'1w';let _0x34b8d0=parsePeriodArg(_0x25014);if(!_0x34b8d0){const _0xbf083a=parseInt(_0x25014,0x5*-0x257+-0xca*-0x29+-0x149d);if(!isNaN(_0xbf083a))_0x34b8d0={'amount':_0xbf083a,'unit':'d'};else{const _0x4fe211=_0x37b516(0x1b0)+'ive\x20<amoun'+_0x37b516(0x1b9)+_0x37b516(0x13d)+'ctive\x20<amo'+_0x37b516(0x172)+_0x37b516(0x15f)+'es:\x20active'+_0x37b516(0xfd)+_0x37b516(0xdf)+_0x37b516(0xc7);try{await sendApi(_0x155752,{'text':_0x4fe211});}catch(_0x5e3daf){warn(_0x37b516(0x113)+_0x37b516(0xef)+_0x37b516(0xe4)+(_0x5e3daf?.[_0x37b516(0xa6)]||_0x5e3daf));}return;}}try{await performRollups();}catch(_0xbb94e2){}const _0x4c4e97=computeCutoffSeconds(_0x34b8d0['amount'],_0x34b8d0[_0x37b516(0x142)]);if(_0x32e28a==='active'){const _0x593e92=await buildLeaderboardForChat(_0x155752,_0x4c4e97,CONFIG[_0x37b516(0xf4)+_0x37b516(0x120)]);if(!_0x593e92||_0x593e92['length']===0x8*-0x4c+-0x3*0xc01+0x2663*0x1){await sendApi(_0x155752,{'text':'No\x20active\x20'+'members\x20fo'+'und\x20in\x20the'+_0x37b516(0xb9)+_0x34b8d0[_0x37b516(0x1a3)]+_0x34b8d0[_0x37b516(0x142)]+'.'});return;}let _0x52b265=_0x37b516(0x103)+_0x593e92[_0x37b516(0x13b)]+(_0x37b516(0x1a0)+_0x37b516(0xe8)+_0x37b516(0xb9))+_0x34b8d0[_0x37b516(0x1a3)]+_0x34b8d0['unit']+_0x37b516(0x84);const _0x54fdee=[];let _0x31691d=-0xdb2+0x13f8+-0x646;for(const _0x410f0b of _0x593e92){_0x31691d++;const _0x572471=_0x410f0b[_0x37b516(0x195)][_0x37b516(0x97)]('@')[0x1b6*-0x11+0x10d1+-0x3*-0x417];_0x52b265+=_0x37b516(0xa0)+_0x572471+'\x20('+(_0x410f0b[_0x37b516(0x167)+'me']||_0x572471)+')\x0a',_0x52b265+=romanParen(_0x31691d)+'\x20'+_0x410f0b[_0x37b516(0xba)]+('\x20messages\x0a'+'\x0a'),_0x54fdee['push'](_0x410f0b[_0x37b516(0x195)]);}const _0x14b4f0=-0x81+-0xbf*0x4+0x131d;if(_0x52b265['length']<=_0x14b4f0)await sendApi(_0x155752,{'text':_0x52b265,'mentions':_0x54fdee});else{const _0x4bddac=_0x52b265[_0x37b516(0x97)]('\x0a\x0a');let _0x2dea5a='';for(const _0x4c0d1e of _0x4bddac){if((_0x2dea5a+'\x0a\x0a'+_0x4c0d1e)[_0x37b516(0x13b)]>_0x14b4f0)await sendApi(_0x155752,{'text':_0x2dea5a,'mentions':_0x54fdee}),_0x2dea5a=_0x4c0d1e+'\x0a\x0a';else _0x2dea5a+=(_0x2dea5a?'\x0a\x0a':'')+_0x4c0d1e;}if(_0x2dea5a[_0x37b516(0xc1)]())await sendApi(_0x155752,{'text':_0x2dea5a,'mentions':_0x54fdee});}return;}if(_0x32e28a===_0x37b516(0x168)){const _0x1cec26=botRef?.[_0x37b516(0x134)]||botRef,_0x86100b=await getGroupParticipants(_0x1cec26,_0x155752);if(!_0x86100b||_0x86100b['length']===-0x2f0+-0x1f66+0x2256){await sendApi(_0x155752,{'text':_0x37b516(0x177)+'determine\x20'+_0x37b516(0x124)+_0x37b516(0x169)});return;}const _0xc8073d=await buildLeaderboardForChat(_0x155752,_0x4c4e97,0x166*-0x52+-0x135cd5+0x2311c1),_0x27968c=new Set((_0xc8073d||[])['map'](_0x4791f8=>normalizeJid(_0x4791f8[_0x37b516(0x195)]))),_0x4227fc=_0x86100b[_0x37b516(0x8e)](_0x4017a5=>!_0x27968c['has'](normalizeJid(_0x4017a5)));if(!_0x4227fc[_0x37b516(0x13b)]){await sendApi(_0x155752,{'text':_0x37b516(0xe5)+_0x37b516(0xc3)+_0x37b516(0x89)+'he\x20last\x20'+_0x34b8d0[_0x37b516(0x1a3)]+_0x34b8d0[_0x37b516(0x142)]+'.'});return;}let _0x661118=_0x37b516(0x103)+_0x4227fc[_0x37b516(0x13b)]+(_0x37b516(0xbb)+_0x37b516(0x160)+_0x37b516(0x171))+_0x34b8d0[_0x37b516(0x1a3)]+_0x34b8d0[_0x37b516(0x142)]+_0x37b516(0x84);const _0x1d0f8c=[];let _0x50a50a=0x8*0x493+-0x34f+-0x2149*0x1;for(const _0x513976 of _0x4227fc){_0x50a50a++;const _0xb49454=_0x513976[_0x37b516(0x97)]('@')[-0x47*-0x2f+0x1132+-0x1e3b];_0x661118+=_0x37b516(0xa0)+_0xb49454+'\x20('+_0xb49454+')\x0a',_0x661118+=romanParen(_0x50a50a)+(_0x37b516(0xfe)+_0x37b516(0x1b7)),_0x1d0f8c['push'](_0x513976);}await sendApi(_0x155752,{'text':_0x661118,'mentions':_0x1d0f8c});return;}}catch(_0x2963e4){error(_0x2963e4,_0x37b516(0xbe)+_0x37b516(0x71)+_0x37b516(0x161)+(_0x2963e4?.['message']||_0x2963e4));}}export async function cleanup(){const _0x16824b=_0x2a5e05;try{for(const _0x289a84 of processedMessageKeys['values']())try{clearTimeout(_0x289a84);}catch(_0xee68bc){}processedMessageKeys[_0x16824b(0x7c)]();}catch(_0x38b147){}botRef=null,sendApi=null,info(_0x16824b(0xdb)+'leaned\x20up');}export default{'name':name,'version':version,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};