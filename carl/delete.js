const _0x6cb121=_0x599b;(function(_0x3be93c,_0x5c0840){const _0x1ab4f9=_0x599b,_0x38d9c3=_0x3be93c();while(!![]){try{const _0x5bd98a=parseInt(_0x1ab4f9(0x2d5))/(-0xe0a+-0x1985+0x2790)*(-parseInt(_0x1ab4f9(0x15c))/(0xb63+-0x1*0xe9a+0x21*0x19))+parseInt(_0x1ab4f9(0x1be))/(0x303*0x1+-0x7a0+0x4a0)*(-parseInt(_0x1ab4f9(0x2c2))/(-0x1720+-0x64*0x17+0x2020))+-parseInt(_0x1ab4f9(0x20b))/(-0xc89+-0x44*-0x2e+-0x1*-0x56)+parseInt(_0x1ab4f9(0x2ac))/(0x31*0x1f+0xced+-0x12d6)+-parseInt(_0x1ab4f9(0x297))/(-0x2*-0xff4+-0x13b4+-0xc2d)*(parseInt(_0x1ab4f9(0x16a))/(-0x262d+-0xb4*0xd+0x11*0x2c9))+-parseInt(_0x1ab4f9(0x2df))/(0x1*-0x259+0x1bdc*0x1+-0x43f*0x6)+parseInt(_0x1ab4f9(0x2c7))/(0x1640+0x247*-0x4+-0xd1a)*(parseInt(_0x1ab4f9(0x2cd))/(-0x1*-0x1055+-0x9*-0x31+0x1d*-0x9f));if(_0x5bd98a===_0x5c0840)break;else _0x38d9c3['push'](_0x38d9c3['shift']());}catch(_0x1b0f4e){_0x38d9c3['push'](_0x38d9c3['shift']());}}}(_0x46fa,-0x144d3+0x17e8b*-0x3+-0x2dadf*-0x3));import _0x1b22a4 from'path';import _0x126ec0 from'fs/promises';import{createWriteStream}from'fs';import{pipeline}from'stream/promises';import{downloadContentFromMessage,isJidGroup}from'@whiskeysockets/baileys';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import _0xc9654b from'node-cache';import{isSudo}from'../utils/sudo.js';import{getBotJid,getBotJidRaw}from'../utils/bot-state.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';export const name=_0x6cb121(0x1d9)+'overy';export const version='5.0.0';export const priority=0xfb0*-0x2+-0x1859+-0xb2f*-0x5;export const commands=[_0x6cb121(0x2ea)];export const configKeys=[_0x6cb121(0x233)+_0x6cb121(0x23f),_0x6cb121(0x257)+_0x6cb121(0x26a),_0x6cb121(0x21d)+'CURRENCY',_0x6cb121(0x1a8)+_0x6cb121(0x21a),_0x6cb121(0x2c5)+_0x6cb121(0x186),_0x6cb121(0x2c5)+_0x6cb121(0x26d)+_0x6cb121(0x238),_0x6cb121(0x1e4)+_0x6cb121(0x201)+'E'];const FALLBACKS={'DEBOUNCE_MS':0xbb8,'MEDIA_DIRNAME':_0x6cb121(0x2d9),'DEFAULT_CONCURRENCY':0x2,'CLEANUP_INTERVAL_MS':(0x1*0x5e1+-0x74b+0x170)*(0x15c9+0x168f+-0x4*0xb07)*(-0x1178+0x216c+-0xfb8)*(0x17cf*-0x1+-0x135e+0x2f15),'MEDIA_SEND_DELAY_MS':0x12c,'MAX_SEND_RETRIES':0x3,'INITIAL_BACKOFF_MS':0x1f4,'CLEANUP_DAYS':0x3,'QUEUE_MAX_SIZE':0x1f4};let botRef=null,cleanupInterval=null;const messageQueue=[],deletionQueue=[];let activeMessageTasks=0x20e0+-0x98e+-0x1752,activeDeletionTasks=0xe82+0x25d0+-0x3452,MEDIA_DIR=null,DEBOUNCE_DELAY_MS=FALLBACKS[_0x6cb121(0x1ca)+'S'],CONCURRENCY=FALLBACKS[_0x6cb121(0x1c0)+_0x6cb121(0x29a)],MEDIA_SEND_DELAY_MS=FALLBACKS[_0x6cb121(0x24f)+_0x6cb121(0x2c1)],CLEANUP_INTERVAL=FALLBACKS['CLEANUP_IN'+_0x6cb121(0x1bf)],MAX_SEND_RETRIES=FALLBACKS[_0x6cb121(0x1dd)+_0x6cb121(0x20c)],INITIAL_BACKOFF=FALLBACKS['INITIAL_BA'+'CKOFF_MS'],DELETE_CLEANUP_DAYS=FALLBACKS[_0x6cb121(0x2eb)+'YS'],QUEUE_MAX_SIZE=FALLBACKS[_0x6cb121(0x1aa)+_0x6cb121(0x14c)],DEFAULT_SEND_DELETE=![],DELETE_MODE='p',TARGET_JID=null;const nameCache=new _0xc9654b({'stdTTL':0xe10});let flushTimer=null;const pendingRecovered=[];async function ensureDir(_0x1e56b0){const _0x365f40=_0x6cb121;try{await _0x126ec0[_0x365f40(0x26c)](_0x1e56b0);}catch(_0x295eac){if(_0x295eac[_0x365f40(0x286)]==='ENOENT')await _0x126ec0[_0x365f40(0x190)](_0x1e56b0,{'recursive':!![]});else throw _0x295eac;}}function sleep(_0x553a39){return new Promise(_0x48da01=>setTimeout(_0x48da01,_0x553a39));}function normalizeToUserJid(_0xa2240a){const _0x31ac96=_0x6cb121;try{if(!_0xa2240a||typeof _0xa2240a!==_0x31ac96(0x2a0))return _0xa2240a;const _0x57d864=_0xa2240a[_0x31ac96(0x1fa)]('@');if(_0x57d864===-(-0x10*-0xd8+0x1679+-0x8*0x47f))return _0xa2240a;const _0x427693=_0xa2240a[_0x31ac96(0x19a)](0x2057*0x1+0xdd2+-0x2e29,_0x57d864),_0x5a5ad4=_0xa2240a['slice'](_0x57d864),_0x1126d2=_0x427693[_0x31ac96(0x1fa)](':');if(_0x1126d2===-(-0x2df*0x2+0x17e5+-0x1226))return _0xa2240a;return _0x427693[_0x31ac96(0x19a)](-0x1*-0x1b6f+0x1f3*0x1+-0x1d62,_0x1126d2)+_0x5a5ad4;}catch(_0x4c9ae6){return _0xa2240a;}}function _0x599b(_0x5cbf02,_0x9aa877){const _0x36cdc0=_0x46fa();return _0x599b=function(_0x43a4e1,_0x965494){_0x43a4e1=_0x43a4e1-(-0x2048+-0x1*-0x4fa+0x1c72);let _0x11f8dc=_0x36cdc0[_0x43a4e1];return _0x11f8dc;},_0x599b(_0x5cbf02,_0x9aa877);}async function refreshConfig(){const _0x1507e8=_0x6cb121;try{const _0x3fc109=getConfig()||{};DEFAULT_SEND_DELETE=typeof _0x3fc109[_0x1507e8(0x1a8)+_0x1507e8(0x21a)]===_0x1507e8(0x2a9)?_0x3fc109[_0x1507e8(0x1a8)+_0x1507e8(0x21a)]:DEFAULT_SEND_DELETE,DEBOUNCE_DELAY_MS=Number(_0x3fc109['DELETE_DEB'+'OUNCE_MS']??FALLBACKS['DEBOUNCE_M'+'S']),CONCURRENCY=Number(_0x3fc109[_0x1507e8(0x21d)+'CURRENCY']??_0x3fc109[_0x1507e8(0x1f2)+_0x1507e8(0x17e)+_0x1507e8(0x12d)]??FALLBACKS[_0x1507e8(0x1c0)+'NCURRENCY']),MEDIA_SEND_DELAY_MS=Number(_0x3fc109[_0x1507e8(0x233)+_0x1507e8(0x193)+_0x1507e8(0x1ce)]??FALLBACKS['MEDIA_SEND'+_0x1507e8(0x2c1)]),CLEANUP_INTERVAL=Number(_0x3fc109[_0x1507e8(0x2c5)+_0x1507e8(0x26d)+_0x1507e8(0x238)]??FALLBACKS[_0x1507e8(0x199)+_0x1507e8(0x1bf)]),MAX_SEND_RETRIES=Number(_0x3fc109['DELETE_MAX'+_0x1507e8(0x256)+'IES']??FALLBACKS[_0x1507e8(0x1dd)+_0x1507e8(0x20c)]),INITIAL_BACKOFF=Number(_0x3fc109[_0x1507e8(0x173)+_0x1507e8(0x13d)+_0x1507e8(0x1d7)]??FALLBACKS[_0x1507e8(0x270)+'CKOFF_MS']),DELETE_CLEANUP_DAYS=Number(_0x3fc109[_0x1507e8(0x2c5)+'ANUP_DAYS']??FALLBACKS[_0x1507e8(0x2eb)+'YS']),QUEUE_MAX_SIZE=Number(_0x3fc109[_0x1507e8(0x1e4)+_0x1507e8(0x201)+'E']??FALLBACKS[_0x1507e8(0x1aa)+_0x1507e8(0x14c)]);const _0x2bce37=_0x3fc109['PROJECT_RO'+'OT']&&typeof _0x3fc109[_0x1507e8(0x25d)+'OT']==='string'?_0x3fc109[_0x1507e8(0x25d)+'OT']:process['cwd'](),_0x143a1e=_0x1b22a4['resolve'](_0x2bce37,_0x1507e8(0x1cc),_0x1507e8(0x2ea));await ensureDir(_0x143a1e),MEDIA_DIR=_0x1b22a4[_0x1507e8(0x221)](_0x143a1e,_0x3fc109['DELETE_MED'+_0x1507e8(0x23f)]??_0x3fc109[_0x1507e8(0x233)+'IA_DIR']??FALLBACKS[_0x1507e8(0x144)+'AME']),await ensureDir(MEDIA_DIR);}catch(_0x272260){warn(_0x1507e8(0x203)+_0x1507e8(0x192)+'ig\x20error:\x20'+(_0x272260?.[_0x1507e8(0x277)]||_0x272260));}}try{hotReloadConfig&&hotReloadConfig(()=>{const _0x121afe=_0x6cb121;refreshConfig(),info(_0x121afe(0x1df)+_0x121afe(0x1b6)+'d\x20config.');});}catch(_0x4a555b){warn(_0x6cb121(0x158)+_0x6cb121(0x15f)+_0x6cb121(0x14d)+_0x6cb121(0x1b0)+'iled:\x20'+(_0x4a555b?.[_0x6cb121(0x277)]||_0x4a555b));}refreshConfig();const MESSAGES_COLUMNS={'msg_id':_0x6cb121(0x2ce)+_0x6cb121(0x235),'chat_jid':_0x6cb121(0x181),'remote_alt':'TEXT','sender_jid':_0x6cb121(0x181),'participant_alt':'TEXT','message_json':'TEXT','timestamp':_0x6cb121(0x160),'media_path':'TEXT','saved_at':_0x6cb121(0x160),'resent_at':_0x6cb121(0x160)};async function ensureTable(){const _0x1117d4=_0x6cb121;try{const _0x19db3a=Object[_0x1117d4(0x152)](MESSAGES_COLUMNS)[_0x1117d4(0x125)](([_0x965eab,_0x1f28c9])=>_0x965eab+'\x20'+_0x1f28c9)['join'](',\x0a\x20\x20');await db[_0x1117d4(0x212)](_0x1117d4(0x244)+_0x1117d4(0x16b)+'EXISTS\x20mes'+'sages\x20(\x0a\x20\x20'+_0x19db3a+'\x0a);');let _0xd6f0af=[];try{const _0x3fdb92=await db[_0x1117d4(0x1e5)](_0x1117d4(0x246)+_0x1117d4(0x1e1)+_0x1117d4(0x1d8));_0xd6f0af=(_0x3fdb92||[])[_0x1117d4(0x125)](_0x2d3e90=>_0x2d3e90['name']);}catch(_0x2b7460){warn(_0x1117d4(0x137)+_0x1117d4(0x12f)+_0x1117d4(0x16d)+_0x1117d4(0x2bd)+(_0x2b7460?.['message']||_0x2b7460));}for(const _0x3a65d0 of Object['keys'](MESSAGES_COLUMNS)){if(!_0xd6f0af[_0x1117d4(0x1b7)](_0x3a65d0)){const _0x53a968=MESSAGES_COLUMNS[_0x3a65d0];try{await db['run']('ALTER\x20TABL'+_0x1117d4(0x151)+_0x1117d4(0x191)+'N\x20'+_0x3a65d0+'\x20'+_0x53a968),info(_0x1117d4(0x1cd)+_0x1117d4(0x1af)+'ng\x20column\x20'+_0x1117d4(0x27d)+_0x3a65d0);}catch(_0x4aec41){warn(_0x1117d4(0x1a3)+_0x1117d4(0x1d5)+_0x1117d4(0x20a)+_0x3a65d0+':\x20'+(_0x4aec41?.[_0x1117d4(0x277)]||_0x4aec41));}}}await db[_0x1117d4(0x212)]('CREATE\x20TAB'+_0x1117d4(0x16b)+_0x1117d4(0x1cb)+'ete_prefs\x20'+_0x1117d4(0x189)+'y\x20TEXT\x20PRI'+_0x1117d4(0x20f)+_0x1117d4(0x293)+_0x1117d4(0x21e)+_0x1117d4(0x197)+_0x1117d4(0x2cb)+'_at\x20INTEGE'+_0x1117d4(0x183)+_0x1117d4(0x27c));try{const _0x59baf1=await db[_0x1117d4(0x218)](_0x1117d4(0x23b)+_0x1117d4(0x2d7)+'lete_prefs'+_0x1117d4(0x211)+_0x1117d4(0x15e));if(!_0x59baf1){const _0x2c0a1b=Math[_0x1117d4(0x130)](Date['now']()/(-0x2*-0xf43+-0x16ba+-0x3e4));await db['run'](_0x1117d4(0x2b4)+_0x1117d4(0x1fb)+_0x1117d4(0x1f1)+_0x1117d4(0x1f3)+'dated_at)\x20'+_0x1117d4(0x2ad)+_0x1117d4(0x139)+'?)',[_0x2c0a1b]),DELETE_MODE='p';}else DELETE_MODE=_0x59baf1[_0x1117d4(0x2da)]==='g'?'g':'p';}catch(_0xc06e82){warn('[Delete]\x20p'+_0x1117d4(0x17b)+')\x20load\x20fai'+_0x1117d4(0x2bd)+(_0xc06e82?.[_0x1117d4(0x277)]||_0xc06e82));}try{const _0x111f0d=await db['get']('SELECT\x20val'+_0x1117d4(0x2d7)+_0x1117d4(0x124)+_0x1117d4(0x211)+_0x1117d4(0x273)+'id\x27');TARGET_JID=_0x111f0d?.[_0x1117d4(0x2da)]||null;}catch(_0x4cc830){warn(_0x1117d4(0x140)+_0x1117d4(0x1bb)+'load\x20faile'+'d:\x20'+(_0x4cc830?.[_0x1117d4(0x277)]||_0x4cc830)),TARGET_JID=null;}}catch(_0xe72986){warn(_0x1117d4(0x274)+_0x1117d4(0x288)+_0x1117d4(0x2b6)+':\x20'+(_0xe72986?.[_0x1117d4(0x277)]||_0xe72986));throw _0xe72986;}}async function streamMediaToFile(_0x5badad,_0x2074d8){const _0x20cbef=_0x6cb121;try{const _0x35be24=_0x5badad[_0x20cbef(0x277)][_0x2074d8+'Message'],_0x242afe=await downloadContentFromMessage(_0x35be24,_0x2074d8);let _0x11c1bf=_0x20cbef(0x219);if(_0x2074d8===_0x20cbef(0x2dc))_0x11c1bf=_0x20cbef(0x1b3);else{if(_0x2074d8===_0x20cbef(0x217)||_0x2074d8===_0x20cbef(0x25b))_0x11c1bf=_0x20cbef(0x1fd);else{if(_0x2074d8===_0x20cbef(0x1bc))_0x11c1bf=_0x20cbef(0x142);else{if(_0x2074d8===_0x20cbef(0x143))_0x11c1bf=_0x35be24?.[_0x20cbef(0x280)]?_0x35be24[_0x20cbef(0x280)][_0x20cbef(0x1fe)]('.')['pop']():_0x20cbef(0x29c);else{if(_0x2074d8===_0x20cbef(0x264))_0x11c1bf='webp';}}}}const _0x393d1e=_0x5badad[_0x20cbef(0x128)]['id']+'.'+_0x11c1bf,_0x440ecb=_0x1b22a4[_0x20cbef(0x221)](MEDIA_DIR,_0x393d1e);await pipeline(_0x242afe,createWriteStream(_0x440ecb));const _0x5bd648=await _0x126ec0['stat'](_0x440ecb);if(_0x5bd648[_0x20cbef(0x226)]===-0x1a58+-0x2*-0x2a1+-0xa8b*-0x2)return warn(_0x20cbef(0x2bb)+_0x20cbef(0x1ad)+_0x440ecb+(_0x20cbef(0x1a0)+_0x20cbef(0x275))),await _0x126ec0['rm'](_0x440ecb,{'force':!![]}),null;return _0x440ecb;}catch(_0x1501c9){return warn(_0x20cbef(0x2bb)+_0x20cbef(0x23d)+_0x20cbef(0x195)+_0x20cbef(0x180)+(_0x5badad[_0x20cbef(0x128)]?.['id']||_0x20cbef(0x243))+':\x20'+(_0x1501c9?.[_0x20cbef(0x277)]||_0x1501c9)),null;}}async function maybeSaveMedia(_0x4aec03){const _0x1856c7=_0x6cb121;try{const _0x812645=['image',_0x1856c7(0x217),_0x1856c7(0x25b),_0x1856c7(0x1bc),'document',_0x1856c7(0x264)];for(const _0x57ee44 of _0x812645){if(_0x57ee44==='ptv'){if(_0x4aec03[_0x1856c7(0x277)]?.['ptvMessage'])return await streamMediaToFile(_0x4aec03,'ptv');continue;}if(_0x4aec03['message']?.[_0x57ee44+_0x1856c7(0x161)])return await streamMediaToFile(_0x4aec03,_0x57ee44);}return null;}catch(_0x13071b){return warn('[Delete]\x20m'+_0x1856c7(0x1bd)+_0x1856c7(0x248)+'\x20'+(_0x13071b?.[_0x1856c7(0x277)]||_0x13071b)),null;}}async function insertMessageToDB(_0x34d4bd,_0x2c5090){const _0x3a0a48=_0x6cb121;try{if(!_0x34d4bd||!_0x34d4bd[_0x3a0a48(0x128)])return;const {id:_0x530a86,remoteJid:_0x199f5d,participant:_0x4188af}=_0x34d4bd[_0x3a0a48(0x128)],_0x2697e5=_0x4188af||_0x199f5d,_0x5e2cb9=typeof _0x34d4bd[_0x3a0a48(0x228)+'estamp']===_0x3a0a48(0x154)?_0x34d4bd[_0x3a0a48(0x228)+_0x3a0a48(0x1c2)]:_0x34d4bd[_0x3a0a48(0x228)+_0x3a0a48(0x1c2)]?.[_0x3a0a48(0x16f)]||Math[_0x3a0a48(0x130)](Date[_0x3a0a48(0x1d2)]()/(0x91*0x14+0x160c+0x4*-0x75e)),_0x46f4f2=_0x34d4bd[_0x3a0a48(0x128)]?.['remoteJidA'+'lt']||null,_0x2c8720=_0x34d4bd['key']?.[_0x3a0a48(0x133)+'tAlt']||null,_0x38c370=Math[_0x3a0a48(0x130)](Date[_0x3a0a48(0x1d2)]()/(-0x3*-0x618+-0x125+0x469*-0x3));if(!_0x530a86){warn(_0x3a0a48(0x194)+_0x3a0a48(0x17d)+_0x3a0a48(0x282)+_0x3a0a48(0x2d1)+'id');return;}const _0x40749=_0x3a0a48(0x164)+_0x3a0a48(0x1dc)+_0x3a0a48(0x22a)+_0x3a0a48(0x255)+_0x3a0a48(0x2de)+_0x3a0a48(0x2b5)+'t,\x20sender_'+_0x3a0a48(0x12c)+'cipant_alt'+',\x20message_'+_0x3a0a48(0x14a)+_0x3a0a48(0x14e)+_0x3a0a48(0x1a1)+_0x3a0a48(0x2b1)+_0x3a0a48(0x2c0)+_0x3a0a48(0x177)+_0x3a0a48(0x1d6)+_0x3a0a48(0x22c)+',\x20?,\x20?,\x20?,'+'\x20?)',_0x5eff4c=[_0x530a86,_0x199f5d||null,_0x46f4f2,_0x2697e5||null,_0x2c8720,JSON[_0x3a0a48(0x200)](_0x34d4bd),_0x5e2cb9,_0x2c5090||null,_0x38c370,null];try{await db[_0x3a0a48(0x254)](_0x40749,_0x5eff4c);}catch(_0x17d82d){const _0x5943dc=String(_0x17d82d?.[_0x3a0a48(0x277)]||'');if(_0x5943dc[_0x3a0a48(0x1b7)](_0x3a0a48(0x132)+_0x3a0a48(0x1c9))){warn(_0x3a0a48(0x194)+_0x3a0a48(0x1a2)+'ed\x20due\x20mis'+_0x3a0a48(0x2b7)+_0x3a0a48(0x2b9)+_0x5943dc+(_0x3a0a48(0x263)+'g\x20table\x20an'+_0x3a0a48(0x29d)));try{await ensureTable(),await db[_0x3a0a48(0x254)](_0x40749,_0x5eff4c);}catch(_0x43e4d3){warn('[Delete]\x20r'+'etry\x20inser'+_0x3a0a48(0x2c9)+(_0x43e4d3?.[_0x3a0a48(0x277)]||_0x43e4d3));}}else throw _0x17d82d;}}catch(_0x484b15){warn(_0x3a0a48(0x194)+_0x3a0a48(0x17d)+'geToDB\x20fai'+_0x3a0a48(0x2bd)+(_0x484b15?.[_0x3a0a48(0x277)]||_0x484b15));}}async function fetchOriginalMessage(_0x5db5a3){const _0x4be6ee=_0x6cb121;try{if(!_0x5db5a3)return null;const _0x68626c=await db[_0x4be6ee(0x218)](_0x4be6ee(0x2ec)+_0x4be6ee(0x18c)+_0x4be6ee(0x1b1)+_0x4be6ee(0x2e4)+'\x20saved_at\x20'+_0x4be6ee(0x2ab)+_0x4be6ee(0x1b5)+_0x4be6ee(0x236),[_0x5db5a3]);if(_0x68626c)try{return{'msg_id':_0x68626c['msg_id'],'message':JSON[_0x4be6ee(0x1e8)](_0x68626c['message_js'+'on']),'media_path':_0x68626c[_0x4be6ee(0x153)],'saved_at':_0x68626c[_0x4be6ee(0x184)]};}catch(_0x2c835f){return{'msg_id':_0x68626c[_0x4be6ee(0x2cf)],'message':null,'media_path':_0x68626c[_0x4be6ee(0x153)],'saved_at':_0x68626c[_0x4be6ee(0x184)]};}return null;}catch(_0x3bb1b8){return warn(_0x4be6ee(0x1a3)+_0x4be6ee(0x1d4)+_0x4be6ee(0x1ea)+'error:\x20'+(_0x3bb1b8?.['message']||_0x3bb1b8)),null;}}async function deleteMessageRow(_0x462f2c){const _0x59715d=_0x6cb121;try{if(!_0x462f2c)return;const _0x32028e=await db[_0x59715d(0x218)](_0x59715d(0x15b)+'ia_path\x20FR'+_0x59715d(0x159)+_0x59715d(0x2d4)+_0x59715d(0x18a),[_0x462f2c]);if(_0x32028e?.[_0x59715d(0x153)])try{await _0x126ec0['rm'](_0x32028e[_0x59715d(0x153)],{'force':!![]});}catch(_0x308685){warn(_0x59715d(0x1a3)+_0x59715d(0x23a)+_0x59715d(0x22e)+'\x20'+_0x32028e[_0x59715d(0x153)]+':\x20'+(_0x308685?.[_0x59715d(0x277)]||_0x308685));}await db[_0x59715d(0x254)](_0x59715d(0x2b0)+_0x59715d(0x2db)+_0x59715d(0x205)+_0x59715d(0x174),[_0x462f2c]),info('[Delete]\x20d'+'eleted\x20mes'+_0x59715d(0x27b)+'\x20'+_0x462f2c);}catch(_0x48010d){warn(_0x59715d(0x1f0)+_0x59715d(0x258)+_0x59715d(0x14b)+_0x59715d(0x17f)+(_0x48010d?.['message']||_0x48010d));}}async function sendWithRetry(_0x1eea8f,_0x45f724,_0x287a76=[]){const _0x170a1e=_0x6cb121,_0x15b3e0=Number(MAX_SEND_RETRIES||FALLBACKS[_0x170a1e(0x1dd)+'ETRIES']);let _0x5317f0=0x1aa*-0x14+-0x136c+0x34b4,_0x1aa868=Number(INITIAL_BACKOFF||FALLBACKS['INITIAL_BA'+'CKOFF_MS']);const _0x2953b5=[_0x1eea8f,TARGET_JID,getBotJid()][_0x170a1e(0x278)](Boolean)['map'](normalizeToUserJid),_0x354564=new Set(),_0x361b64=[];for(const _0x2d3d9e of _0x2953b5){if(!_0x2d3d9e)continue;!_0x354564[_0x170a1e(0x1f9)](_0x2d3d9e)&&(_0x354564[_0x170a1e(0x1d3)](_0x2d3d9e),_0x361b64[_0x170a1e(0x1ff)](_0x2d3d9e));}let _0x183282=_0x361b64[_0x170a1e(0x2c4)]?_0x361b64[0xe41*0x1+-0x1*-0x1f49+0xf2e*-0x3]:null;if(_0x183282&&_0x183282['endsWith'](_0x170a1e(0x213))&&typeof botRef?.[_0x170a1e(0x2a4)]?.['onWhatsApp']===_0x170a1e(0x16e))try{const _0x20209b=await botRef[_0x170a1e(0x2a4)][_0x170a1e(0x1f6)](_0x183282);if(Array['isArray'](_0x20209b)&&_0x20209b[-0x355*0x3+-0x1*-0x160e+-0x1*0xc0f]&&_0x20209b[-0x1e8f+0x45*0x50+-0x31*-0x2f]['jid'])_0x183282=normalizeToUserJid(_0x20209b[-0x3cc+-0x1638+-0x14*-0x14d][_0x170a1e(0x239)]);}catch(_0x2d5e57){warn(_0x170a1e(0x1ac)+_0x170a1e(0x182)+'mapping\x20fa'+_0x170a1e(0x2ba)+(_0x2d5e57?.[_0x170a1e(0x277)]||_0x2d5e57));}while(_0x5317f0<_0x15b3e0){try{if(!_0x183282)throw new Error(_0x170a1e(0x148)+_0x170a1e(0x2b3)+_0x170a1e(0x204));if(Array['isArray'](_0x287a76)&&_0x287a76['length']&&typeof _0x45f724===_0x170a1e(0x268)&&_0x45f724!==null)_0x45f724[_0x170a1e(0x2a5)]=_0x287a76;return await botRef[_0x170a1e(0x155)+'e'](_0x183282,_0x45f724),!![];}catch(_0x53dca3){_0x5317f0++;const _0x40e304=String(_0x53dca3?.[_0x170a1e(0x277)]||'')[_0x170a1e(0x172)+'e']()[_0x170a1e(0x1b7)](_0x170a1e(0x1ed))||_0x53dca3?.[_0x170a1e(0x1e9)]===-0x1e43+-0x87d+-0x286d*-0x1;warn('[Delete]\x20s'+_0x170a1e(0x2e1)+'t\x20'+_0x5317f0+_0x170a1e(0x16c)+_0x183282+_0x170a1e(0x285)+(_0x53dca3?.['message']||_0x53dca3));if(_0x5317f0>=_0x15b3e0||!_0x40e304)return![];await sleep(_0x1aa868),_0x1aa868*=0x8c5+-0x299+0x315*-0x2;}}return![];}function extractContent(_0x520e1c){const _0x42432f=_0x6cb121;if(!_0x520e1c)return'';if(_0x520e1c[_0x42432f(0x14f)+'on'])return _0x520e1c[_0x42432f(0x14f)+'on'];if(_0x520e1c[_0x42432f(0x28f)+_0x42432f(0x2dd)])return _0x520e1c[_0x42432f(0x28f)+_0x42432f(0x2dd)]['text'];if(_0x520e1c[_0x42432f(0x290)+'ge'])return _0x520e1c[_0x42432f(0x290)+'ge'][_0x42432f(0x1e2)]||'';if(_0x520e1c[_0x42432f(0x17c)+'ge'])return _0x520e1c[_0x42432f(0x17c)+'ge'][_0x42432f(0x1e2)]||'';if(_0x520e1c[_0x42432f(0x135)])return _0x520e1c['ptvMessage'][_0x42432f(0x1e2)]||'';if(_0x520e1c[_0x42432f(0x170)+'ge'])return _0x520e1c[_0x42432f(0x170)+'ge']?.[_0x42432f(0x179)]?_0x42432f(0x276)+'e]':_0x42432f(0x259);if(_0x520e1c[_0x42432f(0x267)+_0x42432f(0x147)])return _0x520e1c[_0x42432f(0x267)+_0x42432f(0x147)][_0x42432f(0x280)]||'';if(_0x520e1c[_0x42432f(0x26e)+'sage'])return _0x42432f(0x2ca);if(_0x520e1c[_0x42432f(0x1b4)+_0x42432f(0x261)+'3'])return _0x42432f(0x216)+(_0x520e1c[_0x42432f(0x1b4)+_0x42432f(0x261)+'3'][_0x42432f(0x15a)]||'poll')+']';return _0x42432f(0x20e);}function isMediaMessage(_0x3b06ee){const _0x8ea966=_0x6cb121;if(!_0x3b06ee)return![];const _0x19084e=Object[_0x8ea966(0x171)](_0x3b06ee||{});for(const _0x79ccff of _0x19084e){if(_0x79ccff[_0x8ea966(0x141)]('Message')&&['imageMessa'+'ge',_0x8ea966(0x17c)+'ge',_0x8ea966(0x170)+'ge',_0x8ea966(0x267)+'ssage',_0x8ea966(0x26e)+'sage',_0x8ea966(0x135)][_0x8ea966(0x1b7)](_0x79ccff))return!![];}return![];}async function buildPayloadForSavedFile(_0x10a380,_0x4e74b0){const _0x124ffd=_0x6cb121,_0x5d20e3=_0x4e74b0?.[_0x124ffd(0x277)]||{},_0x35b330=extractContent(_0x5d20e3)||undefined;try{await _0x126ec0[_0x124ffd(0x26c)](_0x10a380);}catch(_0x140102){return warn('[Delete]\x20M'+_0x124ffd(0x23c)+_0x124ffd(0x2e8)+_0x124ffd(0x2e7)+_0x10a380),null;}if(_0x5d20e3['stickerMes'+_0x124ffd(0x162)])return{'sticker':{'url':_0x10a380}};if(_0x5d20e3['ptvMessage'])return{'video':{'url':_0x10a380},'ptv':!![],'caption':_0x35b330,'mimetype':_0x5d20e3[_0x124ffd(0x135)]?.['mimetype']};if(_0x5d20e3[_0x124ffd(0x17c)+'ge'])return{'video':{'url':_0x10a380},'caption':_0x35b330,'gifPlayback':!!_0x5d20e3[_0x124ffd(0x17c)+'ge']?.['gifPlaybac'+'k'],'mimetype':_0x5d20e3['videoMessa'+'ge']?.['mimetype']};if(_0x5d20e3['imageMessa'+'ge'])return{'image':{'url':_0x10a380},'caption':_0x35b330};if(_0x5d20e3['audioMessa'+'ge'])return{'audio':{'url':_0x10a380},'ptt':!!_0x5d20e3['audioMessa'+'ge']?.['ptt'],'mimetype':_0x5d20e3[_0x124ffd(0x170)+'ge']?.[_0x124ffd(0x149)],'seconds':_0x5d20e3['audioMessa'+'ge']?.['seconds']};if(_0x5d20e3['documentMe'+_0x124ffd(0x147)])return{'document':{'url':_0x10a380,'fileName':_0x5d20e3[_0x124ffd(0x267)+_0x124ffd(0x147)]?.[_0x124ffd(0x280)]||_0x1b22a4[_0x124ffd(0x25f)](_0x10a380)},'mimetype':_0x5d20e3[_0x124ffd(0x267)+_0x124ffd(0x147)]?.[_0x124ffd(0x149)],'caption':_0x5d20e3['documentMe'+'ssage']?.['caption']||_0x35b330};return{'document':{'url':_0x10a380,'fileName':_0x1b22a4[_0x124ffd(0x25f)](_0x10a380)},'caption':_0x35b330};}async function processDeletionItem(_0x402913){const _0x3d1a03=_0x6cb121;try{const _0x3a909a=_0x402913['keys']||[];if(!_0x3a909a[_0x3d1a03(0x2c4)])return;for(const _0x20375b of _0x3a909a){const _0x4ea1c0=await fetchOriginalMessage(_0x20375b['id']);if(!_0x4ea1c0||!_0x4ea1c0[_0x3d1a03(0x277)])continue;const _0x13e7ce=_0x4ea1c0[_0x3d1a03(0x277)],_0x405c8a=getBotJidRaw(),_0x43a8db=_0x13e7ce[_0x3d1a03(0x128)]?.[_0x3d1a03(0x133)+'t']||_0x13e7ce[_0x3d1a03(0x128)]?.['remoteJid'];if(_0x13e7ce[_0x3d1a03(0x128)]?.['fromMe']||_0x43a8db===_0x405c8a)continue;const _0x350c17=_0x13e7ce[_0x3d1a03(0x128)][_0x3d1a03(0x133)+'t']||_0x13e7ce[_0x3d1a03(0x128)][_0x3d1a03(0x21b)],_0x455c68=extractContent(_0x13e7ce[_0x3d1a03(0x277)]);let _0x4b30f0=nameCache[_0x3d1a03(0x218)](_0x350c17);if(!_0x4b30f0){try{const [_0x138c07]=await botRef[_0x3d1a03(0x2a4)][_0x3d1a03(0x1f6)](_0x350c17);_0x4b30f0=_0x138c07?.[_0x3d1a03(0x134)]||'~'+_0x350c17[_0x3d1a03(0x1fe)]('@')[0x497*0x1+-0x1*-0x404+-0x89b];}catch{_0x4b30f0='~'+_0x350c17[_0x3d1a03(0x1fe)]('@')[0x1e97+0x18b1+0x6e9*-0x8];}nameCache['set'](_0x350c17,_0x4b30f0);}let _0x168700='';if(isJidGroup(_0x13e7ce[_0x3d1a03(0x128)]['remoteJid']))try{_0x168700=(await botRef[_0x3d1a03(0x2a4)][_0x3d1a03(0x1e0)+_0x3d1a03(0x2a2)](_0x13e7ce[_0x3d1a03(0x128)]['remoteJid']))[_0x3d1a03(0x240)];}catch{_0x168700=_0x3d1a03(0x2bc)+_0x3d1a03(0x28c);}deletionPush({'msg_id':_0x4ea1c0[_0x3d1a03(0x2cf)],'sender':_0x350c17,'name':_0x4b30f0,'group':_0x168700,'content':_0x455c68,'mediaPath':_0x4ea1c0[_0x3d1a03(0x153)]||null,'originalMessage':_0x13e7ce});}}catch(_0xb7c5ec){warn(_0x3d1a03(0x136)+_0x3d1a03(0x1ab)+'tionItem\x20e'+_0x3d1a03(0x2a7)+(_0xb7c5ec?.['message']||_0xb7c5ec));}}async function deletionWorker(){const _0x45743b=_0x6cb121,_0x19ce18=CONCURRENCY||FALLBACKS[_0x45743b(0x1c0)+_0x45743b(0x29a)];while(deletionQueue[_0x45743b(0x2c4)]>0x1ad1+0xd78+0x2849*-0x1&&activeDeletionTasks<_0x19ce18){const _0x32bf40=deletionQueue[_0x45743b(0x227)]();if(!_0x32bf40)break;activeDeletionTasks++,((async()=>{const _0x1d586e=_0x45743b;try{await processDeletionItem(_0x32bf40);}catch(_0x38aa5d){warn('[Delete]\x20d'+_0x1d586e(0x23e)+'ker\x20item\x20e'+_0x1d586e(0x2a7)+(_0x38aa5d?.[_0x1d586e(0x277)]||_0x38aa5d));}finally{activeDeletionTasks--,setImmediate(()=>{const _0x912c2f=_0x1d586e;if(deletionQueue['length'])deletionWorker()[_0x912c2f(0x202)](()=>{});});}})());}}function deletionPush(_0xa3d5db){const _0x1a6026=_0x6cb121;pendingRecovered[_0x1a6026(0x1ff)](_0xa3d5db),clearTimeout(flushTimer),flushTimer=setTimeout(()=>{const _0x357bd0=_0x1a6026,_0x572eb0=pendingRecovered['splice'](0x210c+-0x24bf+-0x3b3*-0x1,pendingRecovered[_0x357bd0(0x2c4)]);((async()=>{const _0x876bdb=_0x357bd0;try{await flushRecoveredBatch(_0x572eb0);}catch(_0x5e3376){warn(_0x876bdb(0x1a3)+_0x876bdb(0x252)+_0x876bdb(0x168)+_0x876bdb(0x2a7)+(_0x5e3376?.[_0x876bdb(0x277)]||_0x5e3376));}})());},DEBOUNCE_DELAY_MS||FALLBACKS[_0x1a6026(0x1ca)+'S']);}function resolveDeleteTarget(_0xdd1f70){const _0x37d9c9=getBotJid();if(DELETE_MODE==='g'&&TARGET_JID){if(TARGET_JID===_0xdd1f70)return _0x37d9c9;return TARGET_JID;}return _0x37d9c9;}function _0x46fa(){const _0x3c610c=['nWhatsApp\x20','R\x20DEFAULT\x20','saved_at','ges\x20(older','ANUP_DAYS','try/cleanu','ueue\x20is\x20fu','(\x0a\x20\x20\x20\x20\x20\x20ke','g_id=?','t=excluded','_id,\x20messa','is\x20set.',').\x20Droppin','key)\x20DO\x20UP','mkdir','\x20ADD\x20COLUM','efreshConf','IA_SEND_DE','[Delete]\x20i','ToFile\x20fai','r\x20later\x20re','\x20NULL,\x0a\x20\x20\x20','EFAULT_SEN','CLEANUP_IN','slice','awMessages','remove','find','unset','id>\x20\x20\x20\x20\x20->','\x20is\x20empty,','ia_path,\x20s','nsert\x20fail','[Delete]\x20f','\x20event.','annot\x20dete','d\x20may\x20have','_id,\x20media','DEFAULT_SE','\x20days*','QUEUE_MAX_','rocessDele','[Delete]\x20o','aved\x20file\x20','No\x20target\x20','dded\x20missi','tration\x20fa','ge_json,\x20m','alue=exclu','jpg','pollCreati','ges\x20WHERE\x20','ot-reloade','includes','trim','ting\x20file\x20','\x20message.','arget_jid\x20','audio','aybeSaveMe','20496tDtmYg','TERVAL_MS','DEFAULT_CO','ummary\x20sen','estamp','\x20CONFLICT(','and\x20reply\x20','vered\x20send','originalMe','\x20send\x20reco','group\x20\x20\x20->','umn','DEBOUNCE_M','EXISTS\x20del','data','[Delete]\x20a','LAY_MS','ode\x20set\x20to','isArray','edia\x20sent\x20','now','add','etchOrigin','ailed\x20to\x20a','ES\x20(?,\x20?,\x20','FF_MS','essages\x27)','delete-rec','ard\x20error:','ode\x20saved:','REPLACE\x20IN','MAX_SEND_R','o\x20send\x20tar','[Delete]\x20H','groupMetad','le_info(\x27m','caption','delete\x20mod','DELETE_QUE','all','dMessages\x20','cleared','parse','status','alMessage\x20','ot\x20PM\x0a','fromMe','rate','ecovered\x20o','\x20PM.','[Delete]\x20d','refs\x20(key,','MODULE_CON','\x20value,\x20up','uded.updat','[Delete]\x20D','onWhatsApp','group','adcast','has','indexOf','O\x20delete_p','afe\x20error:','mp4','split','push','stringify','UE_MAX_SIZ','catch','[Delete]\x20r','able','\x20WHERE\x20msg','\x20set\x20targe','failed:\x20','essage\x20sav','[Delete]\x20l','dd\x20column\x20','497930eIbSUC','ETRIES','\x20failed','[Media]','MARY\x20KEY,\x0a','d_at\x20IS\x20NO','\x20WHERE\x20key','exec','@lid','clear','edia\x20send\x20','[Poll:\x20','video','get','bin','ND_DELETE','remoteJid','ailed\x20to\x20c','DELETE_CON','e\x20TEXT\x20NOT','protocolMe','pping\x20reco','join','fter:\x20*','\x20Recovery\x20','eletion\x20pr','[Delete]\x20M','size','shift','messageTim','mediaPath','TO\x20message','ðŸ—¨\x20Group:\x20','?,\x20?,\x20?,\x20?','arget_jid\x27','emove\x20file','\x20Send\x20Mode','pm\x20\x20\x20\x20\x20\x20->','aveDeleteT','[Delete]\x20n','DELETE_MED','leaning\x20','RY\x20KEY','msg_id=?','alse\x20â€”\x20ski','VAL_MS','jid','ailed\x20to\x20r','SELECT\x20val','edia\x20file\x20','treamMedia','eletionWor','IA_DIRNAME','subject','psert','t\x20JID.','[no-id]','CREATE\x20TAB','ode\x27,\x20?,\x20?','PRAGMA\x20tab','group\x20JID\x20','dia\x20error:','g\x20incoming','saved:\x20','Only)*\x0a\x0a','ESSAGES\x20RE','\x20saved_at\x20','d\x20unexpect','MEDIA_SEND','ailed\x20dele','get\x20availa','lushRecove','arget\x20JID\x20','run','s\x20(msg_id,','_SEND_RETR','DELETE_DEB','eleteMessa','[Audio]','[delete]\x20M','ptv','ll\x20(','PROJECT_RO','\x20updated_a','basename','t\x20group\x20JI','onMessageV','essageWork','\x20â€”\x20ensurin','sticker','ed_at\x20FROM','*Current\x20S','documentMe','object','<\x20?','OUNCE_MS','xcluded.va','access','ANUP_INTER','stickerMes','d).\x20Leavin','INITIAL_BA','COVERED*\x20ðŸ—‘','ed_at=excl','=\x27target_j','[Delete]\x20e','\x20deleting.','[Voice\x20not','message','filter','(no-id)','dMessagesS','sages\x20row:','0\x0a\x20\x20\x20\x20);','messages.','ðŸ‘¤\x20From:\x20@','rmine\x20comm','fileName','mpts\x20faile','geToDB:\x20mi','[delete]\x20T','plete.','\x20failed:\x20','code','T\x20NULL\x20AND','nsureTable','ed\x20error:\x20','item\x20error','[Delete]\x20c','roup]','D_DELETE\x20f','[Delete]\x20u','extendedTe','imageMessa','.\x20Mode:\x20','zation\x20fai','\x20\x20\x20\x20\x20\x20valu','JID\x0a\x0a','sender','ageItem\x20er','7ypQdLv','arget\x20fail','refs\x20WHERE','NCURRENCY','[Delete]\x20C','pdf','d\x20retry','\x20JID','ailed\x20to\x20s','string','Days:\x20','ata','for\x20','sock','mentions','y:\x20','rror:\x20','ode\x20failed','boolean','repeat','FROM\x20messa','1500450YuLHAh','VALUES\x20(\x27m','\x20DELETED\x20M','ðŸ“\x20Content:','DELETE\x20FRO','aved_at,\x20r','ed_at','rget\x20avail','INSERT\x20INT','\x20remote_al','\x20top\x20error','sing\x20colum','text','n:\x20','iled:\x20','[Delete]\x20s','[Unknown\x20G','led:\x20','_path,\x20sav','\x20group:\x20','esent_at)\x0a','_DELAY_MS','116zRHkfq','riginal\x20fo','length','DELETE_CLE','\x20delete\x20p|','329610RsYwQB','UpsertHand','t\x20failed:\x20','[Sticker]','\x20\x20\x20updated','vered\x20to\x20b','165VRajfR','TEXT\x20PRIMA','msg_id','nitial\x20cle','ssing\x20key.','[Delete]\x20m','\x20->\x20','s\x20WHERE\x20ms','1MSQoIB','\x20delete\x20<j','ue\x20FROM\x20de','ET\x20value=e','media','value','M\x20messages','image','xtMessage','\x20chat_jid,','898641jGajaN','[delete]\x20F','end\x20attemp','ble','O\x20UPDATE\x20S','edia_path,','VALUES\x20(\x27t','g\x20deletion','at\x20path:\x20','not\x20found\x20','type','delete','CLEANUP_DA','SELECT\x20msg','ia\x20for\x20','lete_prefs','map','M\x20delete_p',':\x20*','key',',\x20Cleanup\x20','ðŸ—‘\x20*','ICT(key)\x20D','jid,\x20parti','IMIT','not\x20set','RAGMA\x20tabl','floor','target.','has\x20no\x20col','participan','notify','ptvMessage','[Delete]\x20p','[Delete]\x20P','utoCleanOl','ode\x27,\x27p\x27,\x20','\x20than\x20','\x20clear\x20tar','nable\x20to\x20d','TIAL_BACKO','ecovered\x20m','\x20delete\x20g|','[Delete]\x20t','endsWith','ogg','document','MEDIA_DIRN','es\x20bot\x20arg','failed\x20for','ssage','no\x20send\x20ta','mimetype','json,\x20time','geRow\x20erro','SIZE','nfig\x20regis','stamp,\x20med','conversati','nitialized','E\x20messages','entries','media_path','number','sendMessag','lue,\x20updat','Configured','[Delete]\x20h','OM\x20message','name','SELECT\x20med','265934nGUOVQ','or:\x20','=\x27mode\x27','otReloadCo','INTEGER','Message','sage','DATE\x20SET\x20v','INSERT\x20OR\x20','lush\x20loop\x20','e\x20queue\x20is','leanup\x20com','redBatch\x20e','\x20GROUP.\x20','236792EpBdgr','LE\x20IF\x20NOT\x20','\x20to\x20','e_info\x20fai','function','low','audioMessa','keys','toLowerCas','DELETE_INI','_id=?','er\x20item\x20er','\x20key=\x27targ','\x20\x20\x20\x20\x20\x20VALU','ror:\x20','ptt','B\x20initiali','refs\x20(mode','videoMessa','nsertMessa','CURRENCY_L','r:\x20','led\x20for\x20','TEXT'];_0x46fa=function(){return _0x3c610c;};return _0x46fa();}async function saveDeleteMode(_0x3d46f0){const _0xa30574=_0x6cb121;try{const _0x7463d6=_0x3d46f0==='g'?'g':'p',_0x5ee05e=Math['floor'](Date['now']()/(-0x1119+-0x21f0+-0x5*-0xafd));return await db[_0xa30574(0x254)]('INSERT\x20INT'+_0xa30574(0x1fb)+_0xa30574(0x1f1)+_0xa30574(0x1f3)+'dated_at)\x20'+_0xa30574(0x2ad)+_0xa30574(0x245)+')\x20ON\x20CONFL'+_0xa30574(0x12b)+_0xa30574(0x2e3)+_0xa30574(0x2d8)+_0xa30574(0x26b)+_0xa30574(0x156)+_0xa30574(0x272)+_0xa30574(0x1f4)+_0xa30574(0x2b2),[_0x7463d6,_0x5ee05e]),DELETE_MODE=_0x7463d6,info(_0xa30574(0x2d2)+_0xa30574(0x1db)+'\x20'+DELETE_MODE),!![];}catch(_0x6928c8){return warn(_0xa30574(0x2bb)+'aveDeleteM'+_0xa30574(0x2a8)+':\x20'+(_0x6928c8?.[_0xa30574(0x277)]||_0x6928c8)),![];}}async function saveDeleteTarget(_0x113cef){const _0x3ba3a2=_0x6cb121;try{const _0x1bbe8a=Math[_0x3ba3a2(0x130)](Date[_0x3ba3a2(0x1d2)]()/(0x1a*-0xfd+-0xfcc*-0x2+-0x1fe));if(!_0x113cef)return await db[_0x3ba3a2(0x254)](_0x3ba3a2(0x2b0)+_0x3ba3a2(0x126)+_0x3ba3a2(0x299)+_0x3ba3a2(0x176)+'et_jid\x27'),TARGET_JID=null,info(_0x3ba3a2(0x140)+_0x3ba3a2(0x1bb)+_0x3ba3a2(0x1e7)),!![];else{const _0x39e696=normalizeToUserJid(_0x113cef);return await db[_0x3ba3a2(0x254)](_0x3ba3a2(0x2b4)+'O\x20delete_p'+_0x3ba3a2(0x1f1)+_0x3ba3a2(0x1f3)+'dated_at)\x20'+_0x3ba3a2(0x2e5)+_0x3ba3a2(0x22d)+',\x20?,\x20?)\x20ON'+_0x3ba3a2(0x1c3)+_0x3ba3a2(0x18f)+_0x3ba3a2(0x163)+_0x3ba3a2(0x1b2)+'ded.value,'+_0x3ba3a2(0x25e)+_0x3ba3a2(0x18b)+'.updated_a'+'t',[_0x39e696,_0x1bbe8a]),TARGET_JID=_0x39e696,info('[Delete]\x20t'+_0x3ba3a2(0x1bb)+_0x3ba3a2(0x24a)+TARGET_JID),!![];}}catch(_0x1da971){return warn(_0x3ba3a2(0x2bb)+_0x3ba3a2(0x231)+_0x3ba3a2(0x298)+'ed:\x20'+(_0x1da971?.['message']||_0x1da971)),![];}}async function flushRecoveredBatch(_0x546011){const _0x939b0e=_0x6cb121;if(!_0x546011||_0x546011[_0x939b0e(0x2c4)]===0xf*0x1d3+-0x2681+0xb24*0x1)return;if(!DEFAULT_SEND_DELETE){info(_0x939b0e(0x1f5)+_0x939b0e(0x198)+_0x939b0e(0x28d)+_0x939b0e(0x237)+_0x939b0e(0x220)+_0x939b0e(0x1c5)+'s.');return;}const _0x2ef7f2=_0x546011[_0x939b0e(0x19d)](_0x2e9c84=>_0x2e9c84[_0x939b0e(0x1c6)+'ssage'])?.[_0x939b0e(0x1c6)+_0x939b0e(0x147)]?.[_0x939b0e(0x128)]?.['remoteJid']||null,_0x2e5e14=resolveDeleteTarget(_0x2ef7f2)||getBotJid();if(!_0x2e5e14){warn(_0x939b0e(0x232)+_0x939b0e(0x1de)+_0x939b0e(0x251)+_0x939b0e(0x2e2));return;}const _0x1cd36c=[...new Set(_0x546011[_0x939b0e(0x125)](_0x55d505=>_0x55d505[_0x939b0e(0x295)]))],_0x251fa8=_0x546011['map'](_0x5b575f=>_0x939b0e(0x27e)+_0x5b575f[_0x939b0e(0x295)][_0x939b0e(0x1fe)]('@')[-0x1*-0x76f+0x220+0x98f*-0x1]+'\x20('+_0x5b575f['name']+')\x0a'+(_0x5b575f['group']?_0x939b0e(0x22b)+_0x5b575f[_0x939b0e(0x1f7)]+'\x0a':'')+(_0x939b0e(0x2af)+'\x20'+_0x5b575f['content']+'\x0a')+'â”€'[_0x939b0e(0x2aa)](-0x214c+-0x2250+-0x1*-0x43b5))['join']('\x0a'),_0x1a984e=_0x939b0e(0x12a)+_0x546011['length']+(_0x939b0e(0x2ae)+_0x939b0e(0x24c)+_0x939b0e(0x271)+'\x0a\x0a');try{const _0x22afbd=await sendWithRetry(_0x2e5e14,{'text':_0x1a984e+_0x251fa8},_0x1cd36c);if(!_0x22afbd)warn(_0x939b0e(0x2bb)+_0x939b0e(0x1c1)+_0x939b0e(0x1a6)+_0x939b0e(0x20d));}catch(_0x2e9549){warn(_0x939b0e(0x2bb)+'ummary\x20sen'+_0x939b0e(0x24e)+_0x939b0e(0x289)+(_0x2e9549?.[_0x939b0e(0x277)]||_0x2e9549));}for(const _0x134bc7 of _0x546011){try{const _0x2845ee=_0x134bc7[_0x939b0e(0x229)],_0x7e44ae=_0x134bc7[_0x939b0e(0x1c6)+'ssage'],_0xcd1c19=!!_0x2845ee||isMediaMessage(_0x7e44ae?.[_0x939b0e(0x277)]);if(!_0xcd1c19){try{await deleteMessageRow(_0x134bc7['msg_id']);}catch(_0x3928fb){}continue;}const _0x2d31d5=_0x7e44ae?.['key']?.['id']||_0x939b0e(0x279),_0x123cff=await buildPayloadForSavedFile(_0x2845ee,_0x7e44ae);if(_0x123cff){const _0x192128=await sendWithRetry(_0x2e5e14,_0x123cff);if(_0x192128){info(_0x939b0e(0x203)+_0x939b0e(0x13e)+_0x939b0e(0x1d1)+_0x939b0e(0x2a3)+_0x2d31d5+'\x20->\x20'+_0x2e5e14),await deleteMessageRow(_0x134bc7[_0x939b0e(0x2cf)]),await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x939b0e(0x24f)+_0x939b0e(0x2c1)]);continue;}else warn('[Delete]\x20m'+_0x939b0e(0x215)+_0x939b0e(0x146)+'\x20'+_0x2d31d5+'.');}try{const _0x370e2f=await sendWithRetry(_0x2e5e14,{'forward':_0x7e44ae});if(_0x370e2f){info('[Delete]\x20r'+_0x939b0e(0x1ee)+_0x939b0e(0x2c3)+'rwarded\x20fo'+'r\x20'+_0x2d31d5+_0x939b0e(0x2d3)+_0x2e5e14),await deleteMessageRow(_0x134bc7[_0x939b0e(0x2cf)]),await sleep(MEDIA_SEND_DELAY_MS||FALLBACKS[_0x939b0e(0x24f)+_0x939b0e(0x2c1)]);continue;}}catch(_0x513072){warn(_0x939b0e(0x209)+'egacy\x20forw'+_0x939b0e(0x1da)+'\x20'+(_0x513072?.[_0x939b0e(0x277)]||_0x513072));}warn(_0x939b0e(0x28e)+_0x939b0e(0x13c)+'eliver\x20med'+_0x939b0e(0x2ed)+_0x2d31d5+('\x20(all\x20atte'+_0x939b0e(0x281)+_0x939b0e(0x26f)+'g\x20in\x20DB\x20fo'+_0x939b0e(0x196)+_0x939b0e(0x187)+'p.'));}catch(_0x404c3c){warn(_0x939b0e(0x1a3)+_0x939b0e(0x165)+_0x939b0e(0x28a)+':\x20'+(_0x404c3c?.[_0x939b0e(0x277)]||_0x404c3c));}}}async function rawMessagesUpsertHandler({messages:_0x489951}){const _0x1cd037=_0x6cb121;try{if(!_0x489951||!Array[_0x1cd037(0x1d0)](_0x489951))return;for(const _0x38d23d of _0x489951){if(!_0x38d23d||!_0x38d23d[_0x1cd037(0x277)]||_0x38d23d['key']?.[_0x1cd037(0x21b)]==='status@bro'+_0x1cd037(0x1f8))continue;if(_0x38d23d[_0x1cd037(0x128)]?.[_0x1cd037(0x1ec)])continue;if(messageQueue[_0x1cd037(0x2c4)]>=QUEUE_MAX_SIZE){warn(_0x1cd037(0x225)+_0x1cd037(0x208)+_0x1cd037(0x166)+'\x20full\x20('+messageQueue[_0x1cd037(0x2c4)]+(').\x20Droppin'+_0x1cd037(0x249)+_0x1cd037(0x1ba)));continue;}messageQueue[_0x1cd037(0x1ff)](_0x38d23d),setImmediate(()=>{const _0x524e92=_0x1cd037;messageWorker()[_0x524e92(0x202)](()=>{});});const _0x4eb74e=_0x38d23d[_0x1cd037(0x277)]?.[_0x1cd037(0x21f)+'ssage'];if(_0x4eb74e?.[_0x1cd037(0x2e9)]===-0x1*-0xc19+-0x6*-0x2d7+-0x1d23*0x1&&_0x4eb74e?.[_0x1cd037(0x128)]){if(deletionQueue['length']>=QUEUE_MAX_SIZE){warn(_0x1cd037(0x1f5)+_0x1cd037(0x224)+'ocessing\x20q'+_0x1cd037(0x188)+_0x1cd037(0x25c)+deletionQueue[_0x1cd037(0x2c4)]+(_0x1cd037(0x18e)+_0x1cd037(0x2e6)+_0x1cd037(0x1a4)));continue;}deletionQueue[_0x1cd037(0x1ff)]({'keys':[_0x4eb74e['key']],'remoteJid':_0x38d23d[_0x1cd037(0x128)]['remoteJid']}),setImmediate(()=>{deletionWorker()['catch'](()=>{});});}}}catch(_0x122d0a){warn(_0x1cd037(0x203)+_0x1cd037(0x19b)+_0x1cd037(0x2c8)+'ler\x20error:'+'\x20'+(_0x122d0a?.[_0x1cd037(0x277)]||_0x122d0a));}}async function processMessageItem(_0x483cb8){const _0x497589=_0x6cb121;try{if(!_0x483cb8||!_0x483cb8[_0x497589(0x277)]||_0x483cb8[_0x497589(0x128)]?.[_0x497589(0x1ec)])return;const _0x36f8e4=await maybeSaveMedia(_0x483cb8);await insertMessageToDB(_0x483cb8,_0x36f8e4);}catch(_0x2ba36b){warn(_0x497589(0x136)+'rocessMess'+_0x497589(0x296)+_0x497589(0x178)+(_0x2ba36b?.['message']||_0x2ba36b));}}async function messageWorker(){const _0x436ca3=_0x6cb121,_0x1c1f8d=CONCURRENCY||FALLBACKS[_0x436ca3(0x1c0)+_0x436ca3(0x29a)];while(messageQueue[_0x436ca3(0x2c4)]>-0x15bf+0x141+0x3d*0x56&&activeMessageTasks<_0x1c1f8d){const _0x5da49c=messageQueue[_0x436ca3(0x227)]();if(!_0x5da49c)break;activeMessageTasks++,((async()=>{const _0x401886=_0x436ca3;try{await processMessageItem(_0x5da49c);}catch(_0x30e56f){warn(_0x401886(0x2d2)+_0x401886(0x262)+_0x401886(0x175)+_0x401886(0x178)+(_0x30e56f?.[_0x401886(0x277)]||_0x30e56f));}finally{activeMessageTasks--,setImmediate(()=>{const _0x518cc7=_0x401886;if(messageQueue[_0x518cc7(0x2c4)])messageWorker()['catch'](()=>{});});}})());}}async function autoCleanOldMessagesSafe(){const _0x29243=_0x6cb121;try{await autoCleanOldMessages();}catch(_0x238ad1){warn(_0x29243(0x1cd)+_0x29243(0x138)+_0x29243(0x27a)+_0x29243(0x1fc)+'\x20'+(_0x238ad1?.[_0x29243(0x277)]||_0x238ad1));}}async function autoCleanOldMessages(){const _0x3661c5=_0x6cb121;try{const _0x464ac3=Math[_0x3661c5(0x130)](Date[_0x3661c5(0x1d2)]()/(0x19f8+-0x4*-0x5b1+-0x2cd4))-Number(DELETE_CLEANUP_DAYS||FALLBACKS[_0x3661c5(0x2eb)+'YS'])*(0x2e*0x20+0x228b*0x1+-0xfb*0x29)*(0x1*0x15df+0x15ca+-0x2b6d)*(0x1757+-0x1b7*0x12+0x7c3),_0x3e2912=await db[_0x3661c5(0x1e5)](_0x3661c5(0x2ec)+_0x3661c5(0x1a7)+_0x3661c5(0x2be)+_0x3661c5(0x265)+'\x20messages\x20'+'WHERE\x20save'+_0x3661c5(0x210)+_0x3661c5(0x287)+_0x3661c5(0x24d)+_0x3661c5(0x269),[_0x464ac3]);if(!_0x3e2912||_0x3e2912['length']===-0x8*-0x415+0x2207+-0x42af)return;info('[Delete]\x20c'+_0x3661c5(0x234)+_0x3e2912[_0x3661c5(0x2c4)]+('\x20old\x20messa'+_0x3661c5(0x185)+_0x3661c5(0x13a))+DELETE_CLEANUP_DAYS+'\x20days)');for(const _0xde9e2d of _0x3e2912){if(_0xde9e2d['media_path'])try{await _0x126ec0['rm'](_0xde9e2d[_0x3661c5(0x153)],{'force':!![]});}catch(_0x3edc31){warn(_0x3661c5(0x1a3)+_0x3661c5(0x250)+_0x3661c5(0x1b9)+_0xde9e2d[_0x3661c5(0x153)]+':\x20'+(_0x3edc31?.['message']||_0x3edc31));}}const _0x3bda1d=_0x3e2912[_0x3661c5(0x125)](_0x3ce5b7=>_0x3ce5b7['msg_id']),_0x314a17=-0x448+-0x181c+0x1d2c;for(let _0x51500e=0x2*-0x109+0x784+-0x22*0x29;_0x51500e<_0x3bda1d[_0x3661c5(0x2c4)];_0x51500e+=_0x314a17){const _0xea7bd0=_0x3bda1d[_0x3661c5(0x19a)](_0x51500e,_0x51500e+_0x314a17),_0x16be56=_0xea7bd0[_0x3661c5(0x125)](()=>'?')['join'](',');await db[_0x3661c5(0x254)](_0x3661c5(0x2b0)+_0x3661c5(0x2db)+_0x3661c5(0x205)+'_id\x20IN\x20('+_0x16be56+')',_0xea7bd0);}info(_0x3661c5(0x28b)+_0x3661c5(0x167)+_0x3661c5(0x284));}catch(_0x5cf1d2){warn(_0x3661c5(0x1cd)+_0x3661c5(0x138)+_0x3661c5(0x1e6)+_0x3661c5(0x207)+(_0x5cf1d2?.[_0x3661c5(0x277)]||_0x5cf1d2));}}const processedCmdKeys=new Map(),CMD_DEDUPE_TTL_MS=(-0xc3e+0xdd6+-0x17a)*(-0x1720+0x3f7*0x5+0x735);function markCmdProcessed(_0x4ddfc1){const _0x28dce3=_0x6cb121;if(!_0x4ddfc1)return;if(processedCmdKeys[_0x28dce3(0x1f9)](_0x4ddfc1))try{clearTimeout(processedCmdKeys[_0x28dce3(0x218)](_0x4ddfc1));}catch(_0x16dce4){};const _0x1de35c=setTimeout(()=>processedCmdKeys['delete'](_0x4ddfc1),CMD_DEDUPE_TTL_MS);processedCmdKeys['set'](_0x4ddfc1,_0x1de35c);}function isCmdProcessed(_0x1ef6f4){return _0x1ef6f4&&processedCmdKeys['has'](_0x1ef6f4);}export async function onMessage(_0x95e67c){const _0x2661ce=_0x6cb121;try{if(!_0x95e67c||!_0x95e67c['key']||!_0x95e67c[_0x2661ce(0x277)]||!_0x95e67c['isCommand'])return;if(isJidGroup(_0x95e67c['key'][_0x2661ce(0x21b)]))return;const _0x5aa694=_0x95e67c[_0x2661ce(0x128)][_0x2661ce(0x1ec)],_0x3e47fc=await isSudo(botRef,_0x95e67c)[_0x2661ce(0x202)](()=>![]);if(!_0x5aa694&&!_0x3e47fc)return;let _0x4983f6=_0x5aa694?getBotJid():_0x95e67c[_0x2661ce(0x128)][_0x2661ce(0x21b)];if(!_0x4983f6){warn(_0x2661ce(0x29b)+_0x2661ce(0x1a5)+_0x2661ce(0x27f)+_0x2661ce(0x1c4)+_0x2661ce(0x131));return;}const _0x51900f=String(_0x95e67c[_0x2661ce(0x128)]['remoteJid']||'')+'::'+String(_0x95e67c[_0x2661ce(0x128)]['id']||_0x95e67c[_0x2661ce(0x128)][_0x2661ce(0x133)+'t']||'');if(isCmdProcessed(_0x51900f))return;markCmdProcessed(_0x51900f);const _0x23fa23=_0x95e67c[_0x2661ce(0x2b8)]||'',_0x30ab8e=_0x23fa23[_0x2661ce(0x1b8)]()[_0x2661ce(0x1fe)](/\s+/),_0x5b11a8=(_0x30ab8e[0x2*0xcf3+0x647+-0x202d]||'')[_0x2661ce(0x172)+'e']();if(!commands['includes'](_0x5b11a8))return;const _0x5ab80f=(_0x30ab8e[-0x1ff6+0x1d*-0x115+0x3f58]||'')[_0x2661ce(0x172)+'e']();if(_0x5ab80f&&_0x5ab80f['includes']('@')){const _0x1f04b5=normalizeToUserJid(_0x5ab80f),_0x11494d=await saveDeleteTarget(_0x1f04b5);await sendWithRetry(_0x4983f6,{'text':_0x11494d?_0x2661ce(0x283)+_0x2661ce(0x253)+_0x2661ce(0x24a)+_0x1f04b5:_0x2661ce(0x2e0)+_0x2661ce(0x29f)+'ave\x20target'+_0x2661ce(0x29e)});return;}if([_0x2661ce(0x214),_0x2661ce(0x19e),_0x2661ce(0x19c)][_0x2661ce(0x1b7)](_0x5ab80f)){const _0x22031d=await saveDeleteTarget(null);await sendWithRetry(_0x4983f6,{'text':_0x22031d?_0x2661ce(0x283)+_0x2661ce(0x253)+'cleared.':_0x2661ce(0x2e0)+_0x2661ce(0x21c)+'lear\x20targe'+_0x2661ce(0x242)});return;}if(['p','pm']['includes'](_0x5ab80f)){await saveDeleteMode('p'),await sendWithRetry(_0x4983f6,{'text':_0x2661ce(0x25a)+_0x2661ce(0x1cf)+_0x2661ce(0x1ef)});return;}if(['g',_0x2661ce(0x1f7),'gp'][_0x2661ce(0x1b7)](_0x5ab80f)){await saveDeleteMode('g');const _0x11f4bd=TARGET_JID?_0x2661ce(0x157)+_0x2661ce(0x2bf)+TARGET_JID:_0x2661ce(0x1ae)+_0x2661ce(0x247)+_0x2661ce(0x18d);await sendWithRetry(_0x4983f6,{'text':_0x2661ce(0x25a)+_0x2661ce(0x1cf)+_0x2661ce(0x169)+_0x11f4bd});return;}const _0x3eab61=DELETE_MODE==='g'?'GROUP\x20('+(TARGET_JID||_0x2661ce(0x12e))+')':'PM';await sendWithRetry(_0x4983f6,{'text':'*Delete\x20Re'+'covery\x20Set'+'tings\x20(PM-'+_0x2661ce(0x24b)+'Usage:\x0a'+(_0x2661ce(0x2c6)+_0x2661ce(0x230)+'\x20send\x20reco'+_0x2661ce(0x2cc)+_0x2661ce(0x1eb))+(_0x2661ce(0x13f)+_0x2661ce(0x1c8)+_0x2661ce(0x1c7)+'vered\x20to\x20a'+'\x20group\x0a')+(_0x2661ce(0x2d6)+_0x2661ce(0x19f)+_0x2661ce(0x206)+_0x2661ce(0x260)+'D\x0a')+('\x20delete\x20cl'+'ear\x20\x20\x20\x20\x20->'+_0x2661ce(0x13b)+'get\x20group\x20'+_0x2661ce(0x294))+(_0x2661ce(0x266)+'tatus:*\x0a')+(_0x2661ce(0x22f)+_0x2661ce(0x127)+_0x3eab61+'*\x0a')+(_0x2661ce(0x223)+'Active:\x20*'+DEFAULT_SEND_DELETE+'*\x0a')+('\x20Cleanup\x20A'+_0x2661ce(0x222)+DELETE_CLEANUP_DAYS+_0x2661ce(0x1a9))});}catch(_0x36e223){error(_0x36e223,_0x2661ce(0x1ac)+'nMessage\x20e'+_0x2661ce(0x2a7)+(_0x36e223?.[_0x2661ce(0x277)]||_0x36e223));}}export async function initialize(_0x5c20e2){const _0xbd3ae4=_0x6cb121;if(!_0x5c20e2)throw new Error(_0xbd3ae4(0x1e3)+'ule\x20requir'+_0xbd3ae4(0x145));botRef=_0x5c20e2,await refreshConfig(),await ensureTable()[_0xbd3ae4(0x202)](_0x5f5c3c=>{const _0x4d10fc=_0xbd3ae4;error(_0x4d10fc(0x1f5)+_0x4d10fc(0x17a)+_0x4d10fc(0x292)+'led\x20fatall'+_0x4d10fc(0x2a6)+(_0x5f5c3c?.['message']||_0x5f5c3c));throw _0x5f5c3c;}),startManagedListener({'botRef':botRef,'eventName':'messages.u'+_0xbd3ae4(0x241),'handler':rawMessagesUpsertHandler,'moduleName':name}),await autoCleanOldMessagesSafe()[_0xbd3ae4(0x202)](_0x1209b3=>warn('[Delete]\x20i'+_0xbd3ae4(0x2d0)+'anup\x20error'+':\x20'+(_0x1209b3?.[_0xbd3ae4(0x277)]||_0x1209b3)));if(cleanupInterval)clearInterval(cleanupInterval);cleanupInterval=setInterval(autoCleanOldMessagesSafe,CLEANUP_INTERVAL||FALLBACKS[_0xbd3ae4(0x199)+'TERVAL_MS']),info('[Delete]\x20I'+_0xbd3ae4(0x150)+_0xbd3ae4(0x291)+DELETE_MODE+(_0xbd3ae4(0x129)+_0xbd3ae4(0x2a1))+DELETE_CLEANUP_DAYS);}export async function cleanup(){const _0x3e3fbd=_0x6cb121;try{stopManagedListener(name,'messages.u'+'psert'),cleanupInterval&&(clearInterval(cleanupInterval),cleanupInterval=null),messageQueue[_0x3e3fbd(0x2c4)]=0x1*0x2a6+-0x55*-0x29+-0x1043,deletionQueue[_0x3e3fbd(0x2c4)]=0x40*0x27+-0x1*0xcfa+-0x2*-0x19d,pendingRecovered['length']=0x81*0x28+-0x46c+-0xfbc;}catch(_0x5e3850){warn(_0x3e3fbd(0x28b)+'leanup\x20err'+_0x3e3fbd(0x15d)+(_0x5e3850?.['message']||_0x5e3850));}finally{botRef=null;}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};