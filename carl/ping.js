const _0x46b6da=_0x5655;(function(_0x578733,_0x46b087){const _0x4a8310=_0x5655,_0x58ad44=_0x578733();while(!![]){try{const _0x99ac56=parseInt(_0x4a8310(0xc8))/(0x47*-0x8c+0x2*0x101b+-0x5*-0x153)*(parseInt(_0x4a8310(0xa2))/(-0x21bf*-0x1+-0x404*0x5+-0xda9))+parseInt(_0x4a8310(0x96))/(-0x1cb7*0x1+0x91*0x1d+0x1*0xc4d)*(-parseInt(_0x4a8310(0xcd))/(0x1*-0x23e8+-0x1*-0x1393+0x1d1*0x9))+-parseInt(_0x4a8310(0xda))/(0x147a+0xa2b+0x1*-0x1ea0)+parseInt(_0x4a8310(0xdf))/(0x2474+-0xa6*0x1d+-0x11a0)*(-parseInt(_0x4a8310(0xbe))/(-0x1e92+-0x17ee+0x4f5*0xb))+parseInt(_0x4a8310(0x86))/(0x5*0x203+0x5*-0x467+0xbfc)+parseInt(_0x4a8310(0xb0))/(-0x1*-0x13bd+-0x47a*0x4+0xa*-0x2e)*(-parseInt(_0x4a8310(0xc4))/(0x1e30+0x6a5*-0x1+-0x1*0x1781))+parseInt(_0x4a8310(0xdc))/(-0x118c+-0x1*-0x4c1+0xcd6)*(parseInt(_0x4a8310(0xfb))/(-0xcd1*-0x2+0x4d*0x1b+0x1*-0x21b5));if(_0x99ac56===_0x46b087)break;else _0x58ad44['push'](_0x58ad44['shift']());}catch(_0x5343f6){_0x58ad44['push'](_0x58ad44['shift']());}}}(_0x131c,0x3f27*-0x7+-0x134c1+0x8c71f));import{performance}from'perf_hooks';import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{isSudo,listSudo,normalizeToJid,userJidFromCtx}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';export const name='ping';export const version=_0x46b6da(0x8e)+'d';export const priority=0x19f6+-0x143f+-0x5ad;let botInstance=null;const lastPingAt=new Map(),PING_COOLDOWN_MS=0x12*0xf3+0x1b7c+-0x20da,PING_HISTORY_MAX=0x2415+-0x19b5+-0xd5*0xc,pingHistory=[];function _0x5655(_0x513dcf,_0x31508b){const _0x17b101=_0x131c();return _0x5655=function(_0x4f6015,_0x16fa60){_0x4f6015=_0x4f6015-(-0x2560+-0x3*-0x793+-0xb*-0x161);let _0xe33baf=_0x17b101[_0x4f6015];return _0xe33baf;},_0x5655(_0x513dcf,_0x31508b);}let respondedMsgIds=new Set(),DEFAULT_TIMEZONE=_0x46b6da(0xd7)+_0x46b6da(0xf3);function refreshConfig(){const _0x4d058c=_0x46b6da;try{const _0x10066e=typeof getConfig==='function'?getConfig()||{}:{};DEFAULT_TIMEZONE=_0x10066e[_0x4d058c(0xa9)]||_0x10066e[_0x4d058c(0x105)+_0x4d058c(0xe6)]||DEFAULT_TIMEZONE,info(name+(_0x4d058c(0xbd)+_0x4d058c(0xea))+DEFAULT_TIMEZONE);}catch(_0x194d2e){warn(name+(_0x4d058c(0xa8)+_0x4d058c(0xf9)+_0x4d058c(0xd2))+(_0x194d2e?.[_0x4d058c(0xe2)]||_0x194d2e));}}try{typeof hotReloadConfig===_0x46b6da(0xaf)&&hotReloadConfig(()=>{const _0x498ac6=_0x46b6da;try{refreshConfig();}catch(_0x34b60d){warn(name+(_0x498ac6(0x9c)+'dConfig\x20ha'+_0x498ac6(0xb4)+_0x498ac6(0xd2))+(_0x34b60d?.[_0x498ac6(0xe2)]||_0x34b60d));}});}catch(_0x3ab623){warn(name+(_0x46b6da(0x9c)+_0x46b6da(0x107)+_0x46b6da(0xf8)+_0x46b6da(0x88))+(_0x3ab623?.[_0x46b6da(0xe2)]||_0x3ab623));}refreshConfig();function _0x131c(){const _0x1523a8=['TIMEZONE_N','finalDest\x20','dConfig\x20re','e\x20error:\x20','ring','skipping.','length','mFindings\x20',':\x20invalid\x20','2614184OtLkDv','startsWith','\x20failed:\x20','ping\x20send.','tency...',':\x20initiali','g\x20to\x20conti',':\x20botInsta','1.3.6-fixe','asurement\x20','network\x20la','Measuring\x20','setZone','map','processLat','nue\x20but\x20su','318453qlwaQm',',\x20origin=','get','╭─❏\x20pong\x20❏','toLocaleSt','client',':\x20hotReloa','roc:\x20','isArray','split','trim','═══⊷\x0a│\x20⏱\x20P','17514cBuktz','\x20origin\x20ch','\x20retry\x20als',':\x20findStor','fromMillis','shift',':\x20refreshC','TIMEZONE','bot','toFixed','delete','key','e\x20chatId;\x20','function','36iAqVQg','\x20to\x20send\x20p','\x20send.','\x0a│\x20','ndler\x20erro','slice','══⊷','\x20•\x20Net:\x20','tmp','rror:\x20','ping\x20','No\x20ping\x20hi',':\x20sent\x20pin',':\x20timezone','2596713usZKiE','may\x20be\x20lim','CONDS','\x20cleaned\x20u','\x20—\x20Proc:\x20','N/A','945310oxSlVD','type;\x20skip','string','\x20(origin:\x20','59dvrpGj','zoneName','findings','heck\x20threw','ping\x20stats','8veCAhB','sendMessag',':\x20isSudo\x20c','ency','isValid','r:\x20',',\x20net=','ing\x20box\x20to','fromMe',':\x20could\x20no','Africa/Nai','\x20handler\x20e','stination\x20','524175mnaczH','\x20as\x20a\x20fall','11ReUsqq','text','\x0a╰════════','12OvkidT','o\x20send\x20pin',':\x20retrying','message','o\x20failed\x20f','\x20cleanup\x20e','join','AME','ited.','size','ping\x20histo','\x20set\x20to\x20','remoteJid','edMatchFro','jid','nce\x20not\x20in','now','do\x20checks\x20',':\x20final\x20de','back.','robi','\x20initializ','unknown','number','from','gistration','onfig\x20erro','\x20attemptin','11721552rqvQIL','g\x20box\x20to\x20','\x20(proc=','clear','networkLat','failed\x20to\x20','latency\x20me','isCommand','\x20pings:\x0a',';\x20skipping'];_0x131c=function(){return _0x1523a8;};return _0x131c();}function pushHistory(_0x5037a0){const _0x3d4824=_0x46b6da;pingHistory['push'](_0x5037a0);if(pingHistory[_0x3d4824(0x10b)]>PING_HISTORY_MAX)pingHistory[_0x3d4824(0xa7)]();}function formatTimestamp(_0x2de230=Date[_0x46b6da(0xef)](),_0x1b2068=DEFAULT_TIMEZONE){const _0x29b47f=_0x46b6da;try{const _0x5b26e6=DateTime[_0x29b47f(0xa6)](_0x2de230)[_0x29b47f(0x92)](_0x1b2068);if(!_0x5b26e6[_0x29b47f(0xd1)])return new Date(_0x2de230)['toLocaleSt'+_0x29b47f(0x109)]();return _0x5b26e6['toLocaleSt'+_0x29b47f(0x109)](DateTime['DATETIME_M'+'ED_WITH_SE'+_0x29b47f(0xc0)])+'\x20('+_0x5b26e6[_0x29b47f(0xc9)]+')';}catch(_0x242dff){return new Date(_0x2de230)[_0x29b47f(0x9a)+_0x29b47f(0x109)]();}}function buildBox(_0x45ee78,_0x4b6563,_0x41ec1d=null){const _0x1ab04a=_0x46b6da;if(!_0x41ec1d)_0x41ec1d=formatTimestamp(Date[_0x1ab04a(0xef)](),DEFAULT_TIMEZONE);return _0x1ab04a(0x99)+_0x1ab04a(0xa1)+_0x1ab04a(0x9d)+_0x45ee78+'\x20•\x20Net:\x20'+_0x4b6563+_0x1ab04a(0xb3)+_0x41ec1d+(_0x1ab04a(0xde)+_0x1ab04a(0xb6));}export async function initialize(_0xdbe0a1){const _0x3705a5=_0x46b6da;try{botInstance=_0xdbe0a1,refreshConfig(),info(name+(_0x3705a5(0x8b)+'zed.'));}catch(_0x322fb3){warn(name+(_0x3705a5(0xf4)+_0x3705a5(0x108))+(_0x322fb3?.[_0x3705a5(0xe2)]||_0x322fb3));}}async function findStoredMatchFromFindings(_0x5d6584=[]){const _0x1de12f=_0x46b6da;try{if(!Array['isArray'](_0x5d6584)||_0x5d6584[_0x1de12f(0x10b)]===-0x13*0x17e+0x1258+0xa02)return null;const _0x4ea0f5=await listSudo();if(!Array[_0x1de12f(0x9e)](_0x4ea0f5)||_0x4ea0f5[_0x1de12f(0x10b)]===-0x99e+0x1*0x78a+0x4c*0x7)return null;const _0x433b8d=new Set(_0x4ea0f5[_0x1de12f(0x93)](_0x57e213=>String(_0x57e213)));for(const _0x208fc8 of _0x5d6584){if(!_0x208fc8||!_0x208fc8[_0x1de12f(0xed)]||typeof _0x208fc8[_0x1de12f(0xed)]!==_0x1de12f(0xc6))continue;try{const _0x172f0a=normalizeToJid(_0x208fc8[_0x1de12f(0xed)]);if(_0x172f0a&&_0x433b8d['has'](_0x172f0a))return _0x172f0a;const _0x2043d4=(String(_0x208fc8[_0x1de12f(0xed)])[_0x1de12f(0x9f)]('@')[0x517+0x1b3d+-0x2054]||'')[_0x1de12f(0x9f)](':')[0x25*-0x73+-0x2155+0x31f4]||null;if(_0x2043d4)for(const _0x5764de of _0x433b8d){const _0x375e2b=String(_0x5764de)[_0x1de12f(0x9f)]('@')[-0x4*0x145+-0x8e*0x14+0x102c]||null;if(_0x375e2b&&_0x2043d4===_0x375e2b)return _0x5764de;}if(_0x433b8d['has'](_0x208fc8[_0x1de12f(0xed)]))return _0x208fc8['jid'];}catch(_0x1cba15){}}return null;}catch(_0x39ed6c){return warn(name+(_0x1de12f(0xa5)+_0x1de12f(0xec)+_0x1de12f(0x84)+'error:\x20')+(_0x39ed6c?.[_0x1de12f(0xe2)]||_0x39ed6c)),null;}}export async function onMessage(_0x4417bd){const _0xdaaf3=_0x46b6da;try{if(!_0x4417bd||!_0x4417bd['key'])return;const _0x34a5e9=_0x4417bd[_0xdaaf3(0xad)]?.['id'];if(_0x34a5e9){if(respondedMsgIds['has'](_0x34a5e9))return;respondedMsgIds['add'](_0x34a5e9),setTimeout(()=>{respondedMsgIds['delete'](_0x34a5e9);},0xbdc4+0x3138+-0x127*0x4);}const _0x4a96e0=_0x4417bd[_0xdaaf3(0xeb)]||_0x4417bd[_0xdaaf3(0xad)]?.[_0xdaaf3(0xeb)]||_0xdaaf3(0xf5);if(_0x4a96e0==='unknown'){warn(name+(_0xdaaf3(0xd6)+'t\x20determin'+_0xdaaf3(0xae)+_0xdaaf3(0x10a)));return;}if(!_0x4417bd[_0xdaaf3(0x102)])return;const _0x2c45c2=(_0x4417bd[_0xdaaf3(0xdd)]||'')[_0xdaaf3(0xa0)]();if(!_0x2c45c2)return;const _0x5010e2=_0x2c45c2['toLowerCas'+'e'](),_0xd710=_0x5010e2===_0xdaaf3(0xe9)+'ry'||_0x5010e2===_0xdaaf3(0xcc),_0x1c7dba=_0x5010e2==='ping'||_0x5010e2[_0xdaaf3(0x87)](_0xdaaf3(0xba));if(!_0xd710&&!_0x1c7dba)return;!botInstance&&(botInstance=_0x4417bd[_0xdaaf3(0xaa)]||_0x4417bd[_0xdaaf3(0x9b)]||_0x4417bd['_bot']||null,!botInstance&&warn(name+(_0xdaaf3(0x8d)+_0xdaaf3(0xee)+'itialized;'+_0xdaaf3(0xfa)+_0xdaaf3(0x8c)+_0xdaaf3(0x95)+_0xdaaf3(0xf0)+_0xdaaf3(0xbf)+_0xdaaf3(0xe7))));const _0x350b82=Boolean(_0x4417bd['key'][_0xdaaf3(0xd5)]);let _0x49b2e3=![];try{_0x49b2e3=Boolean(await isSudo(botInstance,_0x4417bd));}catch(_0x522a09){warn(name+(_0xdaaf3(0xcf)+_0xdaaf3(0xcb)+':\x20')+(_0x522a09?.[_0xdaaf3(0xe2)]||_0x522a09)),_0x49b2e3=![];}if(!_0x350b82&&!_0x49b2e3)return;const _0x9cb78e=String(_0x4a96e0)['endsWith']('@g.us'),_0x4d397b=getBotJid();if(_0xd710){const _0x49b10a=_0x9cb78e?_0x4a96e0:_0x4d397b||_0x4a96e0;if(pingHistory[_0xdaaf3(0x10b)]===0x17*-0x9b+-0x377*0x9+-0x1*-0x2d1c){if(botInstance)await botInstance[_0xdaaf3(0xce)+'e'](_0x49b10a,{'text':_0xdaaf3(0xbb)+'story\x20yet.'});return;}const _0x59ff9c=pingHistory[_0xdaaf3(0xb5)]()['reverse']()[_0xdaaf3(0xb5)](0x108e+-0x2*-0x229+-0x14e0,0x1ebc+0x258b*-0x1+0x6e3)[_0xdaaf3(0x93)]((_0x235323,_0x1242ab)=>{const _0x48777a=_0xdaaf3,_0x3c10a0=formatTimestamp(_0x235323['ts'],DEFAULT_TIMEZONE),_0xe5aead=typeof _0x235323['processLat'+_0x48777a(0xd0)]==='number'?_0x235323[_0x48777a(0x94)+_0x48777a(0xd0)][_0x48777a(0xab)](0xaca+0x18ee+0x2*-0x11db)+'ms':_0x48777a(0xc3),_0x273c34=typeof _0x235323[_0x48777a(0xff)+_0x48777a(0xd0)]==='number'?_0x235323['networkLat'+'ency']['toFixed'](0xb61*-0x3+-0x59f+0x1*0x27c4)+'ms':_0x48777a(0xc3);return _0x1242ab+(-0x222*0x7+0x14f+0xda0*0x1)+'.\x20'+_0x3c10a0+_0x48777a(0xc2)+_0xe5aead+_0x48777a(0xb7)+_0x273c34+_0x48777a(0xc7)+_0x235323['chat']+')';})[_0xdaaf3(0xe5)]('\x0a');if(botInstance)await botInstance[_0xdaaf3(0xce)+'e'](_0x49b10a,{'text':'Last\x20'+Math['min'](-0x87+-0x1d8b*0x1+0x22*0xe3,pingHistory[_0xdaaf3(0x10b)])+_0xdaaf3(0x103)+_0x59ff9c});return;}if(!_0x1c7dba)return;const _0x1f232f=lastPingAt[_0xdaaf3(0x98)](_0x4a96e0)||0x1141*-0x1+-0x25b4+0xb*0x4ff,_0x5e4da9=Date[_0xdaaf3(0xef)]();if(_0x5e4da9-_0x1f232f<PING_COOLDOWN_MS)return;lastPingAt['set'](_0x4a96e0,_0x5e4da9),setTimeout(()=>lastPingAt['delete'](_0x4a96e0),PING_COOLDOWN_MS+(0x1e7+0x85e+-0x9e1));let _0x475530=null;if(_0x9cb78e)_0x475530=_0x4a96e0;else{if(_0x350b82)_0x475530=_0x4d397b||_0x4a96e0;else{if(_0x49b2e3){const _0x5bfcbb=userJidFromCtx(_0x4417bd),_0x5c0816=await findStoredMatchFromFindings(_0x5bfcbb[_0xdaaf3(0xca)]);if(!_0x5c0816)return;_0x475530=_0x5c0816;}else return;}}if(!_0x475530){warn(name+(_0xdaaf3(0xf1)+_0xdaaf3(0xd9)+'unresolved'+_0xdaaf3(0x104)+_0xdaaf3(0xb2)));return;}const _0x2b282d=String(_0x475530);try{_0x475530=String(_0x475530);}catch(_0x5dbca7){warn(name+(_0xdaaf3(0x85)+_0xdaaf3(0x106)+_0xdaaf3(0xc5)+_0xdaaf3(0x89)));return;}const _0x3bfa9b=performance['now'](),_0xf64546=formatTimestamp(Date[_0xdaaf3(0xef)](),DEFAULT_TIMEZONE),_0xb6cdce=buildBox(_0xdaaf3(0xb8),_0xdaaf3(0xb8),_0xf64546),_0x11aec6=performance[_0xdaaf3(0xef)](),_0x50df6a=Number((_0x11aec6-_0x3bfa9b)[_0xdaaf3(0xab)](0x1*-0x7c3+0x2709+0x8a*-0x3a));let _0x14dbd7=null;try{const _0x4ba6c9=_0xdaaf3(0x91)+_0xdaaf3(0x90)+_0xdaaf3(0x8a),_0x137d53=performance['now'](),_0x5a3a35=await botInstance[_0xdaaf3(0xce)+'e'](_0x475530,{'text':_0x4ba6c9}),_0x3b3817=performance[_0xdaaf3(0xef)]();_0x14dbd7=Number((_0x3b3817-_0x137d53)[_0xdaaf3(0xab)](0x1e+0x16dc+0x54*-0x46));const _0x107eb9=_0x5a3a35?.[_0xdaaf3(0xad)]?.['id']||_0x5a3a35?.['id'];_0x107eb9&&(respondedMsgIds['add'](_0x107eb9),setTimeout(()=>respondedMsgIds[_0xdaaf3(0xac)](_0x107eb9),0x15a9a+-0x2*-0xd55e+-0x1cf*0x12a));}catch(_0x5248d1){warn(name+(':\x20network\x20'+_0xdaaf3(0x101)+_0xdaaf3(0x8f)+_0xdaaf3(0x100))+_0x475530+':\x20'+(_0x5248d1?.[_0xdaaf3(0xe2)]||_0x5248d1)),_0x14dbd7=null;}const _0xa5a3ac=_0x50df6a[_0xdaaf3(0xab)](-0x1*-0xdaf+-0xe17+-0x6a*-0x1)+'ms',_0x59c120=typeof _0x14dbd7===_0xdaaf3(0xf6)?_0x14dbd7['toFixed'](0x2*0x1003+-0x1c7*-0x1+-0x21cb)+'ms':_0xdaaf3(0xc3),_0x69e8e3=buildBox(_0xa5a3ac,_0x59c120,_0xf64546);try{const _0x4f43e5=await botInstance[_0xdaaf3(0xce)+'e'](_0x475530,{'text':_0x69e8e3}),_0x509f78=_0x4f43e5?.[_0xdaaf3(0xad)]?.['id']||_0x4f43e5?.['id'];_0x509f78&&(respondedMsgIds['add'](_0x509f78),setTimeout(()=>respondedMsgIds[_0xdaaf3(0xac)](_0x509f78),(-0x8ce*0x2+-0x226c+0x401*0xd)*(0x116a0+0x3a6*-0x5f+0x12e5a))),info(name+(_0xdaaf3(0xbc)+_0xdaaf3(0xfc))+_0x475530+_0xdaaf3(0xfd)+_0xa5a3ac+_0xdaaf3(0xd3)+_0x59c120+_0xdaaf3(0x97)+_0x4a96e0+')'),pushHistory({'ts':Date[_0xdaaf3(0xef)](),'chat':_0x4a96e0,'processLatency':_0x50df6a,'networkLatency':_0x14dbd7});}catch(_0x12be8d){error(_0x12be8d,name+(':\x20failed\x20t'+_0xdaaf3(0xe0)+_0xdaaf3(0xfc))+_0x475530);if(_0x475530!==_0x4a96e0)try{warn(name+(_0xdaaf3(0xe1)+_0xdaaf3(0xb1)+_0xdaaf3(0xd4)+_0xdaaf3(0xa3)+'at\x20')+_0x4a96e0+(_0xdaaf3(0xdb)+_0xdaaf3(0xf2)));const _0x4821e9=await botInstance[_0xdaaf3(0xce)+'e'](_0x4a96e0,{'text':_0x69e8e3}),_0x290f48=_0x4821e9?.[_0xdaaf3(0xad)]?.['id']||_0x4821e9?.['id'];if(_0x290f48)respondedMsgIds['add'](_0x290f48);pushHistory({'ts':Date['now'](),'chat':_0x4a96e0,'processLatency':_0x50df6a,'networkLatency':_0x14dbd7});}catch(_0x3cb5d5){error(_0x3cb5d5,name+(':\x20fallback'+_0xdaaf3(0xa4)+_0xdaaf3(0xe3)+'or\x20origin\x20')+_0x4a96e0);}}if(respondedMsgIds[_0xdaaf3(0xe8)]>0x1*-0x179+-0x238d+0x388e){const _0x2ab456=Array[_0xdaaf3(0xf7)](respondedMsgIds),_0x15c36e=new Set(_0x2ab456[_0xdaaf3(0xb5)](-(-0xa83+0x21bc+-0xb81)));respondedMsgIds=_0x15c36e;}}catch(_0x5af023){error(_0x5af023,name+(_0xdaaf3(0xd8)+'rror'));}}export async function cleanup(){const _0x23a58b=_0x46b6da;try{botInstance=null,lastPingAt[_0x23a58b(0xfe)](),pingHistory[_0x23a58b(0x10b)]=-0xd*0x12e+-0x201b+0x2f71,respondedMsgIds[_0x23a58b(0xfe)]&&respondedMsgIds[_0x23a58b(0xfe)](),info(name+(_0x23a58b(0xc1)+'p'));}catch(_0x181d60){warn(name+(_0x23a58b(0xe4)+_0x23a58b(0xb9))+(_0x181d60?.['message']||_0x181d60));}}