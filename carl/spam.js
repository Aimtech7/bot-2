function _0x498f(){const _0x771f05=['->\x20chat_ji','INSERT\x20OR\x20',']\x20onMessag','LE\x20IF\x20NOT\x20','ngs','ate',']\x20failed\x20t','1597568qPoKQd','lastWarnAt','DISABLED','m\x20warnings','_new\x20(chat','\x20enabled\x20F','ailed:\x20','E\x20TO\x20','e\x20error:\x20',']\x20Migrated','map','ALTER\x20TABL','run','roup.','remoteJid','\x20exists\x20wi','SACTION;','show','ENABLED','slice',')\x20error:\x20','eset\x20their','ble',']\x20setChatE','function','\x20from\x20','REPLACE\x20IN','fromMe','ms,\x20maxWar','spam_setti','ns=','\x20VALUES\x20(?','PRIMARY\x20KE','set','error\x20for\x20','m\x20DISABLED','keys','\x20(chat_id\x20','warnCount',']\x20tableExi','1942251AHxSLu','rows',']\x20initiali','column_nam','\x20LIMIT\x201','COMMIT;',']\x20rawMessa',']\x20sendText','nabled\x20DB\x20','2TwsdQB','chat_id','(DB\x20error)','isCommand','\x20anti-spam','PRAGMA\x20tab','3303Kfpcjm','\x20INTEGER);',']\x20Created\x20','ot\x20instanc','_jid,\x20enab','⚠️\x20{user},\x20','mory\x20enfor','clear','psert','extendedTe','error:\x20','sts(','chat_jid','warnExpire','INSERT\x20INT','WARNING_ME','TO\x20','xtMessage','antispam.i','mory','✔️\x20Anti-spa','r:\x20','\x20mentioned','DB\x20error).','abled\x20=\x20ex','r\x20failed:\x20','\x20\x20ON\x20CONFL',']\x20stopMana','mentionedJ','⚠️\x20Failed\x20t','WARNING_TT','o\x20kick\x20','off','led)\x20SELEC','SELECT\x20ena',']\x20Ensured\x20','SSAGE','ing.\x20Remai','for\x20this\x20g','MAX_WARNIN','er\x20error:\x20',']\x20getChatE','length','nitialize\x20','SPAM_COOLD','\x20failed:\x20','T\x20chat_id,','exec','pamSetting','\x20removed\x20f','includes','push','{warnings}','ATE\x20SET\x20en','\x20warnings.','ssageForSp','OWN_MS',',\x20?)\x20\x0a\x20\x20\x20\x20','Y_MS','isArray','get',']\x20cleaned\x20','t_jid\x20=\x20?','catch','e=\x27table\x27\x20','sAt','AND\x20name=?','ings}','CREATE\x20TAB','EGER);','stringify','70mhKjXv','enabled','id)\x20DO\x20UPD','trim','o\x20create\x20','o\x20enable\x20a','le_info(','o\x20disable\x20','bled;','cement.\x20DB','stop\x20spamm','ROM\x20','toLowerCas','message','\x20group:\x20','participan','KICK_ON_SP','\x20WHERE\x20cha','180029SLNGIy','cluded.ena','9786KoZRLW','group.','SELECT\x20nam','1615JvoFzV','\x20TEXT\x20PRIM','from','sock','delete','cid','ICT(chat_j','am\x20error:\x20','string','\x20reset\x20for','users\x20to\x20r','gesUpsertH','SELECT\x20*\x20F','onfig\x20erro','3374632hEsJcn','key',',\x20enabled)',']\x20migrateS','has','L_MS','e\x20FROM\x20sql','name','\x20(chat_jid','\x20WHERE\x20typ','antispam','replace','ngs:\x20{warn','DROP\x20TABLE','EXISTS\x20','sendMessag','up.','max','W_MS','mentions','_jid\x20TEXT\x20','3113173pptIpI','nabled\x20INT','e\x20or\x20more\x20','endsWith','table\x20','✔️\x20Please\x20@','HOLD','SPAM','n\x20of\x20','timestamps','ite_master','\x20holds\x20onl','filter','Y,\x20enabled','\x20user(s).','remove','groupParti','cipantsUpd','now','m\x20for\x20this','andler\x20inn','SPAM_WINDO','SPAM_THRES','@g.us','WARN_EXPIR','\x20failed\x20to'];_0x498f=function(){return _0x771f05;};return _0x498f();}const _0x3aeea2=_0x218c;(function(_0x3becc4,_0x51d22d){const _0x5e0f12=_0x218c,_0x33b100=_0x3becc4();while(!![]){try{const _0x378005=parseInt(_0x5e0f12(0x262))/(-0x26*0xf1+-0x235e+0x4725)*(-parseInt(_0x5e0f12(0x203))/(0xe48*0x1+0x12e*-0x21+0x18a8))+parseInt(_0x5e0f12(0x1fa))/(0x6c1+0x1a73+-0x1*0x2131)+parseInt(_0x5e0f12(0x1d2))/(0x14c0+0xcf+-0x5*0x44f)+-parseInt(_0x5e0f12(0x267))/(0xa*0x11b+0x1*-0x92f+-0x1da)*(parseInt(_0x5e0f12(0x264))/(0x268b+0x1*-0x24e6+-0x19f*0x1))+parseInt(_0x5e0f12(0x28a))/(0x1*0x21e2+0x207b+-0x4bd*0xe)+-parseInt(_0x5e0f12(0x275))/(-0x73*-0x1+-0x760+0x6f5)+-parseInt(_0x5e0f12(0x209))/(0x1105*0x1+-0x2242+-0x21*-0x86)*(parseInt(_0x5e0f12(0x250))/(0xe0e+0x61b+0x33*-0x65));if(_0x378005===_0x51d22d)break;else _0x33b100['push'](_0x33b100['shift']());}catch(_0x176fee){_0x33b100['push'](_0x33b100['shift']());}}}(_0x498f,0x588db+-0x164*-0x4b0+0x2ab*-0x275));import{info,warn,error}from'../utils/logger.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{startManagedListener,stopManagedListener}from'../utils/listenerManager.js';function _0x218c(_0xf08334,_0xe9475e){const _0x2e04aa=_0x498f();return _0x218c=function(_0x83b20d,_0x135061){_0x83b20d=_0x83b20d-(-0xc*-0x64+0x127+-0x411*0x1);let _0x218462=_0x2e04aa[_0x83b20d];return _0x218462;},_0x218c(_0xf08334,_0xe9475e);}import{getConfig,hotReloadConfig}from'../utils/config.js';export const name=_0x3aeea2(0x27f);export const version='2.0.0-inme'+_0x3aeea2(0x21c);export const priority=-0x2054+-0x173f+0x37ed;export const commands=[_0x3aeea2(0x27f),'resetspam'];export const configKeys=[_0x3aeea2(0x291)];let botRef=null,sendApi=null;const chatUserMap=new Map(),processedMessageKeys=new Map(),DEDUPE_TTL_MS=(0x7*-0x2e9+-0x14*-0x173+-0x87f)*(0x48b+0xdcf+-0xe72),CFG={'SPAM_THRESHOLD':0x6,'SPAM_WINDOW_MS':(0x2198+0xce5+-0x2e73)*(0x44d+0x1*0x1921+0x36*-0x79),'SPAM_COOLDOWN_MS':0x3e8,'MAX_WARNINGS':0x3,'WARN_EXPIRY_MS':(-0x759+0x29*0x76+-0xb86)*(-0x2498+-0x1ab6+0xf*0x43a)*(0x2692+-0x1381+-0x1*0x12d5)*(0xda*0xe+0x1*-0xfdf+-0x15*-0x33)*(-0x141b+0xb0d*-0x1+0xb0*0x33),'KICK_ON_SPAM':!![],'WARNING_MESSAGE':_0x3aeea2(0x20e)+_0x3aeea2(0x25a)+_0x3aeea2(0x22e)+'ning\x20warni'+_0x3aeea2(0x281)+_0x3aeea2(0x24c),'WARNING_TTL_MS':0xc350};function refreshConfig(){const _0x4c709a=_0x3aeea2;try{const _0x41a823=getConfig?.()?.[_0x4c709a(0x291)]||{};Object['keys'](CFG)['forEach'](_0x10419c=>{if(_0x41a823[_0x10419c]!==undefined)CFG[_0x10419c]=_0x41a823[_0x10419c];}),CFG[_0x4c709a(0x1c7)+_0x4c709a(0x290)]=Math[_0x4c709a(0x286)](0x83f+-0xf*0x95+0x7d,Number(CFG[_0x4c709a(0x1c7)+_0x4c709a(0x290)])||-0x1*0x1c43+-0x1a96+-0x1*-0x36df),CFG[_0x4c709a(0x1c6)+_0x4c709a(0x287)]=Math['max'](-0x1b8f+-0x1ad+0xe9e*0x2,Number(CFG['SPAM_WINDO'+'W_MS'])||(0x11*0x132+0xab0*0x1+-0x1ef8)*(-0x1bda+0x1*0x1002+0xfc0)),CFG[_0x4c709a(0x235)+'OWN_MS']=Math[_0x4c709a(0x286)](0x1*0xc6f+0x1ae*-0x1+-0xac1*0x1,Number(CFG[_0x4c709a(0x235)+'OWN_MS'])||0x255*-0xe+-0x9*-0x2cc+0x1*0xb62),CFG[_0x4c709a(0x230)+'GS']=Math[_0x4c709a(0x286)](-0xf3a+0x1476+-0x53b,Number(CFG[_0x4c709a(0x230)+'GS'])||-0x1f84+0x10*0xf+-0x1*-0x1e97),CFG[_0x4c709a(0x1c9)+'Y_MS']=Math['max'](-0x1285+0xd6*-0x10+0x1*0x1fe5,Number(CFG[_0x4c709a(0x1c9)+_0x4c709a(0x243)])||(-0x5*0x7a+-0x7b*0x3d+0x1fb8)*(0x2*0x6af+-0x25f2+0x18ac)*(0x1b64+0x13a0+-0x5d9*0x8)*(0x1c87*-0x1+-0xce6+0x9*0x4a1)*(-0x1506+-0x1*-0x1a83+-0x195)),CFG['WARNING_TT'+_0x4c709a(0x27a)]=Math[_0x4c709a(0x286)](-0x3*-0x8ba+-0x2*0x12d6+0xb7e,Number(CFG[_0x4c709a(0x227)+'L_MS'])||0x6*-0x24a9+0x3*0x2ae2+0x11ea0),CFG[_0x4c709a(0x260)+'AM']=!!CFG['KICK_ON_SP'+'AM'];}catch(_0x505c6e){warn('['+name+(']\x20refreshC'+_0x4c709a(0x274)+_0x4c709a(0x21e))+(_0x505c6e?.[_0x4c709a(0x25d)]||_0x505c6e));}}const TABLE_SETTINGS=_0x3aeea2(0x1ef)+_0x3aeea2(0x1cf);async function tableExists(_0x3f7652){const _0x2c2de9=_0x3aeea2;try{const _0x55482e=await db[_0x2c2de9(0x245)](_0x2c2de9(0x266)+_0x2c2de9(0x27b)+_0x2c2de9(0x294)+_0x2c2de9(0x27e)+_0x2c2de9(0x249)+_0x2c2de9(0x24b),[_0x3f7652]);return!!_0x55482e;}catch(_0x49f9f4){return warn('['+name+(_0x2c2de9(0x1f9)+_0x2c2de9(0x214))+_0x3f7652+_0x2c2de9(0x1e6)+(_0x49f9f4?.[_0x2c2de9(0x25d)]||_0x49f9f4)),![];}}async function getTableColumns(_0x2fae2f){const _0x4b8567=_0x3aeea2;try{const _0x5d5033=await db['exec'](_0x4b8567(0x208)+'le_info('+_0x2fae2f+');'),_0xe02340=Array[_0x4b8567(0x244)](_0x5d5033)?_0x5d5033:_0x5d5033&&_0x5d5033[_0x4b8567(0x1fb)]?_0x5d5033[_0x4b8567(0x1fb)]:[];return _0xe02340[_0x4b8567(0x1dc)](_0x4175cd=>_0x4175cd[_0x4b8567(0x27c)]||_0x4175cd[_0x4b8567(0x1fd)+'e']||_0x4175cd[_0x4b8567(0x26c)]);}catch(_0x5ae3d2){try{const _0x4af274=await db['get'](_0x4b8567(0x273)+_0x4b8567(0x25b)+_0x2fae2f+_0x4b8567(0x1fe));return _0x4af274?Object['keys'](_0x4af274):[];}catch(_0x994dce){return[];}}}async function migrateSpamSettingsIfNeeded(){const _0x91f762=_0x3aeea2,_0x1e84f6=await tableExists(TABLE_SETTINGS);if(!_0x1e84f6)try{await db['exec']('CREATE\x20TAB'+_0x91f762(0x1ce)+_0x91f762(0x283)+TABLE_SETTINGS+(_0x91f762(0x27d)+_0x91f762(0x268)+'ARY\x20KEY,\x20e'+_0x91f762(0x28b)+_0x91f762(0x24e))),info('['+name+(_0x91f762(0x20b)+_0x91f762(0x28e))+TABLE_SETTINGS);return;}catch(_0x67d9){warn('['+name+(']\x20Failed\x20t'+_0x91f762(0x254))+TABLE_SETTINGS+':\x20'+(_0x67d9?.[_0x91f762(0x25d)]||_0x67d9));return;}try{const _0x5167ac=await db[_0x91f762(0x238)]('PRAGMA\x20tab'+_0x91f762(0x256)+TABLE_SETTINGS+');');let _0x4071bb=[];if(Array[_0x91f762(0x244)](_0x5167ac))_0x4071bb=_0x5167ac[_0x91f762(0x1dc)](_0x215f3d=>_0x215f3d[_0x91f762(0x27c)]||_0x215f3d[0x2b0*0xb+0xe21*-0x1+-0xa*0x18b])[_0x91f762(0x296)](Boolean);else{if(_0x5167ac&&Array['isArray'](_0x5167ac[_0x91f762(0x1fb)]))_0x4071bb=_0x5167ac[_0x91f762(0x1fb)][_0x91f762(0x1dc)](_0x55340a=>_0x55340a[_0x91f762(0x27c)])[_0x91f762(0x296)](Boolean);else try{const _0x4f9283=await db[_0x91f762(0x245)](_0x91f762(0x273)+_0x91f762(0x25b)+TABLE_SETTINGS+_0x91f762(0x1fe));_0x4071bb=_0x4f9283?Object[_0x91f762(0x1f6)](_0x4f9283):[];}catch(_0x5b731f){_0x4071bb=[];}}const _0x2efb76=_0x4071bb['map'](_0x7da64a=>String(_0x7da64a)[_0x91f762(0x25c)+'e']()),_0x54cc32=_0x2efb76[_0x91f762(0x23b)](_0x91f762(0x215)),_0x36d186=_0x2efb76['includes'](_0x91f762(0x251)),_0x29915a=_0x2efb76[_0x91f762(0x23b)](_0x91f762(0x204));if(_0x54cc32&&_0x36d186)return;if(!_0x54cc32&&_0x29915a)try{await db[_0x91f762(0x238)]('BEGIN\x20TRAN'+_0x91f762(0x1e2)),await db[_0x91f762(0x238)](_0x91f762(0x24d)+_0x91f762(0x1ce)+_0x91f762(0x283)+TABLE_SETTINGS+(_0x91f762(0x1d6)+_0x91f762(0x289)+_0x91f762(0x1f2)+_0x91f762(0x297)+_0x91f762(0x20a)));const _0x570b89=_0x36d186;_0x570b89?await db[_0x91f762(0x238)](_0x91f762(0x1cc)+_0x91f762(0x1ec)+_0x91f762(0x219)+TABLE_SETTINGS+(_0x91f762(0x1d6)+_0x91f762(0x20d)+_0x91f762(0x22a)+_0x91f762(0x237)+_0x91f762(0x1d7)+'ROM\x20')+TABLE_SETTINGS+';'):await db['exec'](_0x91f762(0x1cc)+_0x91f762(0x1ec)+'TO\x20'+TABLE_SETTINGS+('_new\x20(chat'+_0x91f762(0x20d)+_0x91f762(0x22a)+'T\x20chat_id,'+'\x200\x20FROM\x20')+TABLE_SETTINGS+';');await db[_0x91f762(0x238)](_0x91f762(0x282)+'\x20'+TABLE_SETTINGS+';'),await db['exec'](_0x91f762(0x1dd)+'E\x20'+TABLE_SETTINGS+('_new\x20RENAM'+_0x91f762(0x1d9))+TABLE_SETTINGS+';'),await db[_0x91f762(0x238)](_0x91f762(0x1ff)),info('['+name+(_0x91f762(0x1db)+'\x20')+TABLE_SETTINGS+(_0x91f762(0x1f7)+_0x91f762(0x1cb)+'d)'));return;}catch(_0x3b8ffa){try{await db[_0x91f762(0x238)]('ROLLBACK;');}catch(_0x1d56b1){}warn('['+name+(']\x20Migratio'+_0x91f762(0x292))+TABLE_SETTINGS+_0x91f762(0x236)+(_0x3b8ffa?.['message']||_0x3b8ffa));return;}if(!_0x54cc32||!_0x36d186)try{await db[_0x91f762(0x238)]('CREATE\x20TAB'+'LE\x20IF\x20NOT\x20'+'EXISTS\x20'+TABLE_SETTINGS+(_0x91f762(0x27d)+_0x91f762(0x268)+'ARY\x20KEY,\x20e'+_0x91f762(0x28b)+_0x91f762(0x24e))),info('['+name+_0x91f762(0x22c)+TABLE_SETTINGS+(_0x91f762(0x1e1)+'th\x20expecte'+'d\x20columns.'));}catch(_0x4bf77e){warn('['+name+(']\x20Ensuring'+'\x20')+TABLE_SETTINGS+('\x20columns\x20f'+_0x91f762(0x1d8))+(_0x4bf77e?.['message']||_0x4bf77e));}}catch(_0x455f1b){warn('['+name+(_0x91f762(0x278)+_0x91f762(0x239)+'sIfNeeded\x20'+_0x91f762(0x213))+(_0x455f1b?.[_0x91f762(0x25d)]||_0x455f1b));}}async function ensureTables(){await migrateSpamSettingsIfNeeded();}function setupSendApi(){const _0x1501f2=_0x3aeea2;if(!botRef)return;if(typeof botRef[_0x1501f2(0x284)+'e']===_0x1501f2(0x1ea))sendApi=async(_0x496a64,_0x3d787e)=>await botRef[_0x1501f2(0x284)+'e'](_0x496a64,_0x3d787e);else{if(botRef[_0x1501f2(0x26a)]&&typeof botRef[_0x1501f2(0x26a)][_0x1501f2(0x284)+'e']===_0x1501f2(0x1ea))sendApi=async(_0x27ce93,_0x454856)=>await botRef[_0x1501f2(0x26a)][_0x1501f2(0x284)+'e'](_0x27ce93,_0x454856);else sendApi=null;}}async function sendText(_0x3153b2,_0x5dc17e,_0x43f534=[]){const _0x219f5c=_0x3aeea2;if(!_0x5dc17e||!_0x3153b2)return null;if(!sendApi)return warn('['+name+(_0x219f5c(0x201)+':\x20sendApi\x20'+'not\x20availa'+_0x219f5c(0x1e8))),null;try{const _0x2ccdfd=typeof _0x5dc17e===_0x219f5c(0x26f)?{'text':_0x5dc17e}:_0x5dc17e;if(Array[_0x219f5c(0x244)](_0x43f534)&&_0x43f534[_0x219f5c(0x233)])_0x2ccdfd[_0x219f5c(0x288)]=_0x43f534;return await sendApi(_0x3153b2,_0x2ccdfd);}catch(_0x20645c){return warn('['+name+(_0x219f5c(0x201)+_0x219f5c(0x1ca)+'\x20')+_0x3153b2+':\x20'+(_0x20645c?.[_0x219f5c(0x25d)]||_0x20645c)),null;}}async function kickUser(_0x5dd7a3,_0x2e7c5c){const _0x23e7c0=_0x3aeea2;try{const _0x37d0f3=botRef['sock']?.['groupParti'+_0x23e7c0(0x29b)+_0x23e7c0(0x1d0)]||botRef[_0x23e7c0(0x29a)+_0x23e7c0(0x29b)+_0x23e7c0(0x1d0)];if(_0x37d0f3)return await _0x37d0f3(_0x5dd7a3,[_0x2e7c5c],_0x23e7c0(0x299)),info('['+name+']\x20kicked\x20'+_0x2e7c5c+_0x23e7c0(0x1eb)+_0x5dd7a3),!![];return![];}catch(_0x128a95){return warn('['+name+(']\x20kickUser'+_0x23e7c0(0x236))+(_0x128a95?.[_0x23e7c0(0x25d)]||_0x128a95)),![];}}async function getChatEnabled(_0x43c95f){const _0x5adfcd=_0x3aeea2;try{const _0x27ccfb=await db[_0x5adfcd(0x245)](_0x5adfcd(0x22b)+'bled\x20FROM\x20'+TABLE_SETTINGS+(_0x5adfcd(0x261)+_0x5adfcd(0x247)),[_0x43c95f]);return _0x27ccfb?Number(_0x27ccfb[_0x5adfcd(0x251)])===-0x1636+-0xf67*-0x1+0x2*0x368:![];}catch(_0x68f1f2){return warn('['+name+(_0x5adfcd(0x232)+_0x5adfcd(0x202)+'error\x20for\x20')+_0x43c95f+':\x20'+(_0x68f1f2?.[_0x5adfcd(0x25d)]||_0x68f1f2)),![];}}async function setChatEnabled(_0x99f3d9,_0x2335eb){const _0x34286c=_0x3aeea2;try{return await db[_0x34286c(0x1de)](_0x34286c(0x217)+'O\x20'+TABLE_SETTINGS+('\x20(chat_jid'+_0x34286c(0x277)+_0x34286c(0x1f1)+_0x34286c(0x242)+_0x34286c(0x223)+_0x34286c(0x26d)+_0x34286c(0x252)+_0x34286c(0x23e)+_0x34286c(0x221)+_0x34286c(0x263)+_0x34286c(0x258)),[_0x99f3d9,_0x2335eb?-0x12fe+0x42*-0x53+0x2865:0x6c7+0x7*0x53a+-0x2b5d]),!![];}catch(_0x3b2f00){return warn('['+name+(_0x34286c(0x1e9)+_0x34286c(0x202)+_0x34286c(0x1f4))+_0x99f3d9+':\x20'+(_0x3b2f00?.['message']||_0x3b2f00)),![];}}function ensureChatMap(_0xdec5e5){const _0xa1fad5=_0x3aeea2;if(!chatUserMap[_0xa1fad5(0x279)](_0xdec5e5))chatUserMap[_0xa1fad5(0x1f3)](_0xdec5e5,new Map());return chatUserMap[_0xa1fad5(0x245)](_0xdec5e5);}function clearChatMemory(_0x2d8b8a){const _0x480380=_0x3aeea2;if(chatUserMap[_0x480380(0x279)](_0x2d8b8a))chatUserMap['delete'](_0x2d8b8a);}async function handleMessageForSpam(_0x33d3b2){const _0x3065e8=_0x3aeea2;try{const _0x45e921=String(_0x33d3b2['key']?.[_0x3065e8(0x1e0)]||'');if(!_0x45e921||!_0x45e921['endsWith'](_0x3065e8(0x1c8)))return;if(_0x33d3b2[_0x3065e8(0x276)]?.[_0x3065e8(0x1ed)])return;const _0x335c5f=await getChatEnabled(_0x45e921);if(!_0x335c5f)return;const _0x53f611=String(_0x33d3b2[_0x3065e8(0x276)]?.[_0x3065e8(0x25f)+'t']||_0x33d3b2[_0x3065e8(0x276)]?.[_0x3065e8(0x269)]||'');if(!_0x53f611)return;try{if(await isadmin(botRef,{'key':{'remoteJid':_0x45e921,'participant':_0x53f611},'message':_0x33d3b2[_0x3065e8(0x25d)]}))return;}catch(_0x6b323c){}const _0x4d4315=Date[_0x3065e8(0x29c)](),_0x2cfce1=ensureChatMap(_0x45e921);!_0x2cfce1['has'](_0x53f611)&&_0x2cfce1[_0x3065e8(0x1f3)](_0x53f611,{'timestamps':[],'lastWarnAt':0x0,'warnCount':0x0,'warnExpiresAt':0x0});const _0x57997f=_0x2cfce1[_0x3065e8(0x245)](_0x53f611);_0x57997f[_0x3065e8(0x293)]=(_0x57997f[_0x3065e8(0x293)]||[])[_0x3065e8(0x296)](_0x38f507=>_0x4d4315-_0x38f507<=CFG['SPAM_WINDO'+_0x3065e8(0x287)]),_0x57997f[_0x3065e8(0x293)][_0x3065e8(0x23c)](_0x4d4315);if(_0x57997f[_0x3065e8(0x1d3)]&&_0x4d4315-_0x57997f[_0x3065e8(0x1d3)]<CFG['SPAM_COOLD'+'OWN_MS'])return;if((_0x57997f[_0x3065e8(0x293)]||[])[_0x3065e8(0x233)]>=CFG[_0x3065e8(0x1c7)+_0x3065e8(0x290)]){_0x57997f[_0x3065e8(0x1d3)]=_0x4d4315;(!_0x57997f[_0x3065e8(0x216)+_0x3065e8(0x24a)]||_0x57997f[_0x3065e8(0x216)+_0x3065e8(0x24a)]<=_0x4d4315)&&(_0x57997f[_0x3065e8(0x1f8)]=-0x1*-0x1945+0x16d*-0xb+-0x3*0x332);_0x57997f['warnCount']=(_0x57997f[_0x3065e8(0x1f8)]||0x988+0x2396+0x2a*-0x113)+(-0xec3*0x1+-0x3fb+0x12bf),_0x57997f['warnExpire'+_0x3065e8(0x24a)]=_0x4d4315+CFG[_0x3065e8(0x1c9)+_0x3065e8(0x243)];const _0x2ac66b=Math[_0x3065e8(0x286)](0x2e0*0x3+-0xe09+0x569*0x1,CFG[_0x3065e8(0x230)+'GS']-_0x57997f[_0x3065e8(0x1f8)]),_0x18d32b='@'+_0x53f611['split']('@')[-0x52f*-0x2+-0x17f5+0xd97],_0x4e1126=String(CFG[_0x3065e8(0x218)+_0x3065e8(0x22d)]||'')[_0x3065e8(0x280)]('{user}',_0x18d32b)[_0x3065e8(0x280)](_0x3065e8(0x23d),String(_0x2ac66b)),_0x56ec5c=await sendText(_0x45e921,{'text':_0x4e1126,'mentions':[_0x53f611]});_0x56ec5c?.[_0x3065e8(0x276)]&&CFG[_0x3065e8(0x227)+'L_MS']>0x9*-0x97+-0xf1*0x1b+0x1eba&&setTimeout(async()=>{const _0x5cbd39=_0x3065e8;try{await sendText(_0x45e921,{'delete':_0x56ec5c[_0x5cbd39(0x276)]});}catch(_0x5ebe7b){}},CFG['WARNING_TT'+'L_MS']);if(CFG[_0x3065e8(0x260)+'AM']&&_0x57997f['warnCount']>=CFG[_0x3065e8(0x230)+'GS']){const _0x430a0e=await kickUser(_0x45e921,_0x53f611);_0x430a0e?(_0x2cfce1[_0x3065e8(0x26b)](_0x53f611),await sendText(_0x45e921,{'text':_0x18d32b+(_0x3065e8(0x23a)+'or\x20repeate'+'d\x20spam.'),'mentions':[_0x53f611]})[_0x3065e8(0x248)](()=>{})):warn('['+name+(_0x3065e8(0x1d1)+_0x3065e8(0x228))+_0x53f611+'\x20from\x20'+_0x45e921);}}}catch(_0x5b59a0){warn('['+name+(']\x20handleMe'+_0x3065e8(0x240)+_0x3065e8(0x26e))+(_0x5b59a0?.['message']||_0x5b59a0));}}async function rawMessagesUpsertHandler({messages:_0x54ef21}){const _0x1d05a2=_0x3aeea2;if(!Array[_0x1d05a2(0x244)](_0x54ef21))return;for(const _0x1bcc44 of _0x54ef21){try{const _0x4d7042=String(_0x1bcc44[_0x1d05a2(0x276)]?.[_0x1d05a2(0x1e0)]||'');if(!_0x4d7042||!_0x4d7042['endsWith'](_0x1d05a2(0x1c8)))continue;if(!_0x1bcc44[_0x1d05a2(0x25d)])continue;if(_0x1bcc44[_0x1d05a2(0x276)]?.[_0x1d05a2(0x1ed)])continue;const _0x442983=_0x4d7042+'::'+String(_0x1bcc44[_0x1d05a2(0x276)]?.['id']||'')+'::'+String(_0x1bcc44[_0x1d05a2(0x276)]?.['participan'+'t']||'');if(processedMessageKeys[_0x1d05a2(0x279)](_0x442983))continue;const _0x499b1c=setTimeout(()=>processedMessageKeys[_0x1d05a2(0x26b)](_0x442983),DEDUPE_TTL_MS);processedMessageKeys[_0x1d05a2(0x1f3)](_0x442983,_0x499b1c),await handleMessageForSpam(_0x1bcc44);}catch(_0x218451){warn('['+name+(_0x1d05a2(0x200)+_0x1d05a2(0x272)+_0x1d05a2(0x29e)+_0x1d05a2(0x231))+(_0x218451?.[_0x1d05a2(0x25d)]||_0x218451));}}}export async function onMessage(_0x220b0d){const _0x2f94c5=_0x3aeea2;try{if(!_0x220b0d||!_0x220b0d[_0x2f94c5(0x276)]||!_0x220b0d['message']||!_0x220b0d[_0x2f94c5(0x206)])return;const _0x327dce=String(_0x220b0d[_0x2f94c5(0x276)][_0x2f94c5(0x1e0)]||'');if(!_0x327dce[_0x2f94c5(0x28d)](_0x2f94c5(0x1c8)))return;if(!await isadmin(botRef,_0x220b0d))return;const _0x193be4=typeof _0x220b0d['text']===_0x2f94c5(0x26f)&&_0x220b0d['text'][_0x2f94c5(0x253)]()[_0x2f94c5(0x233)]?_0x220b0d['text'][_0x2f94c5(0x253)]():'';if(!_0x193be4)return;const _0x5b1f25=_0x193be4['split'](/\s+/)[_0x2f94c5(0x296)](Boolean);if(!_0x5b1f25[_0x2f94c5(0x233)])return;const _0x26e2d1=String(_0x5b1f25[0x16*0x92+0x1*0x2031+-0xd*0x371]||'')[_0x2f94c5(0x25c)+'e'](),_0x528ab8=_0x5b1f25[_0x2f94c5(0x1e5)](-0x25c5+-0x826*0x1+0xb7b*0x4);if(!commands['includes'](_0x26e2d1))return;if(_0x26e2d1===_0x2f94c5(0x27f)){const _0x6b10c0=(_0x528ab8['find'](_0x52d142=>['on',_0x2f94c5(0x229),'show'][_0x2f94c5(0x23b)](String(_0x52d142)[_0x2f94c5(0x25c)+'e']()))||_0x2f94c5(0x1e3))[_0x2f94c5(0x25c)+'e']();if(_0x6b10c0==='on'){const _0x4198f7=await setChatEnabled(_0x327dce,!![]);return _0x4198f7?(clearChatMemory(_0x327dce),sendText(_0x327dce,'✔️\x20Anti-spa'+'m\x20ENABLED\x20'+_0x2f94c5(0x22f)+_0x2f94c5(0x1df))):sendText(_0x327dce,_0x2f94c5(0x226)+_0x2f94c5(0x255)+'nti-spam\x20('+_0x2f94c5(0x220));}else{if(_0x6b10c0===_0x2f94c5(0x229)){const _0x425dcf=await setChatEnabled(_0x327dce,![]);return _0x425dcf?(clearChatMemory(_0x327dce),sendText(_0x327dce,_0x2f94c5(0x21d)+_0x2f94c5(0x1f5)+'\x20for\x20this\x20'+_0x2f94c5(0x265))):sendText(_0x327dce,_0x2f94c5(0x226)+_0x2f94c5(0x257)+'anti-spam\x20'+_0x2f94c5(0x205)+'.');}else{const _0x3d8a23=await getChatEnabled(_0x327dce),_0x1982c5={'SPAM_THRESHOLD':CFG[_0x2f94c5(0x1c7)+'HOLD'],'SPAM_WINDOW_MS':CFG[_0x2f94c5(0x1c6)+'W_MS'],'SPAM_COOLDOWN_MS':CFG[_0x2f94c5(0x235)+_0x2f94c5(0x241)],'MAX_WARNINGS':CFG[_0x2f94c5(0x230)+'GS'],'KICK_ON_SPAM':CFG['KICK_ON_SP'+'AM']};return sendText(_0x327dce,_0x2f94c5(0x21d)+_0x2f94c5(0x29d)+_0x2f94c5(0x25e)+(_0x3d8a23?_0x2f94c5(0x1e4):_0x2f94c5(0x1d4))+'\x0aConfig:\x20'+JSON[_0x2f94c5(0x24f)](_0x1982c5));}}}if(_0x26e2d1==='resetspam'){const _0x5a80f6=_0x220b0d['message']?.[_0x2f94c5(0x212)+_0x2f94c5(0x21a)]?.['contextInf'+'o']?.[_0x2f94c5(0x225)+'id']||[];if(!_0x5a80f6||_0x5a80f6[_0x2f94c5(0x233)]===0x12b6+0x137b+0x2631*-0x1)return sendText(_0x327dce,_0x2f94c5(0x28f)+'mention\x20on'+_0x2f94c5(0x28c)+_0x2f94c5(0x271)+_0x2f94c5(0x1e7)+_0x2f94c5(0x207)+_0x2f94c5(0x23f));const _0x458495=chatUserMap[_0x2f94c5(0x245)](_0x327dce);for(const _0x2aa4d2 of _0x5a80f6){if(_0x458495&&_0x458495[_0x2f94c5(0x279)](_0x2aa4d2))_0x458495[_0x2f94c5(0x26b)](_0x2aa4d2);}return sendText(_0x327dce,_0x2f94c5(0x21d)+_0x2f94c5(0x1d5)+_0x2f94c5(0x270)+_0x2f94c5(0x21f)+_0x2f94c5(0x298));}}catch(_0x17dec9){error(_0x17dec9,'['+name+(_0x2f94c5(0x1cd)+_0x2f94c5(0x1da))+(_0x17dec9?.[_0x2f94c5(0x25d)]||_0x17dec9));}}export async function initialize(_0x43696b){const _0x38c67b=_0x3aeea2;try{if(!_0x43696b)throw new Error(_0x38c67b(0x21b)+_0x38c67b(0x234)+'requires\x20b'+_0x38c67b(0x20c)+'e');botRef=_0x43696b,setupSendApi(),refreshConfig(),hotReloadConfig?.(refreshConfig),await ensureTables(),startManagedListener({'botRef':botRef,'eventName':'messages.u'+_0x38c67b(0x211),'handler':rawMessagesUpsertHandler,'moduleName':name}),info('['+name+(']\x20initiali'+'zed.\x20In-me'+_0x38c67b(0x20f)+_0x38c67b(0x259)+_0x38c67b(0x295)+'y\x20')+TABLE_SETTINGS+('.\x20Threshol'+'d=')+CFG[_0x38c67b(0x1c7)+'HOLD']+'\x20within\x20'+CFG[_0x38c67b(0x1c6)+_0x38c67b(0x287)]+(_0x38c67b(0x1ee)+_0x38c67b(0x1f0))+CFG[_0x38c67b(0x230)+'GS']);}catch(_0x7cfe49){error(_0x7cfe49,'['+name+(_0x38c67b(0x1fc)+'ze\x20fatal:\x20')+(_0x7cfe49?.[_0x38c67b(0x25d)]||_0x7cfe49));throw _0x7cfe49;}}export async function cleanup(){const _0x2076b6=_0x3aeea2;try{stopManagedListener(name,'messages.u'+'psert');}catch(_0x542bf7){warn('['+name+(_0x2076b6(0x224)+'gedListene'+_0x2076b6(0x222))+(_0x542bf7?.[_0x2076b6(0x25d)]||_0x542bf7));}for(const _0x3fc813 of processedMessageKeys['values']())try{clearTimeout(_0x3fc813);}catch(_0x5ab83f){}processedMessageKeys[_0x2076b6(0x210)](),chatUserMap['clear'](),botRef=null,sendApi=null,info('['+name+(_0x2076b6(0x246)+_0x2076b6(0x285)));}export default{'name':name,'version':version,'priority':priority,'commands':commands,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};