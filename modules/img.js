const _0x52a781=_0x20cd;(function(_0x202fde,_0x1b5c81){const _0x510f01=_0x20cd,_0x4f96e6=_0x202fde();while(!![]){try{const _0x59ac61=parseInt(_0x510f01(0xac))/(-0x1ed1+-0x2482+0x4354)+-parseInt(_0x510f01(0xa9))/(-0x11b7+0x29c*-0x9+0x2935)+parseInt(_0x510f01(0x93))/(-0x5*-0x2ef+0x53*-0x61+0x10cb)*(-parseInt(_0x510f01(0xaf))/(-0x18a*0x1+-0xbd2+-0x10*-0xd6))+-parseInt(_0x510f01(0x69))/(0xa07+-0x18*-0x15b+0x16b*-0x1e)+parseInt(_0x510f01(0xad))/(0x12f*0xd+0xe67+-0x9ec*0x3)+-parseInt(_0x510f01(0xbe))/(-0x259d+-0x77*0x1a+-0x5*-0x9f2)+parseInt(_0x510f01(0x6b))/(0x31c+-0x122d+0x1*0xf19)*(parseInt(_0x510f01(0x97))/(0x29*-0x85+0x18eb+-0x395));if(_0x59ac61===_0x1b5c81)break;else _0x4f96e6['push'](_0x4f96e6['shift']());}catch(_0x10efa1){_0x4f96e6['push'](_0x4f96e6['shift']());}}}(_0x3b53,-0x2ebc2*0x2+0x564c3+-0x1*-0x465bb));import{info,warn,error}from'../utils/logger.js';import{isSudo,userJidFromCtx,listSudo,normalizeToJid}from'../utils/sudo.js';import{getBotJid}from'../utils/bot-state.js';function _0x20cd(_0x35a147,_0x333f89){const _0x4ae484=_0x3b53();return _0x20cd=function(_0x32c60a,_0x55e059){_0x32c60a=_0x32c60a-(-0xf*-0x26a+0x185e+-0x3c2d);let _0x29c69e=_0x4ae484[_0x32c60a];return _0x29c69e;},_0x20cd(_0x35a147,_0x333f89);}import _0x5e84e7 from'axios';export const name='img';export const version=_0x52a781(0xb6);export const priority=0x1f4a+-0x4d8+-0x1a68;let botInstance=null,respondedMsgIds=new Set();async function findStoredMatchFromFindings(_0x30798a=[]){const _0x10a5c6=_0x52a781;try{const _0x1ec6e0=await listSudo(),_0x53f947=new Set(_0x1ec6e0['map'](String));for(const _0x1e00ef of _0x30798a){if(!_0x1e00ef||typeof _0x1e00ef[_0x10a5c6(0x86)]!==_0x10a5c6(0x79))continue;const _0x25eee6=normalizeToJid(_0x1e00ef[_0x10a5c6(0x86)]);if(_0x25eee6&&_0x53f947[_0x10a5c6(0x6a)](_0x25eee6))return _0x25eee6;if(_0x53f947['has'](_0x1e00ef['jid']))return _0x1e00ef[_0x10a5c6(0x86)];}return null;}catch(_0x5a1c31){return warn(name+(':\x20findStor'+_0x10a5c6(0x98)+_0x10a5c6(0xbb))+(_0x5a1c31?.[_0x10a5c6(0xa4)]||_0x5a1c31)),null;}}function htmlUnescape(_0x49aa32){const _0x9af0e6=_0x52a781;if(!_0x49aa32||typeof _0x49aa32!==_0x9af0e6(0x79))return _0x49aa32;return _0x49aa32['replace'](/&quot;/g,'\x22')[_0x9af0e6(0xa8)](/&#39;/g,'\x27')['replace'](/&amp;/g,'&')[_0x9af0e6(0xa8)](/&lt;/g,'<')[_0x9af0e6(0xa8)](/&gt;/g,'>')[_0x9af0e6(0xa8)](/&nbsp;/g,'\x20');}function tryParseJsonSafe(_0x63fa66){const _0x352084=_0x52a781;if(!_0x63fa66||typeof _0x63fa66!==_0x352084(0x79))return null;try{return JSON[_0x352084(0x9a)](_0x63fa66);}catch(_0x1a48d3){try{const _0x290729=htmlUnescape(_0x63fa66);return JSON[_0x352084(0x9a)](_0x290729);}catch(_0x3dd83b){try{const _0x340edd=htmlUnescape(_0x63fa66)[_0x352084(0xa8)](/(['"])?([a-zA-Z0-9_]+)\1\s*:/g,'\x22$2\x22:')[_0x352084(0xa8)](/:\s*'([^']*)'/g,':\x20\x22$1\x22');return JSON[_0x352084(0x9a)](_0x340edd);}catch(_0x333b71){return null;}}}}function _0x3b53(){const _0x4afbe5=['http','isNaN','Mozilla/5.','1905905jhEtHV','has','7768QSJOxe','ples:\x0a•\x20im','isCommand','size','fromMe','get','join','max','slice','://example','sendMessag',':\x20send\x20ima','stination\x20','clear','string','found\x20for\x20','h\x20term.','.0;\x20+https','ch\x20failed\x20',')...','\x20cleanup\x20e','\x0a•\x20img\x203\x20:',':\x20initiali','text','\x20images\x20to','arch\x20faile','&tsc=Image','jid','startsWith','\x20cleaned\x20u',':\x20Could\x20no',':\x20botInsta','ble;\x20Bot/1','\x22\x20(sending','ch\x20failed:','isArray','client','nce\x20missin','toLowerCas','your\x20searc','3Yvrviu','thumb','exec','ge\x20error','6687qYjhpG','edMatch\x20er','unknown','parse','0\x20(compati','img','Searching\x20','g\x20cats\x0a•\x20i','Found\x20(no\x20','right\x20now.','key','Source:\x20','https://ww','message',':\x20sent\x20','t\x20determin','from','replace','292770YFBqVn','/images/se','trim','320783GNAvQm','1525938ypozoc','.com)','1859212qksSVq','\x20handler\x20e','bot','length','):\x20','push','direct\x20URL','1.0.8','e?\x20Provide','zed.','url','sourcePage','ror:\x20','turl','add','317660qckjZj','images\x20for'];_0x3b53=function(){return _0x4afbe5;};return _0x3b53();}async function searchBingNoCheerio(_0x57ec9c,_0x24c301=0x1fee+0x1ef8+0x2*-0x1f6f){const _0x30c7e4=_0x52a781;try{const _0x59d444=encodeURIComponent(_0x57ec9c),_0x17c0b5=_0x30c7e4(0xa3)+'w.bing.com'+_0x30c7e4(0xaa)+'arch?q='+_0x59d444+('&form=HDRS'+'C2&first=1'+_0x30c7e4(0x85)+'BasicHover'),_0x910a63=await _0x5e84e7[_0x30c7e4(0x70)](_0x17c0b5,{'headers':{'User-Agent':_0x30c7e4(0x68)+_0x30c7e4(0x9b)+_0x30c7e4(0x8b)+_0x30c7e4(0x7c)+_0x30c7e4(0x74)+_0x30c7e4(0xae)},'responseType':_0x30c7e4(0x82),'maxRedirects':0x5}),_0x99b32d=String(_0x910a63['data']||''),_0x548810=/ m=(?:"([^"]+)"|'([^']+)')/g,_0x39f8f4=[];let _0x54c8f1;while((_0x54c8f1=_0x548810[_0x30c7e4(0x95)](_0x99b32d))&&_0x39f8f4[_0x30c7e4(0xb2)]<_0x24c301){const _0x59bcd2=_0x54c8f1[0x1fcc+0x2405+-0x43d0]||_0x54c8f1[-0x5fc+0x4*-0x9c0+0x1bb*0x1a];if(!_0x59bcd2)continue;const _0x458cd5=htmlUnescape(_0x59bcd2),_0x215706=tryParseJsonSafe(_0x458cd5);if(!_0x215706)continue;const _0x304c70=_0x215706['murl']||_0x215706['m']||_0x215706[_0x30c7e4(0xbc)]||_0x215706['p']||null;if(!_0x304c70)continue;_0x39f8f4['push']({'url':_0x304c70,'thumb':_0x215706[_0x30c7e4(0xbc)]||null,'sourcePage':_0x215706['p']||null,'title':_0x215706['t']||null});}if(_0x39f8f4['length']===-0x12e6+0xd33*-0x1+0x2019){const _0x1fa254=/<img[^>]+(?:data-src|src|data-thumb)=["']([^"']+)["'][^>]*>/g;while((_0x54c8f1=_0x1fa254[_0x30c7e4(0x95)](_0x99b32d))&&_0x39f8f4[_0x30c7e4(0xb2)]<_0x24c301){const _0x16ff0d=_0x54c8f1[-0x2509*0x1+-0x3cd*-0x4+0x15d6*0x1];_0x16ff0d&&String(_0x16ff0d)[_0x30c7e4(0x87)](_0x30c7e4(0xc0))&&_0x39f8f4[_0x30c7e4(0xb4)]({'url':_0x16ff0d,'thumb':_0x16ff0d,'sourcePage':null,'title':null});}}return _0x39f8f4[_0x30c7e4(0x73)](-0xbff+-0x81c+0x141b,_0x24c301);}catch(_0x5e6e46){throw _0x5e6e46;}}async function performImageSearch(_0x147e21,_0x462137=0x1c90*-0x1+0x4*0x7e3+0x36*-0xe){const _0x5cda4d=_0x52a781;try{const _0x5cfadf=await searchBingNoCheerio(_0x147e21,_0x462137);return _0x5cfadf;}catch(_0x384d8c){throw new Error('Image\x20sear'+_0x5cda4d(0x8d)+'\x20'+(_0x384d8c?.[_0x5cda4d(0xa4)]||_0x384d8c));}}export async function initialize(_0x2b864a){const _0x18fe66=_0x52a781;botInstance=_0x2b864a,info(name+(_0x18fe66(0x81)+_0x18fe66(0xb8)));}export async function onMessage(_0x4e92e1){const _0x3ca1b1=_0x52a781;try{if(!_0x4e92e1?.[_0x3ca1b1(0xa1)]||!_0x4e92e1[_0x3ca1b1(0x6d)])return;const _0xf1ea0e=_0x4e92e1[_0x3ca1b1(0xa1)]['id'];if(_0xf1ea0e&&respondedMsgIds[_0x3ca1b1(0x6a)](_0xf1ea0e))return;if(_0xf1ea0e)respondedMsgIds[_0x3ca1b1(0xbd)](_0xf1ea0e);const _0x56cb30=(_0x4e92e1[_0x3ca1b1(0x82)]||'')['trim']();if(!_0x56cb30['toLowerCas'+'e']()[_0x3ca1b1(0x87)](_0x3ca1b1(0x9c)))return;const _0x4eddd4=_0x56cb30['split'](/\s+/),_0x271990=_0x4eddd4[-0xd07*-0x1+0x1b6f+-0x1*0x2876][_0x3ca1b1(0x91)+'e']();if(_0x271990!=='img')return;if(!botInstance)botInstance=_0x4e92e1[_0x3ca1b1(0xb1)]||_0x4e92e1[_0x3ca1b1(0x8f)];if(!botInstance){warn(name+(_0x3ca1b1(0x8a)+_0x3ca1b1(0x90)+'g'));return;}const _0x3a6730=getBotJid();let _0x1ce055;if(_0x4e92e1['key'][_0x3ca1b1(0x6f)])_0x1ce055=_0x3a6730;else{const _0x45abce=await isSudo(botInstance,_0x4e92e1)['catch'](()=>![]);if(!_0x45abce)return;const {findings:_0x370547}=userJidFromCtx(_0x4e92e1),_0x3ec97c=await findStoredMatchFromFindings(_0x370547);if(!_0x3ec97c)return;_0x1ce055=_0x3ec97c;}if(!_0x1ce055){warn(name+(_0x3ca1b1(0x89)+_0x3ca1b1(0xa6)+'e\x20final\x20de'+_0x3ca1b1(0x77)+'for\x20messag'+'e.'));return;}let _0xfce4fa=0x1d23+-0x23d8+0x6bb,_0x10bf42=_0x4eddd4['slice'](-0x171c+0x14d3*0x1+-0x1*-0x24a)[_0x3ca1b1(0x71)]('\x20');if(_0x4eddd4[_0x3ca1b1(0xb2)]>=-0x112*0x1b+-0x727*-0x2+-0x59*-0x2a){const _0x38c485=parseInt(_0x4eddd4[0x3b*-0x80+-0x7e1*-0x1+0x4*0x568],0x1*-0xfc6+0x10fb+-0xd*0x17);if(!Number[_0x3ca1b1(0x67)](_0x38c485)){_0xfce4fa=Math[_0x3ca1b1(0x72)](-0x1*0x6ba+0x26f1+-0x2*0x101b,_0x38c485);if(_0xfce4fa>-0x1e20+0x24dc+-0x35b*0x2)_0xfce4fa=0x23b0+0x1*-0x83+-0x2327;_0x10bf42=_0x4eddd4['slice'](0x1*-0xa85+-0xb4+0xb3b)[_0x3ca1b1(0x71)]('\x20');}else _0xfce4fa=0xe19+-0x1680+0x86d,_0x10bf42=_0x4eddd4[_0x3ca1b1(0x73)](0xce9*0x2+0x6da+0x1*-0x20ab)['join']('\x20');}_0x10bf42=(_0x10bf42||'')[_0x3ca1b1(0xab)]();if(!_0x10bf42){await botInstance[_0x3ca1b1(0x75)+'e'](_0x1ce055,{'text':'Which\x20imag'+_0x3ca1b1(0xb7)+'\x20a\x20search\x20'+'term.\x20Exam'+_0x3ca1b1(0x6c)+_0x3ca1b1(0x9e)+'mg\x201\x20trees'+_0x3ca1b1(0x80)+'\x20sunsets'});return;}try{await botInstance[_0x3ca1b1(0x75)+'e'](_0x1ce055,{'text':_0x3ca1b1(0x9d)+_0x3ca1b1(0xbf)+'\x20\x22'+_0x10bf42+(_0x3ca1b1(0x8c)+'\x20')+_0xfce4fa+_0x3ca1b1(0x7e)},{'quoted':_0x4e92e1['ms']});}catch(_0x4508a9){try{await botInstance['sendMessag'+'e'](_0x1ce055,{'text':_0x3ca1b1(0x9d)+'images\x20for'+'\x20\x22'+_0x10bf42+(_0x3ca1b1(0x8c)+'\x20')+_0xfce4fa+_0x3ca1b1(0x7e)});}catch(_0x4082fc){}}let _0x5367f2;try{_0x5367f2=await performImageSearch(_0x10bf42,Math['max'](0x26ad+0x1*-0xf4c+-0x1760,_0xfce4fa));}catch(_0x4c470d){error(_0x4c470d,name+(':\x20image\x20se'+_0x3ca1b1(0x84)+'d')),await botInstance['sendMessag'+'e'](_0x1ce055,{'text':'Image\x20sear'+_0x3ca1b1(0x7d)+_0x3ca1b1(0xa0)});return;}if(!Array[_0x3ca1b1(0x8e)](_0x5367f2)||_0x5367f2[_0x3ca1b1(0xb2)]===0x9*-0x1+-0xf*0x22e+0x20bb){await botInstance[_0x3ca1b1(0x75)+'e'](_0x1ce055,{'text':'No\x20images\x20'+_0x3ca1b1(0x7a)+_0x3ca1b1(0x92)+_0x3ca1b1(0x7b)});return;}const _0xc61786=_0x5367f2[_0x3ca1b1(0x73)](0x18ce+0x1*0x12b2+-0x1d0*0x18,_0xfce4fa);for(const _0x5b9eaa of _0xc61786){try{_0x5b9eaa[_0x3ca1b1(0xb9)]&&String(_0x5b9eaa[_0x3ca1b1(0xb9)])[_0x3ca1b1(0x87)]('http')?await botInstance[_0x3ca1b1(0x75)+'e'](_0x1ce055,{'image':{'url':_0x5b9eaa[_0x3ca1b1(0xb9)]},'caption':'Result:\x20'+_0x10bf42},{'quoted':_0x4e92e1['ms']}):await botInstance['sendMessag'+'e'](_0x1ce055,{'text':_0x3ca1b1(0x9f)+_0x3ca1b1(0xb5)+_0x3ca1b1(0xb3)+(_0x5b9eaa[_0x3ca1b1(0xba)]||_0x5b9eaa[_0x3ca1b1(0x94)]||_0x3ca1b1(0x99))});}catch(_0x46d07c){error(_0x46d07c,name+(_0x3ca1b1(0x76)+_0x3ca1b1(0x96)));if(_0x5b9eaa[_0x3ca1b1(0xba)])try{await botInstance[_0x3ca1b1(0x75)+'e'](_0x1ce055,{'text':_0x3ca1b1(0xa2)+_0x5b9eaa[_0x3ca1b1(0xba)]});}catch(_0x5b92da){}}}info(name+_0x3ca1b1(0xa5)+_0xc61786[_0x3ca1b1(0xb2)]+(_0x3ca1b1(0x83)+'\x20')+_0x1ce055);if(respondedMsgIds[_0x3ca1b1(0x6e)]>0xbbb+0x2477*-0x1+0x2c44){const _0x264048=Array[_0x3ca1b1(0xa7)](respondedMsgIds);respondedMsgIds=new Set(_0x264048[_0x3ca1b1(0x73)](-(-0x1c2b*0x1+-0x156a+0x3d4d)));}}catch(_0x24b4a7){error(_0x24b4a7,name+(_0x3ca1b1(0xb0)+'rror'));}}export async function cleanup(){const _0x29b589=_0x52a781;try{botInstance=null,respondedMsgIds[_0x29b589(0x78)](),info(name+(_0x29b589(0x88)+'p'));}catch(_0xf1bef3){warn(name+(_0x29b589(0x7f)+'rror:\x20')+(_0xf1bef3?.[_0x29b589(0xa4)]||_0xf1bef3));}}